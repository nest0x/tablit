(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function k_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ef={exports:{}},Ga={},Cf={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xg;function FC(){if(xg)return be;xg=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),T=Symbol.iterator;function C(q){return q===null||typeof q!="object"?null:(q=T&&q[T]||q["@@iterator"],typeof q=="function"?q:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L=Object.assign,U={};function O(q,Q,_e){this.props=q,this.context=Q,this.refs=U,this.updater=_e||A}O.prototype.isReactComponent={},O.prototype.setState=function(q,Q){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,Q,"setState")},O.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function K(){}K.prototype=O.prototype;function W(q,Q,_e){this.props=q,this.context=Q,this.refs=U,this.updater=_e||A}var Y=W.prototype=new K;Y.constructor=W,L(Y,O.prototype),Y.isPureReactComponent=!0;var re=Array.isArray,le=Object.prototype.hasOwnProperty,Z={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function k(q,Q,_e){var ke,Me={},Ue=null,ze=null;if(Q!=null)for(ke in Q.ref!==void 0&&(ze=Q.ref),Q.key!==void 0&&(Ue=""+Q.key),Q)le.call(Q,ke)&&!D.hasOwnProperty(ke)&&(Me[ke]=Q[ke]);var Ge=arguments.length-2;if(Ge===1)Me.children=_e;else if(1<Ge){for(var Je=Array(Ge),at=0;at<Ge;at++)Je[at]=arguments[at+2];Me.children=Je}if(q&&q.defaultProps)for(ke in Ge=q.defaultProps,Ge)Me[ke]===void 0&&(Me[ke]=Ge[ke]);return{$$typeof:n,type:q,key:Ue,ref:ze,props:Me,_owner:Z.current}}function x(q,Q){return{$$typeof:n,type:q.type,key:Q,ref:q.ref,props:q.props,_owner:q._owner}}function P(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function N(q){var Q={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(_e){return Q[_e]})}var b=/\/+/g;function M(q,Q){return typeof q=="object"&&q!==null&&q.key!=null?N(""+q.key):Q.toString(36)}function Pe(q,Q,_e,ke,Me){var Ue=typeof q;(Ue==="undefined"||Ue==="boolean")&&(q=null);var ze=!1;if(q===null)ze=!0;else switch(Ue){case"string":case"number":ze=!0;break;case"object":switch(q.$$typeof){case n:case e:ze=!0}}if(ze)return ze=q,Me=Me(ze),q=ke===""?"."+M(ze,0):ke,re(Me)?(_e="",q!=null&&(_e=q.replace(b,"$&/")+"/"),Pe(Me,Q,_e,"",function(at){return at})):Me!=null&&(P(Me)&&(Me=x(Me,_e+(!Me.key||ze&&ze.key===Me.key?"":(""+Me.key).replace(b,"$&/")+"/")+q)),Q.push(Me)),1;if(ze=0,ke=ke===""?".":ke+":",re(q))for(var Ge=0;Ge<q.length;Ge++){Ue=q[Ge];var Je=ke+M(Ue,Ge);ze+=Pe(Ue,Q,_e,Je,Me)}else if(Je=C(q),typeof Je=="function")for(q=Je.call(q),Ge=0;!(Ue=q.next()).done;)Ue=Ue.value,Je=ke+M(Ue,Ge++),ze+=Pe(Ue,Q,_e,Je,Me);else if(Ue==="object")throw Q=String(q),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return ze}function De(q,Q,_e){if(q==null)return q;var ke=[],Me=0;return Pe(q,ke,"","",function(Ue){return Q.call(_e,Ue,Me++)}),ke}function Ne(q){if(q._status===-1){var Q=q._result;Q=Q(),Q.then(function(_e){(q._status===0||q._status===-1)&&(q._status=1,q._result=_e)},function(_e){(q._status===0||q._status===-1)&&(q._status=2,q._result=_e)}),q._status===-1&&(q._status=0,q._result=Q)}if(q._status===1)return q._result.default;throw q._result}var Le={current:null},oe={transition:null},ye={ReactCurrentDispatcher:Le,ReactCurrentBatchConfig:oe,ReactCurrentOwner:Z};function ue(){throw Error("act(...) is not supported in production builds of React.")}return be.Children={map:De,forEach:function(q,Q,_e){De(q,function(){Q.apply(this,arguments)},_e)},count:function(q){var Q=0;return De(q,function(){Q++}),Q},toArray:function(q){return De(q,function(Q){return Q})||[]},only:function(q){if(!P(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},be.Component=O,be.Fragment=t,be.Profiler=i,be.PureComponent=W,be.StrictMode=r,be.Suspense=m,be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ye,be.act=ue,be.cloneElement=function(q,Q,_e){if(q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+q+".");var ke=L({},q.props),Me=q.key,Ue=q.ref,ze=q._owner;if(Q!=null){if(Q.ref!==void 0&&(Ue=Q.ref,ze=Z.current),Q.key!==void 0&&(Me=""+Q.key),q.type&&q.type.defaultProps)var Ge=q.type.defaultProps;for(Je in Q)le.call(Q,Je)&&!D.hasOwnProperty(Je)&&(ke[Je]=Q[Je]===void 0&&Ge!==void 0?Ge[Je]:Q[Je])}var Je=arguments.length-2;if(Je===1)ke.children=_e;else if(1<Je){Ge=Array(Je);for(var at=0;at<Je;at++)Ge[at]=arguments[at+2];ke.children=Ge}return{$$typeof:n,type:q.type,key:Me,ref:Ue,props:ke,_owner:ze}},be.createContext=function(q){return q={$$typeof:c,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},q.Provider={$$typeof:a,_context:q},q.Consumer=q},be.createElement=k,be.createFactory=function(q){var Q=k.bind(null,q);return Q.type=q,Q},be.createRef=function(){return{current:null}},be.forwardRef=function(q){return{$$typeof:f,render:q}},be.isValidElement=P,be.lazy=function(q){return{$$typeof:y,_payload:{_status:-1,_result:q},_init:Ne}},be.memo=function(q,Q){return{$$typeof:p,type:q,compare:Q===void 0?null:Q}},be.startTransition=function(q){var Q=oe.transition;oe.transition={};try{q()}finally{oe.transition=Q}},be.unstable_act=ue,be.useCallback=function(q,Q){return Le.current.useCallback(q,Q)},be.useContext=function(q){return Le.current.useContext(q)},be.useDebugValue=function(){},be.useDeferredValue=function(q){return Le.current.useDeferredValue(q)},be.useEffect=function(q,Q){return Le.current.useEffect(q,Q)},be.useId=function(){return Le.current.useId()},be.useImperativeHandle=function(q,Q,_e){return Le.current.useImperativeHandle(q,Q,_e)},be.useInsertionEffect=function(q,Q){return Le.current.useInsertionEffect(q,Q)},be.useLayoutEffect=function(q,Q){return Le.current.useLayoutEffect(q,Q)},be.useMemo=function(q,Q){return Le.current.useMemo(q,Q)},be.useReducer=function(q,Q,_e){return Le.current.useReducer(q,Q,_e)},be.useRef=function(q){return Le.current.useRef(q)},be.useState=function(q){return Le.current.useState(q)},be.useSyncExternalStore=function(q,Q,_e){return Le.current.useSyncExternalStore(q,Q,_e)},be.useTransition=function(){return Le.current.useTransition()},be.version="18.3.1",be}var kg;function Ch(){return kg||(kg=1,Cf.exports=FC()),Cf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rg;function OC(){if(Rg)return Ga;Rg=1;var n=Ch(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(f,m,p){var y,T={},C=null,A=null;p!==void 0&&(C=""+p),m.key!==void 0&&(C=""+m.key),m.ref!==void 0&&(A=m.ref);for(y in m)r.call(m,y)&&!a.hasOwnProperty(y)&&(T[y]=m[y]);if(f&&f.defaultProps)for(y in m=f.defaultProps,m)T[y]===void 0&&(T[y]=m[y]);return{$$typeof:e,type:f,key:C,ref:A,props:T,_owner:i.current}}return Ga.Fragment=t,Ga.jsx=c,Ga.jsxs=c,Ga}var Pg;function BC(){return Pg||(Pg=1,Ef.exports=OC()),Ef.exports}var S=BC(),ae=Ch();const R_=k_(ae);var Fu={},wf={exports:{}},fn={},Sf={exports:{}},If={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ng;function qC(){return Ng||(Ng=1,(function(n){function e(oe,ye){var ue=oe.length;oe.push(ye);e:for(;0<ue;){var q=ue-1>>>1,Q=oe[q];if(0<i(Q,ye))oe[q]=ye,oe[ue]=Q,ue=q;else break e}}function t(oe){return oe.length===0?null:oe[0]}function r(oe){if(oe.length===0)return null;var ye=oe[0],ue=oe.pop();if(ue!==ye){oe[0]=ue;e:for(var q=0,Q=oe.length,_e=Q>>>1;q<_e;){var ke=2*(q+1)-1,Me=oe[ke],Ue=ke+1,ze=oe[Ue];if(0>i(Me,ue))Ue<Q&&0>i(ze,Me)?(oe[q]=ze,oe[Ue]=ue,q=Ue):(oe[q]=Me,oe[ke]=ue,q=ke);else if(Ue<Q&&0>i(ze,ue))oe[q]=ze,oe[Ue]=ue,q=Ue;else break e}}return ye}function i(oe,ye){var ue=oe.sortIndex-ye.sortIndex;return ue!==0?ue:oe.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var c=Date,f=c.now();n.unstable_now=function(){return c.now()-f}}var m=[],p=[],y=1,T=null,C=3,A=!1,L=!1,U=!1,O=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Y(oe){for(var ye=t(p);ye!==null;){if(ye.callback===null)r(p);else if(ye.startTime<=oe)r(p),ye.sortIndex=ye.expirationTime,e(m,ye);else break;ye=t(p)}}function re(oe){if(U=!1,Y(oe),!L)if(t(m)!==null)L=!0,Ne(le);else{var ye=t(p);ye!==null&&Le(re,ye.startTime-oe)}}function le(oe,ye){L=!1,U&&(U=!1,K(k),k=-1),A=!0;var ue=C;try{for(Y(ye),T=t(m);T!==null&&(!(T.expirationTime>ye)||oe&&!N());){var q=T.callback;if(typeof q=="function"){T.callback=null,C=T.priorityLevel;var Q=q(T.expirationTime<=ye);ye=n.unstable_now(),typeof Q=="function"?T.callback=Q:T===t(m)&&r(m),Y(ye)}else r(m);T=t(m)}if(T!==null)var _e=!0;else{var ke=t(p);ke!==null&&Le(re,ke.startTime-ye),_e=!1}return _e}finally{T=null,C=ue,A=!1}}var Z=!1,D=null,k=-1,x=5,P=-1;function N(){return!(n.unstable_now()-P<x)}function b(){if(D!==null){var oe=n.unstable_now();P=oe;var ye=!0;try{ye=D(!0,oe)}finally{ye?M():(Z=!1,D=null)}}else Z=!1}var M;if(typeof W=="function")M=function(){W(b)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,De=Pe.port2;Pe.port1.onmessage=b,M=function(){De.postMessage(null)}}else M=function(){O(b,0)};function Ne(oe){D=oe,Z||(Z=!0,M())}function Le(oe,ye){k=O(function(){oe(n.unstable_now())},ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(oe){oe.callback=null},n.unstable_continueExecution=function(){L||A||(L=!0,Ne(le))},n.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<oe?Math.floor(1e3/oe):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(oe){switch(C){case 1:case 2:case 3:var ye=3;break;default:ye=C}var ue=C;C=ye;try{return oe()}finally{C=ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(oe,ye){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var ue=C;C=oe;try{return ye()}finally{C=ue}},n.unstable_scheduleCallback=function(oe,ye,ue){var q=n.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?q+ue:q):ue=q,oe){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=ue+Q,oe={id:y++,callback:ye,priorityLevel:oe,startTime:ue,expirationTime:Q,sortIndex:-1},ue>q?(oe.sortIndex=ue,e(p,oe),t(m)===null&&oe===t(p)&&(U?(K(k),k=-1):U=!0,Le(re,ue-q))):(oe.sortIndex=Q,e(m,oe),L||A||(L=!0,Ne(le))),oe},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(oe){var ye=C;return function(){var ue=C;C=ye;try{return oe.apply(this,arguments)}finally{C=ue}}}})(If)),If}var Mg;function GC(){return Mg||(Mg=1,Sf.exports=qC()),Sf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dg;function HC(){if(Dg)return fn;Dg=1;var n=Ch(),e=GC();function t(o){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+o,d=1;d<arguments.length;d++)s+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+o+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function a(o,s){c(o,s),c(o+"Capture",s)}function c(o,s){for(i[o]=s,o=0;o<s.length;o++)r.add(s[o])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},T={};function C(o){return m.call(T,o)?!0:m.call(y,o)?!1:p.test(o)?T[o]=!0:(y[o]=!0,!1)}function A(o,s,d,g){if(d!==null&&d.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return g?!1:d!==null?!d.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function L(o,s,d,g){if(s===null||typeof s>"u"||A(o,s,d,g))return!0;if(g)return!1;if(d!==null)switch(d.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function U(o,s,d,g,v,E,I){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=g,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=o,this.type=s,this.sanitizeURL=E,this.removeEmptyString=I}var O={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){O[o]=new U(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var s=o[0];O[s]=new U(s,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){O[o]=new U(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){O[o]=new U(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){O[o]=new U(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){O[o]=new U(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){O[o]=new U(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){O[o]=new U(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){O[o]=new U(o,5,!1,o.toLowerCase(),null,!1,!1)});var K=/[\-:]([a-z])/g;function W(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var s=o.replace(K,W);O[s]=new U(s,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var s=o.replace(K,W);O[s]=new U(s,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var s=o.replace(K,W);O[s]=new U(s,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){O[o]=new U(o,1,!1,o.toLowerCase(),null,!1,!1)}),O.xlinkHref=new U("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){O[o]=new U(o,1,!1,o.toLowerCase(),null,!0,!0)});function Y(o,s,d,g){var v=O.hasOwnProperty(s)?O[s]:null;(v!==null?v.type!==0:g||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(L(s,d,v,g)&&(d=null),g||v===null?C(s)&&(d===null?o.removeAttribute(s):o.setAttribute(s,""+d)):v.mustUseProperty?o[v.propertyName]=d===null?v.type===3?!1:"":d:(s=v.attributeName,g=v.attributeNamespace,d===null?o.removeAttribute(s):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,g?o.setAttributeNS(g,s,d):o.setAttribute(s,d))))}var re=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,le=Symbol.for("react.element"),Z=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),N=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),Pe=Symbol.for("react.suspense_list"),De=Symbol.for("react.memo"),Ne=Symbol.for("react.lazy"),Le=Symbol.for("react.offscreen"),oe=Symbol.iterator;function ye(o){return o===null||typeof o!="object"?null:(o=oe&&o[oe]||o["@@iterator"],typeof o=="function"?o:null)}var ue=Object.assign,q;function Q(o){if(q===void 0)try{throw Error()}catch(d){var s=d.stack.trim().match(/\n( *(at )?)/);q=s&&s[1]||""}return`
`+q+o}var _e=!1;function ke(o,s){if(!o||_e)return"";_e=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(z){var g=z}Reflect.construct(o,[],s)}else{try{s.call()}catch(z){g=z}o.call(s.prototype)}else{try{throw Error()}catch(z){g=z}o()}}catch(z){if(z&&g&&typeof z.stack=="string"){for(var v=z.stack.split(`
`),E=g.stack.split(`
`),I=v.length-1,V=E.length-1;1<=I&&0<=V&&v[I]!==E[V];)V--;for(;1<=I&&0<=V;I--,V--)if(v[I]!==E[V]){if(I!==1||V!==1)do if(I--,V--,0>V||v[I]!==E[V]){var F=`
`+v[I].replace(" at new "," at ");return o.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",o.displayName)),F}while(1<=I&&0<=V);break}}}finally{_e=!1,Error.prepareStackTrace=d}return(o=o?o.displayName||o.name:"")?Q(o):""}function Me(o){switch(o.tag){case 5:return Q(o.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return o=ke(o.type,!1),o;case 11:return o=ke(o.type.render,!1),o;case 1:return o=ke(o.type,!0),o;default:return""}}function Ue(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case D:return"Fragment";case Z:return"Portal";case x:return"Profiler";case k:return"StrictMode";case M:return"Suspense";case Pe:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case N:return(o.displayName||"Context")+".Consumer";case P:return(o._context.displayName||"Context")+".Provider";case b:var s=o.render;return o=o.displayName,o||(o=s.displayName||s.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case De:return s=o.displayName||null,s!==null?s:Ue(o.type)||"Memo";case Ne:s=o._payload,o=o._init;try{return Ue(o(s))}catch{}}return null}function ze(o){var s=o.type;switch(o.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=s.render,o=o.displayName||o.name||"",s.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ue(s);case 8:return s===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Ge(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Je(o){var s=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function at(o){var s=Je(o)?"checked":"value",d=Object.getOwnPropertyDescriptor(o.constructor.prototype,s),g=""+o[s];if(!o.hasOwnProperty(s)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,E=d.set;return Object.defineProperty(o,s,{configurable:!0,get:function(){return v.call(this)},set:function(I){g=""+I,E.call(this,I)}}),Object.defineProperty(o,s,{enumerable:d.enumerable}),{getValue:function(){return g},setValue:function(I){g=""+I},stopTracking:function(){o._valueTracker=null,delete o[s]}}}}function $t(o){o._valueTracker||(o._valueTracker=at(o))}function or(o){if(!o)return!1;var s=o._valueTracker;if(!s)return!0;var d=s.getValue(),g="";return o&&(g=Je(o)?o.checked?"true":"false":o.value),o=g,o!==d?(s.setValue(o),!0):!1}function Tt(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function sr(o,s){var d=s.checked;return ue({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??o._wrapperState.initialChecked})}function ar(o,s){var d=s.defaultValue==null?"":s.defaultValue,g=s.checked!=null?s.checked:s.defaultChecked;d=Ge(s.value!=null?s.value:d),o._wrapperState={initialChecked:g,initialValue:d,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ti(o,s){s=s.checked,s!=null&&Y(o,"checked",s,!1)}function Pr(o,s){ti(o,s);var d=Ge(s.value),g=s.type;if(d!=null)g==="number"?(d===0&&o.value===""||o.value!=d)&&(o.value=""+d):o.value!==""+d&&(o.value=""+d);else if(g==="submit"||g==="reset"){o.removeAttribute("value");return}s.hasOwnProperty("value")?ni(o,s.type,d):s.hasOwnProperty("defaultValue")&&ni(o,s.type,Ge(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(o.defaultChecked=!!s.defaultChecked)}function Go(o,s,d){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var g=s.type;if(!(g!=="submit"&&g!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+o._wrapperState.initialValue,d||s===o.value||(o.value=s),o.defaultValue=s}d=o.name,d!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,d!==""&&(o.name=d)}function ni(o,s,d){(s!=="number"||Tt(o.ownerDocument)!==o)&&(d==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+d&&(o.defaultValue=""+d))}var bn=Array.isArray;function Cn(o,s,d,g){if(o=o.options,s){s={};for(var v=0;v<d.length;v++)s["$"+d[v]]=!0;for(d=0;d<o.length;d++)v=s.hasOwnProperty("$"+o[d].value),o[d].selected!==v&&(o[d].selected=v),v&&g&&(o[d].defaultSelected=!0)}else{for(d=""+Ge(d),s=null,v=0;v<o.length;v++){if(o[v].value===d){o[v].selected=!0,g&&(o[v].defaultSelected=!0);return}s!==null||o[v].disabled||(s=o[v])}s!==null&&(s.selected=!0)}}function Wi(o,s){if(s.dangerouslySetInnerHTML!=null)throw Error(t(91));return ue({},s,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function ri(o,s){var d=s.value;if(d==null){if(d=s.children,s=s.defaultValue,d!=null){if(s!=null)throw Error(t(92));if(bn(d)){if(1<d.length)throw Error(t(93));d=d[0]}s=d}s==null&&(s=""),d=s}o._wrapperState={initialValue:Ge(d)}}function ii(o,s){var d=Ge(s.value),g=Ge(s.defaultValue);d!=null&&(d=""+d,d!==o.value&&(o.value=d),s.defaultValue==null&&o.defaultValue!==d&&(o.defaultValue=d)),g!=null&&(o.defaultValue=""+g)}function Ji(o){var s=o.textContent;s===o._wrapperState.initialValue&&s!==""&&s!==null&&(o.value=s)}function mt(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gt(o,s){return o==null||o==="http://www.w3.org/1999/xhtml"?mt(s):o==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var Un,Ki=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,d,g,v){MSApp.execUnsafeLocalFunction(function(){return o(s,d,g,v)})}:o})(function(o,s){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=s;else{for(Un=Un||document.createElement("div"),Un.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Un.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;s.firstChild;)o.appendChild(s.firstChild)}});function Fn(o,s){if(s){var d=o.firstChild;if(d&&d===o.lastChild&&d.nodeType===3){d.nodeValue=s;return}}o.textContent=s}var Nr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lr=["Webkit","ms","Moz","O"];Object.keys(Nr).forEach(function(o){lr.forEach(function(s){s=s+o.charAt(0).toUpperCase()+o.substring(1),Nr[s]=Nr[o]})});function Yi(o,s,d){return s==null||typeof s=="boolean"||s===""?"":d||typeof s!="number"||s===0||Nr.hasOwnProperty(o)&&Nr[o]?(""+s).trim():s+"px"}function Qi(o,s){o=o.style;for(var d in s)if(s.hasOwnProperty(d)){var g=d.indexOf("--")===0,v=Yi(d,s[d],g);d==="float"&&(d="cssFloat"),g?o.setProperty(d,v):o[d]=v}}var Xi=ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zi(o,s){if(s){if(Xi[o]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(t(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(t(61))}if(s.style!=null&&typeof s.style!="object")throw Error(t(62))}}function ji(o,s){if(o.indexOf("-")===-1)return typeof s.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var he=null;function Ve(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Qe=null,Ke=null,Pt=null;function pn(o){if(o=xa(o)){if(typeof Qe!="function")throw Error(t(280));var s=o.stateNode;s&&(s=jl(s),Qe(o.stateNode,o.type,s))}}function ur(o){Ke?Pt?Pt.push(o):Pt=[o]:Ke=o}function ia(){if(Ke){var o=Ke,s=Pt;if(Pt=Ke=null,pn(o),s)for(o=0;o<s.length;o++)pn(s[o])}}function eo(o,s){return o(s)}function oa(){}var Mr=!1;function sa(o,s,d){if(Mr)return o(s,d);Mr=!0;try{return eo(o,s,d)}finally{Mr=!1,(Ke!==null||Pt!==null)&&(oa(),ia())}}function yt(o,s){var d=o.stateNode;if(d===null)return null;var g=jl(d);if(g===null)return null;d=g[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(d&&typeof d!="function")throw Error(t(231,s,typeof d));return d}var Ho=!1;if(f)try{var On={};Object.defineProperty(On,"passive",{get:function(){Ho=!0}}),window.addEventListener("test",On,On),window.removeEventListener("test",On,On)}catch{Ho=!1}function to(o,s,d,g,v,E,I,V,F){var z=Array.prototype.slice.call(arguments,3);try{s.apply(d,z)}catch(ee){this.onError(ee)}}var no=!1,$o=null,Bn=!1,aa=null,Kc={onError:function(o){no=!0,$o=o}};function zo(o,s,d,g,v,E,I,V,F){no=!1,$o=null,to.apply(Kc,arguments)}function Sl(o,s,d,g,v,E,I,V,F){if(zo.apply(this,arguments),no){if(no){var z=$o;no=!1,$o=null}else throw Error(t(198));Bn||(Bn=!0,aa=z)}}function qn(o){var s=o,d=o;if(o.alternate)for(;s.return;)s=s.return;else{o=s;do s=o,(s.flags&4098)!==0&&(d=s.return),o=s.return;while(o)}return s.tag===3?d:null}function ro(o){if(o.tag===13){var s=o.memoizedState;if(s===null&&(o=o.alternate,o!==null&&(s=o.memoizedState)),s!==null)return s.dehydrated}return null}function Gn(o){if(qn(o)!==o)throw Error(t(188))}function Il(o){var s=o.alternate;if(!s){if(s=qn(o),s===null)throw Error(t(188));return s!==o?null:o}for(var d=o,g=s;;){var v=d.return;if(v===null)break;var E=v.alternate;if(E===null){if(g=v.return,g!==null){d=g;continue}break}if(v.child===E.child){for(E=v.child;E;){if(E===d)return Gn(v),o;if(E===g)return Gn(v),s;E=E.sibling}throw Error(t(188))}if(d.return!==g.return)d=v,g=E;else{for(var I=!1,V=v.child;V;){if(V===d){I=!0,d=v,g=E;break}if(V===g){I=!0,g=v,d=E;break}V=V.sibling}if(!I){for(V=E.child;V;){if(V===d){I=!0,d=E,g=v;break}if(V===g){I=!0,g=E,d=v;break}V=V.sibling}if(!I)throw Error(t(189))}}if(d.alternate!==g)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?o:s}function la(o){return o=Il(o),o!==null?Wo(o):null}function Wo(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var s=Wo(o);if(s!==null)return s;o=o.sibling}return null}var Jo=e.unstable_scheduleCallback,ua=e.unstable_cancelCallback,Al=e.unstable_shouldYield,Yc=e.unstable_requestPaint,tt=e.unstable_now,xl=e.unstable_getCurrentPriorityLevel,io=e.unstable_ImmediatePriority,oi=e.unstable_UserBlockingPriority,wn=e.unstable_NormalPriority,ca=e.unstable_LowPriority,kl=e.unstable_IdlePriority,oo=null,mn=null;function Rl(o){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(oo,o,void 0,(o.current.flags&128)===128)}catch{}}var en=Math.clz32?Math.clz32:Nl,da=Math.log,Pl=Math.LN2;function Nl(o){return o>>>=0,o===0?32:31-(da(o)/Pl|0)|0}var Ko=64,Yo=4194304;function si(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function so(o,s){var d=o.pendingLanes;if(d===0)return 0;var g=0,v=o.suspendedLanes,E=o.pingedLanes,I=d&268435455;if(I!==0){var V=I&~v;V!==0?g=si(V):(E&=I,E!==0&&(g=si(E)))}else I=d&~v,I!==0?g=si(I):E!==0&&(g=si(E));if(g===0)return 0;if(s!==0&&s!==g&&(s&v)===0&&(v=g&-g,E=s&-s,v>=E||v===16&&(E&4194240)!==0))return s;if((g&4)!==0&&(g|=d&16),s=o.entangledLanes,s!==0)for(o=o.entanglements,s&=g;0<s;)d=31-en(s),v=1<<d,g|=o[d],s&=~v;return g}function Qc(o,s){switch(o){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dr(o,s){for(var d=o.suspendedLanes,g=o.pingedLanes,v=o.expirationTimes,E=o.pendingLanes;0<E;){var I=31-en(E),V=1<<I,F=v[I];F===-1?((V&d)===0||(V&g)!==0)&&(v[I]=Qc(V,s)):F<=s&&(o.expiredLanes|=V),E&=~V}}function gn(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function ao(){var o=Ko;return Ko<<=1,(Ko&4194240)===0&&(Ko=64),o}function ai(o){for(var s=[],d=0;31>d;d++)s.push(o);return s}function li(o,s,d){o.pendingLanes|=s,s!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,s=31-en(s),o[s]=d}function et(o,s){var d=o.pendingLanes&~s;o.pendingLanes=s,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=s,o.mutableReadLanes&=s,o.entangledLanes&=s,s=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<d;){var v=31-en(d),E=1<<v;s[v]=0,g[v]=-1,o[v]=-1,d&=~E}}function ui(o,s){var d=o.entangledLanes|=s;for(o=o.entanglements;d;){var g=31-en(d),v=1<<g;v&s|o[g]&s&&(o[g]|=s),d&=~v}}var qe=0;function ci(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Ml,Qo,Dl,Vl,Ll,fa=!1,cr=[],Ut=null,Hn=null,$n=null,di=new Map,Sn=new Map,dr=[],Xc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bl(o,s){switch(o){case"focusin":case"focusout":Ut=null;break;case"dragenter":case"dragleave":Hn=null;break;case"mouseover":case"mouseout":$n=null;break;case"pointerover":case"pointerout":di.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sn.delete(s.pointerId)}}function on(o,s,d,g,v,E){return o===null||o.nativeEvent!==E?(o={blockedOn:s,domEventName:d,eventSystemFlags:g,nativeEvent:E,targetContainers:[v]},s!==null&&(s=xa(s),s!==null&&Qo(s)),o):(o.eventSystemFlags|=g,s=o.targetContainers,v!==null&&s.indexOf(v)===-1&&s.push(v),o)}function Zc(o,s,d,g,v){switch(s){case"focusin":return Ut=on(Ut,o,s,d,g,v),!0;case"dragenter":return Hn=on(Hn,o,s,d,g,v),!0;case"mouseover":return $n=on($n,o,s,d,g,v),!0;case"pointerover":var E=v.pointerId;return di.set(E,on(di.get(E)||null,o,s,d,g,v)),!0;case"gotpointercapture":return E=v.pointerId,Sn.set(E,on(Sn.get(E)||null,o,s,d,g,v)),!0}return!1}function Ul(o){var s=ho(o.target);if(s!==null){var d=qn(s);if(d!==null){if(s=d.tag,s===13){if(s=ro(d),s!==null){o.blockedOn=s,Ll(o.priority,function(){Dl(d)});return}}else if(s===3&&d.stateNode.current.memoizedState.isDehydrated){o.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Vr(o){if(o.blockedOn!==null)return!1;for(var s=o.targetContainers;0<s.length;){var d=Xo(o.domEventName,o.eventSystemFlags,s[0],o.nativeEvent);if(d===null){d=o.nativeEvent;var g=new d.constructor(d.type,d);he=g,d.target.dispatchEvent(g),he=null}else return s=xa(d),s!==null&&Qo(s),o.blockedOn=d,!1;s.shift()}return!0}function lo(o,s,d){Vr(o)&&d.delete(s)}function Fl(){fa=!1,Ut!==null&&Vr(Ut)&&(Ut=null),Hn!==null&&Vr(Hn)&&(Hn=null),$n!==null&&Vr($n)&&($n=null),di.forEach(lo),Sn.forEach(lo)}function zn(o,s){o.blockedOn===s&&(o.blockedOn=null,fa||(fa=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Fl)))}function Wn(o){function s(v){return zn(v,o)}if(0<cr.length){zn(cr[0],o);for(var d=1;d<cr.length;d++){var g=cr[d];g.blockedOn===o&&(g.blockedOn=null)}}for(Ut!==null&&zn(Ut,o),Hn!==null&&zn(Hn,o),$n!==null&&zn($n,o),di.forEach(s),Sn.forEach(s),d=0;d<dr.length;d++)g=dr[d],g.blockedOn===o&&(g.blockedOn=null);for(;0<dr.length&&(d=dr[0],d.blockedOn===null);)Ul(d),d.blockedOn===null&&dr.shift()}var Lr=re.ReactCurrentBatchConfig,fi=!0;function lt(o,s,d,g){var v=qe,E=Lr.transition;Lr.transition=null;try{qe=1,ha(o,s,d,g)}finally{qe=v,Lr.transition=E}}function jc(o,s,d,g){var v=qe,E=Lr.transition;Lr.transition=null;try{qe=4,ha(o,s,d,g)}finally{qe=v,Lr.transition=E}}function ha(o,s,d,g){if(fi){var v=Xo(o,s,d,g);if(v===null)cd(o,s,g,uo,d),bl(o,g);else if(Zc(v,o,s,d,g))g.stopPropagation();else if(bl(o,g),s&4&&-1<Xc.indexOf(o)){for(;v!==null;){var E=xa(v);if(E!==null&&Ml(E),E=Xo(o,s,d,g),E===null&&cd(o,s,g,uo,d),E===v)break;v=E}v!==null&&g.stopPropagation()}else cd(o,s,g,null,d)}}var uo=null;function Xo(o,s,d,g){if(uo=null,o=Ve(g),o=ho(o),o!==null)if(s=qn(o),s===null)o=null;else if(d=s.tag,d===13){if(o=ro(s),o!==null)return o;o=null}else if(d===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;o=null}else s!==o&&(o=null);return uo=o,null}function pa(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xl()){case io:return 1;case oi:return 4;case wn:case ca:return 16;case kl:return 536870912;default:return 16}default:return 16}}var yn=null,Zo=null,sn=null;function ma(){if(sn)return sn;var o,s=Zo,d=s.length,g,v="value"in yn?yn.value:yn.textContent,E=v.length;for(o=0;o<d&&s[o]===v[o];o++);var I=d-o;for(g=1;g<=I&&s[d-g]===v[E-g];g++);return sn=v.slice(o,1<g?1-g:void 0)}function jo(o){var s=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&s===13&&(o=13)):o=s,o===10&&(o=13),32<=o||o===13?o:0}function fr(){return!0}function ga(){return!1}function Ft(o){function s(d,g,v,E,I){this._reactName=d,this._targetInst=v,this.type=g,this.nativeEvent=E,this.target=I,this.currentTarget=null;for(var V in o)o.hasOwnProperty(V)&&(d=o[V],this[V]=d?d(E):E[V]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?fr:ga,this.isPropagationStopped=ga,this}return ue(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=fr)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=fr)},persist:function(){},isPersistent:fr}),s}var Jn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},es=Ft(Jn),hr=ue({},Jn,{view:0,detail:0}),ed=Ft(hr),ts,br,hi,co=ue({},hr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pr,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==hi&&(hi&&o.type==="mousemove"?(ts=o.screenX-hi.screenX,br=o.screenY-hi.screenY):br=ts=0,hi=o),ts)},movementY:function(o){return"movementY"in o?o.movementY:br}}),ns=Ft(co),ya=ue({},co,{dataTransfer:0}),Ol=Ft(ya),rs=ue({},hr,{relatedTarget:0}),is=Ft(rs),Bl=ue({},Jn,{animationName:0,elapsedTime:0,pseudoElement:0}),Ur=Ft(Bl),ql=ue({},Jn,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Gl=Ft(ql),Hl=ue({},Jn,{data:0}),va=Ft(Hl),os={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$l={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zl(o){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(o):(o=$l[o])?!!s[o]:!1}function pr(){return zl}var h=ue({},hr,{key:function(o){if(o.key){var s=os[o.key]||o.key;if(s!=="Unidentified")return s}return o.type==="keypress"?(o=jo(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?tn[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pr,charCode:function(o){return o.type==="keypress"?jo(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?jo(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),_=Ft(h),w=ue({},co,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R=Ft(w),G=ue({},hr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pr}),J=Ft(G),se=ue({},Jn,{propertyName:0,elapsedTime:0,pseudoElement:0}),je=Ft(se),It=ue({},co,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),He=Ft(It),Nt=[9,13,27,32],Et=f&&"CompositionEvent"in window,In=null;f&&"documentMode"in document&&(In=document.documentMode);var vn=f&&"TextEvent"in window&&!In,fo=f&&(!Et||In&&8<In&&11>=In),ss=" ",Ep=!1;function Cp(o,s){switch(o){case"keyup":return Nt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wp(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var as=!1;function LE(o,s){switch(o){case"compositionend":return wp(s);case"keypress":return s.which!==32?null:(Ep=!0,ss);case"textInput":return o=s.data,o===ss&&Ep?null:o;default:return null}}function bE(o,s){if(as)return o==="compositionend"||!Et&&Cp(o,s)?(o=ma(),sn=Zo=yn=null,as=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return fo&&s.locale!=="ko"?null:s.data;default:return null}}var UE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sp(o){var s=o&&o.nodeName&&o.nodeName.toLowerCase();return s==="input"?!!UE[o.type]:s==="textarea"}function Ip(o,s,d,g){ur(g),s=Ql(s,"onChange"),0<s.length&&(d=new es("onChange","change",null,d,g),o.push({event:d,listeners:s}))}var _a=null,Ta=null;function FE(o){Hp(o,0)}function Wl(o){var s=fs(o);if(or(s))return o}function OE(o,s){if(o==="change")return s}var Ap=!1;if(f){var td;if(f){var nd="oninput"in document;if(!nd){var xp=document.createElement("div");xp.setAttribute("oninput","return;"),nd=typeof xp.oninput=="function"}td=nd}else td=!1;Ap=td&&(!document.documentMode||9<document.documentMode)}function kp(){_a&&(_a.detachEvent("onpropertychange",Rp),Ta=_a=null)}function Rp(o){if(o.propertyName==="value"&&Wl(Ta)){var s=[];Ip(s,Ta,o,Ve(o)),sa(FE,s)}}function BE(o,s,d){o==="focusin"?(kp(),_a=s,Ta=d,_a.attachEvent("onpropertychange",Rp)):o==="focusout"&&kp()}function qE(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Wl(Ta)}function GE(o,s){if(o==="click")return Wl(s)}function HE(o,s){if(o==="input"||o==="change")return Wl(s)}function $E(o,s){return o===s&&(o!==0||1/o===1/s)||o!==o&&s!==s}var Kn=typeof Object.is=="function"?Object.is:$E;function Ea(o,s){if(Kn(o,s))return!0;if(typeof o!="object"||o===null||typeof s!="object"||s===null)return!1;var d=Object.keys(o),g=Object.keys(s);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var v=d[g];if(!m.call(s,v)||!Kn(o[v],s[v]))return!1}return!0}function Pp(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Np(o,s){var d=Pp(o);o=0;for(var g;d;){if(d.nodeType===3){if(g=o+d.textContent.length,o<=s&&g>=s)return{node:d,offset:s-o};o=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Pp(d)}}function Mp(o,s){return o&&s?o===s?!0:o&&o.nodeType===3?!1:s&&s.nodeType===3?Mp(o,s.parentNode):"contains"in o?o.contains(s):o.compareDocumentPosition?!!(o.compareDocumentPosition(s)&16):!1:!1}function Dp(){for(var o=window,s=Tt();s instanceof o.HTMLIFrameElement;){try{var d=typeof s.contentWindow.location.href=="string"}catch{d=!1}if(d)o=s.contentWindow;else break;s=Tt(o.document)}return s}function rd(o){var s=o&&o.nodeName&&o.nodeName.toLowerCase();return s&&(s==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||s==="textarea"||o.contentEditable==="true")}function zE(o){var s=Dp(),d=o.focusedElem,g=o.selectionRange;if(s!==d&&d&&d.ownerDocument&&Mp(d.ownerDocument.documentElement,d)){if(g!==null&&rd(d)){if(s=g.start,o=g.end,o===void 0&&(o=s),"selectionStart"in d)d.selectionStart=s,d.selectionEnd=Math.min(o,d.value.length);else if(o=(s=d.ownerDocument||document)&&s.defaultView||window,o.getSelection){o=o.getSelection();var v=d.textContent.length,E=Math.min(g.start,v);g=g.end===void 0?E:Math.min(g.end,v),!o.extend&&E>g&&(v=g,g=E,E=v),v=Np(d,E);var I=Np(d,g);v&&I&&(o.rangeCount!==1||o.anchorNode!==v.node||o.anchorOffset!==v.offset||o.focusNode!==I.node||o.focusOffset!==I.offset)&&(s=s.createRange(),s.setStart(v.node,v.offset),o.removeAllRanges(),E>g?(o.addRange(s),o.extend(I.node,I.offset)):(s.setEnd(I.node,I.offset),o.addRange(s)))}}for(s=[],o=d;o=o.parentNode;)o.nodeType===1&&s.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<s.length;d++)o=s[d],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var WE=f&&"documentMode"in document&&11>=document.documentMode,ls=null,id=null,Ca=null,od=!1;function Vp(o,s,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;od||ls==null||ls!==Tt(g)||(g=ls,"selectionStart"in g&&rd(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Ca&&Ea(Ca,g)||(Ca=g,g=Ql(id,"onSelect"),0<g.length&&(s=new es("onSelect","select",null,s,d),o.push({event:s,listeners:g}),s.target=ls)))}function Jl(o,s){var d={};return d[o.toLowerCase()]=s.toLowerCase(),d["Webkit"+o]="webkit"+s,d["Moz"+o]="moz"+s,d}var us={animationend:Jl("Animation","AnimationEnd"),animationiteration:Jl("Animation","AnimationIteration"),animationstart:Jl("Animation","AnimationStart"),transitionend:Jl("Transition","TransitionEnd")},sd={},Lp={};f&&(Lp=document.createElement("div").style,"AnimationEvent"in window||(delete us.animationend.animation,delete us.animationiteration.animation,delete us.animationstart.animation),"TransitionEvent"in window||delete us.transitionend.transition);function Kl(o){if(sd[o])return sd[o];if(!us[o])return o;var s=us[o],d;for(d in s)if(s.hasOwnProperty(d)&&d in Lp)return sd[o]=s[d];return o}var bp=Kl("animationend"),Up=Kl("animationiteration"),Fp=Kl("animationstart"),Op=Kl("transitionend"),Bp=new Map,qp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pi(o,s){Bp.set(o,s),a(s,[o])}for(var ad=0;ad<qp.length;ad++){var ld=qp[ad],JE=ld.toLowerCase(),KE=ld[0].toUpperCase()+ld.slice(1);pi(JE,"on"+KE)}pi(bp,"onAnimationEnd"),pi(Up,"onAnimationIteration"),pi(Fp,"onAnimationStart"),pi("dblclick","onDoubleClick"),pi("focusin","onFocus"),pi("focusout","onBlur"),pi(Op,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YE=new Set("cancel close invalid load scroll toggle".split(" ").concat(wa));function Gp(o,s,d){var g=o.type||"unknown-event";o.currentTarget=d,Sl(g,s,void 0,o),o.currentTarget=null}function Hp(o,s){s=(s&4)!==0;for(var d=0;d<o.length;d++){var g=o[d],v=g.event;g=g.listeners;e:{var E=void 0;if(s)for(var I=g.length-1;0<=I;I--){var V=g[I],F=V.instance,z=V.currentTarget;if(V=V.listener,F!==E&&v.isPropagationStopped())break e;Gp(v,V,z),E=F}else for(I=0;I<g.length;I++){if(V=g[I],F=V.instance,z=V.currentTarget,V=V.listener,F!==E&&v.isPropagationStopped())break e;Gp(v,V,z),E=F}}}if(Bn)throw o=aa,Bn=!1,aa=null,o}function rt(o,s){var d=s[gd];d===void 0&&(d=s[gd]=new Set);var g=o+"__bubble";d.has(g)||($p(s,o,2,!1),d.add(g))}function ud(o,s,d){var g=0;s&&(g|=4),$p(d,o,g,s)}var Yl="_reactListening"+Math.random().toString(36).slice(2);function Sa(o){if(!o[Yl]){o[Yl]=!0,r.forEach(function(d){d!=="selectionchange"&&(YE.has(d)||ud(d,!1,o),ud(d,!0,o))});var s=o.nodeType===9?o:o.ownerDocument;s===null||s[Yl]||(s[Yl]=!0,ud("selectionchange",!1,s))}}function $p(o,s,d,g){switch(pa(s)){case 1:var v=lt;break;case 4:v=jc;break;default:v=ha}d=v.bind(null,s,d,o),v=void 0,!Ho||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(v=!0),g?v!==void 0?o.addEventListener(s,d,{capture:!0,passive:v}):o.addEventListener(s,d,!0):v!==void 0?o.addEventListener(s,d,{passive:v}):o.addEventListener(s,d,!1)}function cd(o,s,d,g,v){var E=g;if((s&1)===0&&(s&2)===0&&g!==null)e:for(;;){if(g===null)return;var I=g.tag;if(I===3||I===4){var V=g.stateNode.containerInfo;if(V===v||V.nodeType===8&&V.parentNode===v)break;if(I===4)for(I=g.return;I!==null;){var F=I.tag;if((F===3||F===4)&&(F=I.stateNode.containerInfo,F===v||F.nodeType===8&&F.parentNode===v))return;I=I.return}for(;V!==null;){if(I=ho(V),I===null)return;if(F=I.tag,F===5||F===6){g=E=I;continue e}V=V.parentNode}}g=g.return}sa(function(){var z=E,ee=Ve(d),ne=[];e:{var j=Bp.get(o);if(j!==void 0){var ce=es,pe=o;switch(o){case"keypress":if(jo(d)===0)break e;case"keydown":case"keyup":ce=_;break;case"focusin":pe="focus",ce=is;break;case"focusout":pe="blur",ce=is;break;case"beforeblur":case"afterblur":ce=is;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=ns;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=Ol;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=J;break;case bp:case Up:case Fp:ce=Ur;break;case Op:ce=je;break;case"scroll":ce=ed;break;case"wheel":ce=He;break;case"copy":case"cut":case"paste":ce=Gl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=R}var ge=(s&4)!==0,vt=!ge&&o==="scroll",H=ge?j!==null?j+"Capture":null:j;ge=[];for(var B=z,$;B!==null;){$=B;var ie=$.stateNode;if($.tag===5&&ie!==null&&($=ie,H!==null&&(ie=yt(B,H),ie!=null&&ge.push(Ia(B,ie,$)))),vt)break;B=B.return}0<ge.length&&(j=new ce(j,pe,null,d,ee),ne.push({event:j,listeners:ge}))}}if((s&7)===0){e:{if(j=o==="mouseover"||o==="pointerover",ce=o==="mouseout"||o==="pointerout",j&&d!==he&&(pe=d.relatedTarget||d.fromElement)&&(ho(pe)||pe[Fr]))break e;if((ce||j)&&(j=ee.window===ee?ee:(j=ee.ownerDocument)?j.defaultView||j.parentWindow:window,ce?(pe=d.relatedTarget||d.toElement,ce=z,pe=pe?ho(pe):null,pe!==null&&(vt=qn(pe),pe!==vt||pe.tag!==5&&pe.tag!==6)&&(pe=null)):(ce=null,pe=z),ce!==pe)){if(ge=ns,ie="onMouseLeave",H="onMouseEnter",B="mouse",(o==="pointerout"||o==="pointerover")&&(ge=R,ie="onPointerLeave",H="onPointerEnter",B="pointer"),vt=ce==null?j:fs(ce),$=pe==null?j:fs(pe),j=new ge(ie,B+"leave",ce,d,ee),j.target=vt,j.relatedTarget=$,ie=null,ho(ee)===z&&(ge=new ge(H,B+"enter",pe,d,ee),ge.target=$,ge.relatedTarget=vt,ie=ge),vt=ie,ce&&pe)t:{for(ge=ce,H=pe,B=0,$=ge;$;$=cs($))B++;for($=0,ie=H;ie;ie=cs(ie))$++;for(;0<B-$;)ge=cs(ge),B--;for(;0<$-B;)H=cs(H),$--;for(;B--;){if(ge===H||H!==null&&ge===H.alternate)break t;ge=cs(ge),H=cs(H)}ge=null}else ge=null;ce!==null&&zp(ne,j,ce,ge,!1),pe!==null&&vt!==null&&zp(ne,vt,pe,ge,!0)}}e:{if(j=z?fs(z):window,ce=j.nodeName&&j.nodeName.toLowerCase(),ce==="select"||ce==="input"&&j.type==="file")var ve=OE;else if(Sp(j))if(Ap)ve=HE;else{ve=qE;var Ee=BE}else(ce=j.nodeName)&&ce.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&(ve=GE);if(ve&&(ve=ve(o,z))){Ip(ne,ve,d,ee);break e}Ee&&Ee(o,j,z),o==="focusout"&&(Ee=j._wrapperState)&&Ee.controlled&&j.type==="number"&&ni(j,"number",j.value)}switch(Ee=z?fs(z):window,o){case"focusin":(Sp(Ee)||Ee.contentEditable==="true")&&(ls=Ee,id=z,Ca=null);break;case"focusout":Ca=id=ls=null;break;case"mousedown":od=!0;break;case"contextmenu":case"mouseup":case"dragend":od=!1,Vp(ne,d,ee);break;case"selectionchange":if(WE)break;case"keydown":case"keyup":Vp(ne,d,ee)}var Ce;if(Et)e:{switch(o){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else as?Cp(o,d)&&(Ie="onCompositionEnd"):o==="keydown"&&d.keyCode===229&&(Ie="onCompositionStart");Ie&&(fo&&d.locale!=="ko"&&(as||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&as&&(Ce=ma()):(yn=ee,Zo="value"in yn?yn.value:yn.textContent,as=!0)),Ee=Ql(z,Ie),0<Ee.length&&(Ie=new va(Ie,o,null,d,ee),ne.push({event:Ie,listeners:Ee}),Ce?Ie.data=Ce:(Ce=wp(d),Ce!==null&&(Ie.data=Ce)))),(Ce=vn?LE(o,d):bE(o,d))&&(z=Ql(z,"onBeforeInput"),0<z.length&&(ee=new va("onBeforeInput","beforeinput",null,d,ee),ne.push({event:ee,listeners:z}),ee.data=Ce))}Hp(ne,s)})}function Ia(o,s,d){return{instance:o,listener:s,currentTarget:d}}function Ql(o,s){for(var d=s+"Capture",g=[];o!==null;){var v=o,E=v.stateNode;v.tag===5&&E!==null&&(v=E,E=yt(o,d),E!=null&&g.unshift(Ia(o,E,v)),E=yt(o,s),E!=null&&g.push(Ia(o,E,v))),o=o.return}return g}function cs(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function zp(o,s,d,g,v){for(var E=s._reactName,I=[];d!==null&&d!==g;){var V=d,F=V.alternate,z=V.stateNode;if(F!==null&&F===g)break;V.tag===5&&z!==null&&(V=z,v?(F=yt(d,E),F!=null&&I.unshift(Ia(d,F,V))):v||(F=yt(d,E),F!=null&&I.push(Ia(d,F,V)))),d=d.return}I.length!==0&&o.push({event:s,listeners:I})}var QE=/\r\n?/g,XE=/\u0000|\uFFFD/g;function Wp(o){return(typeof o=="string"?o:""+o).replace(QE,`
`).replace(XE,"")}function Xl(o,s,d){if(s=Wp(s),Wp(o)!==s&&d)throw Error(t(425))}function Zl(){}var dd=null,fd=null;function hd(o,s){return o==="textarea"||o==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var pd=typeof setTimeout=="function"?setTimeout:void 0,ZE=typeof clearTimeout=="function"?clearTimeout:void 0,Jp=typeof Promise=="function"?Promise:void 0,jE=typeof queueMicrotask=="function"?queueMicrotask:typeof Jp<"u"?function(o){return Jp.resolve(null).then(o).catch(eC)}:pd;function eC(o){setTimeout(function(){throw o})}function md(o,s){var d=s,g=0;do{var v=d.nextSibling;if(o.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(g===0){o.removeChild(v),Wn(s);return}g--}else d!=="$"&&d!=="$?"&&d!=="$!"||g++;d=v}while(d);Wn(s)}function mi(o){for(;o!=null;o=o.nextSibling){var s=o.nodeType;if(s===1||s===3)break;if(s===8){if(s=o.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return o}function Kp(o){o=o.previousSibling;for(var s=0;o;){if(o.nodeType===8){var d=o.data;if(d==="$"||d==="$!"||d==="$?"){if(s===0)return o;s--}else d==="/$"&&s++}o=o.previousSibling}return null}var ds=Math.random().toString(36).slice(2),mr="__reactFiber$"+ds,Aa="__reactProps$"+ds,Fr="__reactContainer$"+ds,gd="__reactEvents$"+ds,tC="__reactListeners$"+ds,nC="__reactHandles$"+ds;function ho(o){var s=o[mr];if(s)return s;for(var d=o.parentNode;d;){if(s=d[Fr]||d[mr]){if(d=s.alternate,s.child!==null||d!==null&&d.child!==null)for(o=Kp(o);o!==null;){if(d=o[mr])return d;o=Kp(o)}return s}o=d,d=o.parentNode}return null}function xa(o){return o=o[mr]||o[Fr],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function fs(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function jl(o){return o[Aa]||null}var yd=[],hs=-1;function gi(o){return{current:o}}function it(o){0>hs||(o.current=yd[hs],yd[hs]=null,hs--)}function nt(o,s){hs++,yd[hs]=o.current,o.current=s}var yi={},zt=gi(yi),an=gi(!1),po=yi;function ps(o,s){var d=o.type.contextTypes;if(!d)return yi;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===s)return g.__reactInternalMemoizedMaskedChildContext;var v={},E;for(E in d)v[E]=s[E];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=s,o.__reactInternalMemoizedMaskedChildContext=v),v}function ln(o){return o=o.childContextTypes,o!=null}function eu(){it(an),it(zt)}function Yp(o,s,d){if(zt.current!==yi)throw Error(t(168));nt(zt,s),nt(an,d)}function Qp(o,s,d){var g=o.stateNode;if(s=s.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var v in g)if(!(v in s))throw Error(t(108,ze(o)||"Unknown",v));return ue({},d,g)}function tu(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||yi,po=zt.current,nt(zt,o),nt(an,an.current),!0}function Xp(o,s,d){var g=o.stateNode;if(!g)throw Error(t(169));d?(o=Qp(o,s,po),g.__reactInternalMemoizedMergedChildContext=o,it(an),it(zt),nt(zt,o)):it(an),nt(an,d)}var Or=null,nu=!1,vd=!1;function Zp(o){Or===null?Or=[o]:Or.push(o)}function rC(o){nu=!0,Zp(o)}function vi(){if(!vd&&Or!==null){vd=!0;var o=0,s=qe;try{var d=Or;for(qe=1;o<d.length;o++){var g=d[o];do g=g(!0);while(g!==null)}Or=null,nu=!1}catch(v){throw Or!==null&&(Or=Or.slice(o+1)),Jo(io,vi),v}finally{qe=s,vd=!1}}return null}var ms=[],gs=0,ru=null,iu=0,An=[],xn=0,mo=null,Br=1,qr="";function go(o,s){ms[gs++]=iu,ms[gs++]=ru,ru=o,iu=s}function jp(o,s,d){An[xn++]=Br,An[xn++]=qr,An[xn++]=mo,mo=o;var g=Br;o=qr;var v=32-en(g)-1;g&=~(1<<v),d+=1;var E=32-en(s)+v;if(30<E){var I=v-v%5;E=(g&(1<<I)-1).toString(32),g>>=I,v-=I,Br=1<<32-en(s)+v|d<<v|g,qr=E+o}else Br=1<<E|d<<v|g,qr=o}function _d(o){o.return!==null&&(go(o,1),jp(o,1,0))}function Td(o){for(;o===ru;)ru=ms[--gs],ms[gs]=null,iu=ms[--gs],ms[gs]=null;for(;o===mo;)mo=An[--xn],An[xn]=null,qr=An[--xn],An[xn]=null,Br=An[--xn],An[xn]=null}var _n=null,Tn=null,ut=!1,Yn=null;function em(o,s){var d=Nn(5,null,null,0);d.elementType="DELETED",d.stateNode=s,d.return=o,s=o.deletions,s===null?(o.deletions=[d],o.flags|=16):s.push(d)}function tm(o,s){switch(o.tag){case 5:var d=o.type;return s=s.nodeType!==1||d.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(o.stateNode=s,_n=o,Tn=mi(s.firstChild),!0):!1;case 6:return s=o.pendingProps===""||s.nodeType!==3?null:s,s!==null?(o.stateNode=s,_n=o,Tn=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(d=mo!==null?{id:Br,overflow:qr}:null,o.memoizedState={dehydrated:s,treeContext:d,retryLane:1073741824},d=Nn(18,null,null,0),d.stateNode=s,d.return=o,o.child=d,_n=o,Tn=null,!0):!1;default:return!1}}function Ed(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Cd(o){if(ut){var s=Tn;if(s){var d=s;if(!tm(o,s)){if(Ed(o))throw Error(t(418));s=mi(d.nextSibling);var g=_n;s&&tm(o,s)?em(g,d):(o.flags=o.flags&-4097|2,ut=!1,_n=o)}}else{if(Ed(o))throw Error(t(418));o.flags=o.flags&-4097|2,ut=!1,_n=o}}}function nm(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;_n=o}function ou(o){if(o!==_n)return!1;if(!ut)return nm(o),ut=!0,!1;var s;if((s=o.tag!==3)&&!(s=o.tag!==5)&&(s=o.type,s=s!=="head"&&s!=="body"&&!hd(o.type,o.memoizedProps)),s&&(s=Tn)){if(Ed(o))throw rm(),Error(t(418));for(;s;)em(o,s),s=mi(s.nextSibling)}if(nm(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,s=0;o;){if(o.nodeType===8){var d=o.data;if(d==="/$"){if(s===0){Tn=mi(o.nextSibling);break e}s--}else d!=="$"&&d!=="$!"&&d!=="$?"||s++}o=o.nextSibling}Tn=null}}else Tn=_n?mi(o.stateNode.nextSibling):null;return!0}function rm(){for(var o=Tn;o;)o=mi(o.nextSibling)}function ys(){Tn=_n=null,ut=!1}function wd(o){Yn===null?Yn=[o]:Yn.push(o)}var iC=re.ReactCurrentBatchConfig;function ka(o,s,d){if(o=d.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var g=d.stateNode}if(!g)throw Error(t(147,o));var v=g,E=""+o;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===E?s.ref:(s=function(I){var V=v.refs;I===null?delete V[E]:V[E]=I},s._stringRef=E,s)}if(typeof o!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,o))}return o}function su(o,s){throw o=Object.prototype.toString.call(s),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":o))}function im(o){var s=o._init;return s(o._payload)}function om(o){function s(H,B){if(o){var $=H.deletions;$===null?(H.deletions=[B],H.flags|=16):$.push(B)}}function d(H,B){if(!o)return null;for(;B!==null;)s(H,B),B=B.sibling;return null}function g(H,B){for(H=new Map;B!==null;)B.key!==null?H.set(B.key,B):H.set(B.index,B),B=B.sibling;return H}function v(H,B){return H=Ai(H,B),H.index=0,H.sibling=null,H}function E(H,B,$){return H.index=$,o?($=H.alternate,$!==null?($=$.index,$<B?(H.flags|=2,B):$):(H.flags|=2,B)):(H.flags|=1048576,B)}function I(H){return o&&H.alternate===null&&(H.flags|=2),H}function V(H,B,$,ie){return B===null||B.tag!==6?(B=mf($,H.mode,ie),B.return=H,B):(B=v(B,$),B.return=H,B)}function F(H,B,$,ie){var ve=$.type;return ve===D?ee(H,B,$.props.children,ie,$.key):B!==null&&(B.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===Ne&&im(ve)===B.type)?(ie=v(B,$.props),ie.ref=ka(H,B,$),ie.return=H,ie):(ie=Pu($.type,$.key,$.props,null,H.mode,ie),ie.ref=ka(H,B,$),ie.return=H,ie)}function z(H,B,$,ie){return B===null||B.tag!==4||B.stateNode.containerInfo!==$.containerInfo||B.stateNode.implementation!==$.implementation?(B=gf($,H.mode,ie),B.return=H,B):(B=v(B,$.children||[]),B.return=H,B)}function ee(H,B,$,ie,ve){return B===null||B.tag!==7?(B=So($,H.mode,ie,ve),B.return=H,B):(B=v(B,$),B.return=H,B)}function ne(H,B,$){if(typeof B=="string"&&B!==""||typeof B=="number")return B=mf(""+B,H.mode,$),B.return=H,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case le:return $=Pu(B.type,B.key,B.props,null,H.mode,$),$.ref=ka(H,null,B),$.return=H,$;case Z:return B=gf(B,H.mode,$),B.return=H,B;case Ne:var ie=B._init;return ne(H,ie(B._payload),$)}if(bn(B)||ye(B))return B=So(B,H.mode,$,null),B.return=H,B;su(H,B)}return null}function j(H,B,$,ie){var ve=B!==null?B.key:null;if(typeof $=="string"&&$!==""||typeof $=="number")return ve!==null?null:V(H,B,""+$,ie);if(typeof $=="object"&&$!==null){switch($.$$typeof){case le:return $.key===ve?F(H,B,$,ie):null;case Z:return $.key===ve?z(H,B,$,ie):null;case Ne:return ve=$._init,j(H,B,ve($._payload),ie)}if(bn($)||ye($))return ve!==null?null:ee(H,B,$,ie,null);su(H,$)}return null}function ce(H,B,$,ie,ve){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return H=H.get($)||null,V(B,H,""+ie,ve);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case le:return H=H.get(ie.key===null?$:ie.key)||null,F(B,H,ie,ve);case Z:return H=H.get(ie.key===null?$:ie.key)||null,z(B,H,ie,ve);case Ne:var Ee=ie._init;return ce(H,B,$,Ee(ie._payload),ve)}if(bn(ie)||ye(ie))return H=H.get($)||null,ee(B,H,ie,ve,null);su(B,ie)}return null}function pe(H,B,$,ie){for(var ve=null,Ee=null,Ce=B,Ie=B=0,Vt=null;Ce!==null&&Ie<$.length;Ie++){Ce.index>Ie?(Vt=Ce,Ce=null):Vt=Ce.sibling;var Ye=j(H,Ce,$[Ie],ie);if(Ye===null){Ce===null&&(Ce=Vt);break}o&&Ce&&Ye.alternate===null&&s(H,Ce),B=E(Ye,B,Ie),Ee===null?ve=Ye:Ee.sibling=Ye,Ee=Ye,Ce=Vt}if(Ie===$.length)return d(H,Ce),ut&&go(H,Ie),ve;if(Ce===null){for(;Ie<$.length;Ie++)Ce=ne(H,$[Ie],ie),Ce!==null&&(B=E(Ce,B,Ie),Ee===null?ve=Ce:Ee.sibling=Ce,Ee=Ce);return ut&&go(H,Ie),ve}for(Ce=g(H,Ce);Ie<$.length;Ie++)Vt=ce(Ce,H,Ie,$[Ie],ie),Vt!==null&&(o&&Vt.alternate!==null&&Ce.delete(Vt.key===null?Ie:Vt.key),B=E(Vt,B,Ie),Ee===null?ve=Vt:Ee.sibling=Vt,Ee=Vt);return o&&Ce.forEach(function(xi){return s(H,xi)}),ut&&go(H,Ie),ve}function ge(H,B,$,ie){var ve=ye($);if(typeof ve!="function")throw Error(t(150));if($=ve.call($),$==null)throw Error(t(151));for(var Ee=ve=null,Ce=B,Ie=B=0,Vt=null,Ye=$.next();Ce!==null&&!Ye.done;Ie++,Ye=$.next()){Ce.index>Ie?(Vt=Ce,Ce=null):Vt=Ce.sibling;var xi=j(H,Ce,Ye.value,ie);if(xi===null){Ce===null&&(Ce=Vt);break}o&&Ce&&xi.alternate===null&&s(H,Ce),B=E(xi,B,Ie),Ee===null?ve=xi:Ee.sibling=xi,Ee=xi,Ce=Vt}if(Ye.done)return d(H,Ce),ut&&go(H,Ie),ve;if(Ce===null){for(;!Ye.done;Ie++,Ye=$.next())Ye=ne(H,Ye.value,ie),Ye!==null&&(B=E(Ye,B,Ie),Ee===null?ve=Ye:Ee.sibling=Ye,Ee=Ye);return ut&&go(H,Ie),ve}for(Ce=g(H,Ce);!Ye.done;Ie++,Ye=$.next())Ye=ce(Ce,H,Ie,Ye.value,ie),Ye!==null&&(o&&Ye.alternate!==null&&Ce.delete(Ye.key===null?Ie:Ye.key),B=E(Ye,B,Ie),Ee===null?ve=Ye:Ee.sibling=Ye,Ee=Ye);return o&&Ce.forEach(function(UC){return s(H,UC)}),ut&&go(H,Ie),ve}function vt(H,B,$,ie){if(typeof $=="object"&&$!==null&&$.type===D&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case le:e:{for(var ve=$.key,Ee=B;Ee!==null;){if(Ee.key===ve){if(ve=$.type,ve===D){if(Ee.tag===7){d(H,Ee.sibling),B=v(Ee,$.props.children),B.return=H,H=B;break e}}else if(Ee.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===Ne&&im(ve)===Ee.type){d(H,Ee.sibling),B=v(Ee,$.props),B.ref=ka(H,Ee,$),B.return=H,H=B;break e}d(H,Ee);break}else s(H,Ee);Ee=Ee.sibling}$.type===D?(B=So($.props.children,H.mode,ie,$.key),B.return=H,H=B):(ie=Pu($.type,$.key,$.props,null,H.mode,ie),ie.ref=ka(H,B,$),ie.return=H,H=ie)}return I(H);case Z:e:{for(Ee=$.key;B!==null;){if(B.key===Ee)if(B.tag===4&&B.stateNode.containerInfo===$.containerInfo&&B.stateNode.implementation===$.implementation){d(H,B.sibling),B=v(B,$.children||[]),B.return=H,H=B;break e}else{d(H,B);break}else s(H,B);B=B.sibling}B=gf($,H.mode,ie),B.return=H,H=B}return I(H);case Ne:return Ee=$._init,vt(H,B,Ee($._payload),ie)}if(bn($))return pe(H,B,$,ie);if(ye($))return ge(H,B,$,ie);su(H,$)}return typeof $=="string"&&$!==""||typeof $=="number"?($=""+$,B!==null&&B.tag===6?(d(H,B.sibling),B=v(B,$),B.return=H,H=B):(d(H,B),B=mf($,H.mode,ie),B.return=H,H=B),I(H)):d(H,B)}return vt}var vs=om(!0),sm=om(!1),au=gi(null),lu=null,_s=null,Sd=null;function Id(){Sd=_s=lu=null}function Ad(o){var s=au.current;it(au),o._currentValue=s}function xd(o,s,d){for(;o!==null;){var g=o.alternate;if((o.childLanes&s)!==s?(o.childLanes|=s,g!==null&&(g.childLanes|=s)):g!==null&&(g.childLanes&s)!==s&&(g.childLanes|=s),o===d)break;o=o.return}}function Ts(o,s){lu=o,Sd=_s=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&s)!==0&&(un=!0),o.firstContext=null)}function kn(o){var s=o._currentValue;if(Sd!==o)if(o={context:o,memoizedValue:s,next:null},_s===null){if(lu===null)throw Error(t(308));_s=o,lu.dependencies={lanes:0,firstContext:o}}else _s=_s.next=o;return s}var yo=null;function kd(o){yo===null?yo=[o]:yo.push(o)}function am(o,s,d,g){var v=s.interleaved;return v===null?(d.next=d,kd(s)):(d.next=v.next,v.next=d),s.interleaved=d,Gr(o,g)}function Gr(o,s){o.lanes|=s;var d=o.alternate;for(d!==null&&(d.lanes|=s),d=o,o=o.return;o!==null;)o.childLanes|=s,d=o.alternate,d!==null&&(d.childLanes|=s),d=o,o=o.return;return d.tag===3?d.stateNode:null}var _i=!1;function Rd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lm(o,s){o=o.updateQueue,s.updateQueue===o&&(s.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Hr(o,s){return{eventTime:o,lane:s,tag:0,payload:null,callback:null,next:null}}function Ti(o,s,d){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(We&2)!==0){var v=g.pending;return v===null?s.next=s:(s.next=v.next,v.next=s),g.pending=s,Gr(o,d)}return v=g.interleaved,v===null?(s.next=s,kd(g)):(s.next=v.next,v.next=s),g.interleaved=s,Gr(o,d)}function uu(o,s,d){if(s=s.updateQueue,s!==null&&(s=s.shared,(d&4194240)!==0)){var g=s.lanes;g&=o.pendingLanes,d|=g,s.lanes=d,ui(o,d)}}function um(o,s){var d=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var v=null,E=null;if(d=d.firstBaseUpdate,d!==null){do{var I={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};E===null?v=E=I:E=E.next=I,d=d.next}while(d!==null);E===null?v=E=s:E=E.next=s}else v=E=s;d={baseState:g.baseState,firstBaseUpdate:v,lastBaseUpdate:E,shared:g.shared,effects:g.effects},o.updateQueue=d;return}o=d.lastBaseUpdate,o===null?d.firstBaseUpdate=s:o.next=s,d.lastBaseUpdate=s}function cu(o,s,d,g){var v=o.updateQueue;_i=!1;var E=v.firstBaseUpdate,I=v.lastBaseUpdate,V=v.shared.pending;if(V!==null){v.shared.pending=null;var F=V,z=F.next;F.next=null,I===null?E=z:I.next=z,I=F;var ee=o.alternate;ee!==null&&(ee=ee.updateQueue,V=ee.lastBaseUpdate,V!==I&&(V===null?ee.firstBaseUpdate=z:V.next=z,ee.lastBaseUpdate=F))}if(E!==null){var ne=v.baseState;I=0,ee=z=F=null,V=E;do{var j=V.lane,ce=V.eventTime;if((g&j)===j){ee!==null&&(ee=ee.next={eventTime:ce,lane:0,tag:V.tag,payload:V.payload,callback:V.callback,next:null});e:{var pe=o,ge=V;switch(j=s,ce=d,ge.tag){case 1:if(pe=ge.payload,typeof pe=="function"){ne=pe.call(ce,ne,j);break e}ne=pe;break e;case 3:pe.flags=pe.flags&-65537|128;case 0:if(pe=ge.payload,j=typeof pe=="function"?pe.call(ce,ne,j):pe,j==null)break e;ne=ue({},ne,j);break e;case 2:_i=!0}}V.callback!==null&&V.lane!==0&&(o.flags|=64,j=v.effects,j===null?v.effects=[V]:j.push(V))}else ce={eventTime:ce,lane:j,tag:V.tag,payload:V.payload,callback:V.callback,next:null},ee===null?(z=ee=ce,F=ne):ee=ee.next=ce,I|=j;if(V=V.next,V===null){if(V=v.shared.pending,V===null)break;j=V,V=j.next,j.next=null,v.lastBaseUpdate=j,v.shared.pending=null}}while(!0);if(ee===null&&(F=ne),v.baseState=F,v.firstBaseUpdate=z,v.lastBaseUpdate=ee,s=v.shared.interleaved,s!==null){v=s;do I|=v.lane,v=v.next;while(v!==s)}else E===null&&(v.shared.lanes=0);To|=I,o.lanes=I,o.memoizedState=ne}}function cm(o,s,d){if(o=s.effects,s.effects=null,o!==null)for(s=0;s<o.length;s++){var g=o[s],v=g.callback;if(v!==null){if(g.callback=null,g=d,typeof v!="function")throw Error(t(191,v));v.call(g)}}}var Ra={},gr=gi(Ra),Pa=gi(Ra),Na=gi(Ra);function vo(o){if(o===Ra)throw Error(t(174));return o}function Pd(o,s){switch(nt(Na,s),nt(Pa,o),nt(gr,Ra),o=s.nodeType,o){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:gt(null,"");break;default:o=o===8?s.parentNode:s,s=o.namespaceURI||null,o=o.tagName,s=gt(s,o)}it(gr),nt(gr,s)}function Es(){it(gr),it(Pa),it(Na)}function dm(o){vo(Na.current);var s=vo(gr.current),d=gt(s,o.type);s!==d&&(nt(Pa,o),nt(gr,d))}function Nd(o){Pa.current===o&&(it(gr),it(Pa))}var ct=gi(0);function du(o){for(var s=o;s!==null;){if(s.tag===13){var d=s.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Md=[];function Dd(){for(var o=0;o<Md.length;o++)Md[o]._workInProgressVersionPrimary=null;Md.length=0}var fu=re.ReactCurrentDispatcher,Vd=re.ReactCurrentBatchConfig,_o=0,dt=null,At=null,Mt=null,hu=!1,Ma=!1,Da=0,oC=0;function Wt(){throw Error(t(321))}function Ld(o,s){if(s===null)return!1;for(var d=0;d<s.length&&d<o.length;d++)if(!Kn(o[d],s[d]))return!1;return!0}function bd(o,s,d,g,v,E){if(_o=E,dt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,fu.current=o===null||o.memoizedState===null?uC:cC,o=d(g,v),Ma){E=0;do{if(Ma=!1,Da=0,25<=E)throw Error(t(301));E+=1,Mt=At=null,s.updateQueue=null,fu.current=dC,o=d(g,v)}while(Ma)}if(fu.current=gu,s=At!==null&&At.next!==null,_o=0,Mt=At=dt=null,hu=!1,s)throw Error(t(300));return o}function Ud(){var o=Da!==0;return Da=0,o}function yr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?dt.memoizedState=Mt=o:Mt=Mt.next=o,Mt}function Rn(){if(At===null){var o=dt.alternate;o=o!==null?o.memoizedState:null}else o=At.next;var s=Mt===null?dt.memoizedState:Mt.next;if(s!==null)Mt=s,At=o;else{if(o===null)throw Error(t(310));At=o,o={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Mt===null?dt.memoizedState=Mt=o:Mt=Mt.next=o}return Mt}function Va(o,s){return typeof s=="function"?s(o):s}function Fd(o){var s=Rn(),d=s.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=o;var g=At,v=g.baseQueue,E=d.pending;if(E!==null){if(v!==null){var I=v.next;v.next=E.next,E.next=I}g.baseQueue=v=E,d.pending=null}if(v!==null){E=v.next,g=g.baseState;var V=I=null,F=null,z=E;do{var ee=z.lane;if((_o&ee)===ee)F!==null&&(F=F.next={lane:0,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),g=z.hasEagerState?z.eagerState:o(g,z.action);else{var ne={lane:ee,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null};F===null?(V=F=ne,I=g):F=F.next=ne,dt.lanes|=ee,To|=ee}z=z.next}while(z!==null&&z!==E);F===null?I=g:F.next=V,Kn(g,s.memoizedState)||(un=!0),s.memoizedState=g,s.baseState=I,s.baseQueue=F,d.lastRenderedState=g}if(o=d.interleaved,o!==null){v=o;do E=v.lane,dt.lanes|=E,To|=E,v=v.next;while(v!==o)}else v===null&&(d.lanes=0);return[s.memoizedState,d.dispatch]}function Od(o){var s=Rn(),d=s.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=o;var g=d.dispatch,v=d.pending,E=s.memoizedState;if(v!==null){d.pending=null;var I=v=v.next;do E=o(E,I.action),I=I.next;while(I!==v);Kn(E,s.memoizedState)||(un=!0),s.memoizedState=E,s.baseQueue===null&&(s.baseState=E),d.lastRenderedState=E}return[E,g]}function fm(){}function hm(o,s){var d=dt,g=Rn(),v=s(),E=!Kn(g.memoizedState,v);if(E&&(g.memoizedState=v,un=!0),g=g.queue,Bd(gm.bind(null,d,g,o),[o]),g.getSnapshot!==s||E||Mt!==null&&Mt.memoizedState.tag&1){if(d.flags|=2048,La(9,mm.bind(null,d,g,v,s),void 0,null),Dt===null)throw Error(t(349));(_o&30)!==0||pm(d,s,v)}return v}function pm(o,s,d){o.flags|=16384,o={getSnapshot:s,value:d},s=dt.updateQueue,s===null?(s={lastEffect:null,stores:null},dt.updateQueue=s,s.stores=[o]):(d=s.stores,d===null?s.stores=[o]:d.push(o))}function mm(o,s,d,g){s.value=d,s.getSnapshot=g,ym(s)&&vm(o)}function gm(o,s,d){return d(function(){ym(s)&&vm(o)})}function ym(o){var s=o.getSnapshot;o=o.value;try{var d=s();return!Kn(o,d)}catch{return!0}}function vm(o){var s=Gr(o,1);s!==null&&jn(s,o,1,-1)}function _m(o){var s=yr();return typeof o=="function"&&(o=o()),s.memoizedState=s.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:o},s.queue=o,o=o.dispatch=lC.bind(null,dt,o),[s.memoizedState,o]}function La(o,s,d,g){return o={tag:o,create:s,destroy:d,deps:g,next:null},s=dt.updateQueue,s===null?(s={lastEffect:null,stores:null},dt.updateQueue=s,s.lastEffect=o.next=o):(d=s.lastEffect,d===null?s.lastEffect=o.next=o:(g=d.next,d.next=o,o.next=g,s.lastEffect=o)),o}function Tm(){return Rn().memoizedState}function pu(o,s,d,g){var v=yr();dt.flags|=o,v.memoizedState=La(1|s,d,void 0,g===void 0?null:g)}function mu(o,s,d,g){var v=Rn();g=g===void 0?null:g;var E=void 0;if(At!==null){var I=At.memoizedState;if(E=I.destroy,g!==null&&Ld(g,I.deps)){v.memoizedState=La(s,d,E,g);return}}dt.flags|=o,v.memoizedState=La(1|s,d,E,g)}function Em(o,s){return pu(8390656,8,o,s)}function Bd(o,s){return mu(2048,8,o,s)}function Cm(o,s){return mu(4,2,o,s)}function wm(o,s){return mu(4,4,o,s)}function Sm(o,s){if(typeof s=="function")return o=o(),s(o),function(){s(null)};if(s!=null)return o=o(),s.current=o,function(){s.current=null}}function Im(o,s,d){return d=d!=null?d.concat([o]):null,mu(4,4,Sm.bind(null,s,o),d)}function qd(){}function Am(o,s){var d=Rn();s=s===void 0?null:s;var g=d.memoizedState;return g!==null&&s!==null&&Ld(s,g[1])?g[0]:(d.memoizedState=[o,s],o)}function xm(o,s){var d=Rn();s=s===void 0?null:s;var g=d.memoizedState;return g!==null&&s!==null&&Ld(s,g[1])?g[0]:(o=o(),d.memoizedState=[o,s],o)}function km(o,s,d){return(_o&21)===0?(o.baseState&&(o.baseState=!1,un=!0),o.memoizedState=d):(Kn(d,s)||(d=ao(),dt.lanes|=d,To|=d,o.baseState=!0),s)}function sC(o,s){var d=qe;qe=d!==0&&4>d?d:4,o(!0);var g=Vd.transition;Vd.transition={};try{o(!1),s()}finally{qe=d,Vd.transition=g}}function Rm(){return Rn().memoizedState}function aC(o,s,d){var g=Si(o);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},Pm(o))Nm(s,d);else if(d=am(o,s,d,g),d!==null){var v=rn();jn(d,o,g,v),Mm(d,s,g)}}function lC(o,s,d){var g=Si(o),v={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(Pm(o))Nm(s,v);else{var E=o.alternate;if(o.lanes===0&&(E===null||E.lanes===0)&&(E=s.lastRenderedReducer,E!==null))try{var I=s.lastRenderedState,V=E(I,d);if(v.hasEagerState=!0,v.eagerState=V,Kn(V,I)){var F=s.interleaved;F===null?(v.next=v,kd(s)):(v.next=F.next,F.next=v),s.interleaved=v;return}}catch{}finally{}d=am(o,s,v,g),d!==null&&(v=rn(),jn(d,o,g,v),Mm(d,s,g))}}function Pm(o){var s=o.alternate;return o===dt||s!==null&&s===dt}function Nm(o,s){Ma=hu=!0;var d=o.pending;d===null?s.next=s:(s.next=d.next,d.next=s),o.pending=s}function Mm(o,s,d){if((d&4194240)!==0){var g=s.lanes;g&=o.pendingLanes,d|=g,s.lanes=d,ui(o,d)}}var gu={readContext:kn,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useInsertionEffect:Wt,useLayoutEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useMutableSource:Wt,useSyncExternalStore:Wt,useId:Wt,unstable_isNewReconciler:!1},uC={readContext:kn,useCallback:function(o,s){return yr().memoizedState=[o,s===void 0?null:s],o},useContext:kn,useEffect:Em,useImperativeHandle:function(o,s,d){return d=d!=null?d.concat([o]):null,pu(4194308,4,Sm.bind(null,s,o),d)},useLayoutEffect:function(o,s){return pu(4194308,4,o,s)},useInsertionEffect:function(o,s){return pu(4,2,o,s)},useMemo:function(o,s){var d=yr();return s=s===void 0?null:s,o=o(),d.memoizedState=[o,s],o},useReducer:function(o,s,d){var g=yr();return s=d!==void 0?d(s):s,g.memoizedState=g.baseState=s,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:s},g.queue=o,o=o.dispatch=aC.bind(null,dt,o),[g.memoizedState,o]},useRef:function(o){var s=yr();return o={current:o},s.memoizedState=o},useState:_m,useDebugValue:qd,useDeferredValue:function(o){return yr().memoizedState=o},useTransition:function(){var o=_m(!1),s=o[0];return o=sC.bind(null,o[1]),yr().memoizedState=o,[s,o]},useMutableSource:function(){},useSyncExternalStore:function(o,s,d){var g=dt,v=yr();if(ut){if(d===void 0)throw Error(t(407));d=d()}else{if(d=s(),Dt===null)throw Error(t(349));(_o&30)!==0||pm(g,s,d)}v.memoizedState=d;var E={value:d,getSnapshot:s};return v.queue=E,Em(gm.bind(null,g,E,o),[o]),g.flags|=2048,La(9,mm.bind(null,g,E,d,s),void 0,null),d},useId:function(){var o=yr(),s=Dt.identifierPrefix;if(ut){var d=qr,g=Br;d=(g&~(1<<32-en(g)-1)).toString(32)+d,s=":"+s+"R"+d,d=Da++,0<d&&(s+="H"+d.toString(32)),s+=":"}else d=oC++,s=":"+s+"r"+d.toString(32)+":";return o.memoizedState=s},unstable_isNewReconciler:!1},cC={readContext:kn,useCallback:Am,useContext:kn,useEffect:Bd,useImperativeHandle:Im,useInsertionEffect:Cm,useLayoutEffect:wm,useMemo:xm,useReducer:Fd,useRef:Tm,useState:function(){return Fd(Va)},useDebugValue:qd,useDeferredValue:function(o){var s=Rn();return km(s,At.memoizedState,o)},useTransition:function(){var o=Fd(Va)[0],s=Rn().memoizedState;return[o,s]},useMutableSource:fm,useSyncExternalStore:hm,useId:Rm,unstable_isNewReconciler:!1},dC={readContext:kn,useCallback:Am,useContext:kn,useEffect:Bd,useImperativeHandle:Im,useInsertionEffect:Cm,useLayoutEffect:wm,useMemo:xm,useReducer:Od,useRef:Tm,useState:function(){return Od(Va)},useDebugValue:qd,useDeferredValue:function(o){var s=Rn();return At===null?s.memoizedState=o:km(s,At.memoizedState,o)},useTransition:function(){var o=Od(Va)[0],s=Rn().memoizedState;return[o,s]},useMutableSource:fm,useSyncExternalStore:hm,useId:Rm,unstable_isNewReconciler:!1};function Qn(o,s){if(o&&o.defaultProps){s=ue({},s),o=o.defaultProps;for(var d in o)s[d]===void 0&&(s[d]=o[d]);return s}return s}function Gd(o,s,d,g){s=o.memoizedState,d=d(g,s),d=d==null?s:ue({},s,d),o.memoizedState=d,o.lanes===0&&(o.updateQueue.baseState=d)}var yu={isMounted:function(o){return(o=o._reactInternals)?qn(o)===o:!1},enqueueSetState:function(o,s,d){o=o._reactInternals;var g=rn(),v=Si(o),E=Hr(g,v);E.payload=s,d!=null&&(E.callback=d),s=Ti(o,E,v),s!==null&&(jn(s,o,v,g),uu(s,o,v))},enqueueReplaceState:function(o,s,d){o=o._reactInternals;var g=rn(),v=Si(o),E=Hr(g,v);E.tag=1,E.payload=s,d!=null&&(E.callback=d),s=Ti(o,E,v),s!==null&&(jn(s,o,v,g),uu(s,o,v))},enqueueForceUpdate:function(o,s){o=o._reactInternals;var d=rn(),g=Si(o),v=Hr(d,g);v.tag=2,s!=null&&(v.callback=s),s=Ti(o,v,g),s!==null&&(jn(s,o,g,d),uu(s,o,g))}};function Dm(o,s,d,g,v,E,I){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,E,I):s.prototype&&s.prototype.isPureReactComponent?!Ea(d,g)||!Ea(v,E):!0}function Vm(o,s,d){var g=!1,v=yi,E=s.contextType;return typeof E=="object"&&E!==null?E=kn(E):(v=ln(s)?po:zt.current,g=s.contextTypes,E=(g=g!=null)?ps(o,v):yi),s=new s(d,E),o.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=yu,o.stateNode=s,s._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=v,o.__reactInternalMemoizedMaskedChildContext=E),s}function Lm(o,s,d,g){o=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(d,g),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(d,g),s.state!==o&&yu.enqueueReplaceState(s,s.state,null)}function Hd(o,s,d,g){var v=o.stateNode;v.props=d,v.state=o.memoizedState,v.refs={},Rd(o);var E=s.contextType;typeof E=="object"&&E!==null?v.context=kn(E):(E=ln(s)?po:zt.current,v.context=ps(o,E)),v.state=o.memoizedState,E=s.getDerivedStateFromProps,typeof E=="function"&&(Gd(o,s,E,d),v.state=o.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(s=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),s!==v.state&&yu.enqueueReplaceState(v,v.state,null),cu(o,d,v,g),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308)}function Cs(o,s){try{var d="",g=s;do d+=Me(g),g=g.return;while(g);var v=d}catch(E){v=`
Error generating stack: `+E.message+`
`+E.stack}return{value:o,source:s,stack:v,digest:null}}function $d(o,s,d){return{value:o,source:null,stack:d??null,digest:s??null}}function zd(o,s){try{console.error(s.value)}catch(d){setTimeout(function(){throw d})}}var fC=typeof WeakMap=="function"?WeakMap:Map;function bm(o,s,d){d=Hr(-1,d),d.tag=3,d.payload={element:null};var g=s.value;return d.callback=function(){Su||(Su=!0,af=g),zd(o,s)},d}function Um(o,s,d){d=Hr(-1,d),d.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var v=s.value;d.payload=function(){return g(v)},d.callback=function(){zd(o,s)}}var E=o.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(d.callback=function(){zd(o,s),typeof g!="function"&&(Ci===null?Ci=new Set([this]):Ci.add(this));var I=s.stack;this.componentDidCatch(s.value,{componentStack:I!==null?I:""})}),d}function Fm(o,s,d){var g=o.pingCache;if(g===null){g=o.pingCache=new fC;var v=new Set;g.set(s,v)}else v=g.get(s),v===void 0&&(v=new Set,g.set(s,v));v.has(d)||(v.add(d),o=AC.bind(null,o,s,d),s.then(o,o))}function Om(o){do{var s;if((s=o.tag===13)&&(s=o.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return o;o=o.return}while(o!==null);return null}function Bm(o,s,d,g,v){return(o.mode&1)===0?(o===s?o.flags|=65536:(o.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(s=Hr(-1,1),s.tag=2,Ti(d,s,1))),d.lanes|=1),o):(o.flags|=65536,o.lanes=v,o)}var hC=re.ReactCurrentOwner,un=!1;function nn(o,s,d,g){s.child=o===null?sm(s,null,d,g):vs(s,o.child,d,g)}function qm(o,s,d,g,v){d=d.render;var E=s.ref;return Ts(s,v),g=bd(o,s,d,g,E,v),d=Ud(),o!==null&&!un?(s.updateQueue=o.updateQueue,s.flags&=-2053,o.lanes&=~v,$r(o,s,v)):(ut&&d&&_d(s),s.flags|=1,nn(o,s,g,v),s.child)}function Gm(o,s,d,g,v){if(o===null){var E=d.type;return typeof E=="function"&&!pf(E)&&E.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(s.tag=15,s.type=E,Hm(o,s,E,g,v)):(o=Pu(d.type,null,g,s,s.mode,v),o.ref=s.ref,o.return=s,s.child=o)}if(E=o.child,(o.lanes&v)===0){var I=E.memoizedProps;if(d=d.compare,d=d!==null?d:Ea,d(I,g)&&o.ref===s.ref)return $r(o,s,v)}return s.flags|=1,o=Ai(E,g),o.ref=s.ref,o.return=s,s.child=o}function Hm(o,s,d,g,v){if(o!==null){var E=o.memoizedProps;if(Ea(E,g)&&o.ref===s.ref)if(un=!1,s.pendingProps=g=E,(o.lanes&v)!==0)(o.flags&131072)!==0&&(un=!0);else return s.lanes=o.lanes,$r(o,s,v)}return Wd(o,s,d,g,v)}function $m(o,s,d){var g=s.pendingProps,v=g.children,E=o!==null?o.memoizedState:null;if(g.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(Ss,En),En|=d;else{if((d&1073741824)===0)return o=E!==null?E.baseLanes|d:d,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:o,cachePool:null,transitions:null},s.updateQueue=null,nt(Ss,En),En|=o,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=E!==null?E.baseLanes:d,nt(Ss,En),En|=g}else E!==null?(g=E.baseLanes|d,s.memoizedState=null):g=d,nt(Ss,En),En|=g;return nn(o,s,v,d),s.child}function zm(o,s){var d=s.ref;(o===null&&d!==null||o!==null&&o.ref!==d)&&(s.flags|=512,s.flags|=2097152)}function Wd(o,s,d,g,v){var E=ln(d)?po:zt.current;return E=ps(s,E),Ts(s,v),d=bd(o,s,d,g,E,v),g=Ud(),o!==null&&!un?(s.updateQueue=o.updateQueue,s.flags&=-2053,o.lanes&=~v,$r(o,s,v)):(ut&&g&&_d(s),s.flags|=1,nn(o,s,d,v),s.child)}function Wm(o,s,d,g,v){if(ln(d)){var E=!0;tu(s)}else E=!1;if(Ts(s,v),s.stateNode===null)_u(o,s),Vm(s,d,g),Hd(s,d,g,v),g=!0;else if(o===null){var I=s.stateNode,V=s.memoizedProps;I.props=V;var F=I.context,z=d.contextType;typeof z=="object"&&z!==null?z=kn(z):(z=ln(d)?po:zt.current,z=ps(s,z));var ee=d.getDerivedStateFromProps,ne=typeof ee=="function"||typeof I.getSnapshotBeforeUpdate=="function";ne||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(V!==g||F!==z)&&Lm(s,I,g,z),_i=!1;var j=s.memoizedState;I.state=j,cu(s,g,I,v),F=s.memoizedState,V!==g||j!==F||an.current||_i?(typeof ee=="function"&&(Gd(s,d,ee,g),F=s.memoizedState),(V=_i||Dm(s,d,V,g,j,F,z))?(ne||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(s.flags|=4194308)):(typeof I.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=g,s.memoizedState=F),I.props=g,I.state=F,I.context=z,g=V):(typeof I.componentDidMount=="function"&&(s.flags|=4194308),g=!1)}else{I=s.stateNode,lm(o,s),V=s.memoizedProps,z=s.type===s.elementType?V:Qn(s.type,V),I.props=z,ne=s.pendingProps,j=I.context,F=d.contextType,typeof F=="object"&&F!==null?F=kn(F):(F=ln(d)?po:zt.current,F=ps(s,F));var ce=d.getDerivedStateFromProps;(ee=typeof ce=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(V!==ne||j!==F)&&Lm(s,I,g,F),_i=!1,j=s.memoizedState,I.state=j,cu(s,g,I,v);var pe=s.memoizedState;V!==ne||j!==pe||an.current||_i?(typeof ce=="function"&&(Gd(s,d,ce,g),pe=s.memoizedState),(z=_i||Dm(s,d,z,g,j,pe,F)||!1)?(ee||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(g,pe,F),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(g,pe,F)),typeof I.componentDidUpdate=="function"&&(s.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof I.componentDidUpdate!="function"||V===o.memoizedProps&&j===o.memoizedState||(s.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||V===o.memoizedProps&&j===o.memoizedState||(s.flags|=1024),s.memoizedProps=g,s.memoizedState=pe),I.props=g,I.state=pe,I.context=F,g=z):(typeof I.componentDidUpdate!="function"||V===o.memoizedProps&&j===o.memoizedState||(s.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||V===o.memoizedProps&&j===o.memoizedState||(s.flags|=1024),g=!1)}return Jd(o,s,d,g,E,v)}function Jd(o,s,d,g,v,E){zm(o,s);var I=(s.flags&128)!==0;if(!g&&!I)return v&&Xp(s,d,!1),$r(o,s,E);g=s.stateNode,hC.current=s;var V=I&&typeof d.getDerivedStateFromError!="function"?null:g.render();return s.flags|=1,o!==null&&I?(s.child=vs(s,o.child,null,E),s.child=vs(s,null,V,E)):nn(o,s,V,E),s.memoizedState=g.state,v&&Xp(s,d,!0),s.child}function Jm(o){var s=o.stateNode;s.pendingContext?Yp(o,s.pendingContext,s.pendingContext!==s.context):s.context&&Yp(o,s.context,!1),Pd(o,s.containerInfo)}function Km(o,s,d,g,v){return ys(),wd(v),s.flags|=256,nn(o,s,d,g),s.child}var Kd={dehydrated:null,treeContext:null,retryLane:0};function Yd(o){return{baseLanes:o,cachePool:null,transitions:null}}function Ym(o,s,d){var g=s.pendingProps,v=ct.current,E=!1,I=(s.flags&128)!==0,V;if((V=I)||(V=o!==null&&o.memoizedState===null?!1:(v&2)!==0),V?(E=!0,s.flags&=-129):(o===null||o.memoizedState!==null)&&(v|=1),nt(ct,v&1),o===null)return Cd(s),o=s.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((s.mode&1)===0?s.lanes=1:o.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(I=g.children,o=g.fallback,E?(g=s.mode,E=s.child,I={mode:"hidden",children:I},(g&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=I):E=Nu(I,g,0,null),o=So(o,g,d,null),E.return=s,o.return=s,E.sibling=o,s.child=E,s.child.memoizedState=Yd(d),s.memoizedState=Kd,o):Qd(s,I));if(v=o.memoizedState,v!==null&&(V=v.dehydrated,V!==null))return pC(o,s,I,g,V,v,d);if(E){E=g.fallback,I=s.mode,v=o.child,V=v.sibling;var F={mode:"hidden",children:g.children};return(I&1)===0&&s.child!==v?(g=s.child,g.childLanes=0,g.pendingProps=F,s.deletions=null):(g=Ai(v,F),g.subtreeFlags=v.subtreeFlags&14680064),V!==null?E=Ai(V,E):(E=So(E,I,d,null),E.flags|=2),E.return=s,g.return=s,g.sibling=E,s.child=g,g=E,E=s.child,I=o.child.memoizedState,I=I===null?Yd(d):{baseLanes:I.baseLanes|d,cachePool:null,transitions:I.transitions},E.memoizedState=I,E.childLanes=o.childLanes&~d,s.memoizedState=Kd,g}return E=o.child,o=E.sibling,g=Ai(E,{mode:"visible",children:g.children}),(s.mode&1)===0&&(g.lanes=d),g.return=s,g.sibling=null,o!==null&&(d=s.deletions,d===null?(s.deletions=[o],s.flags|=16):d.push(o)),s.child=g,s.memoizedState=null,g}function Qd(o,s){return s=Nu({mode:"visible",children:s},o.mode,0,null),s.return=o,o.child=s}function vu(o,s,d,g){return g!==null&&wd(g),vs(s,o.child,null,d),o=Qd(s,s.pendingProps.children),o.flags|=2,s.memoizedState=null,o}function pC(o,s,d,g,v,E,I){if(d)return s.flags&256?(s.flags&=-257,g=$d(Error(t(422))),vu(o,s,I,g)):s.memoizedState!==null?(s.child=o.child,s.flags|=128,null):(E=g.fallback,v=s.mode,g=Nu({mode:"visible",children:g.children},v,0,null),E=So(E,v,I,null),E.flags|=2,g.return=s,E.return=s,g.sibling=E,s.child=g,(s.mode&1)!==0&&vs(s,o.child,null,I),s.child.memoizedState=Yd(I),s.memoizedState=Kd,E);if((s.mode&1)===0)return vu(o,s,I,null);if(v.data==="$!"){if(g=v.nextSibling&&v.nextSibling.dataset,g)var V=g.dgst;return g=V,E=Error(t(419)),g=$d(E,g,void 0),vu(o,s,I,g)}if(V=(I&o.childLanes)!==0,un||V){if(g=Dt,g!==null){switch(I&-I){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(g.suspendedLanes|I))!==0?0:v,v!==0&&v!==E.retryLane&&(E.retryLane=v,Gr(o,v),jn(g,o,v,-1))}return hf(),g=$d(Error(t(421))),vu(o,s,I,g)}return v.data==="$?"?(s.flags|=128,s.child=o.child,s=xC.bind(null,o),v._reactRetry=s,null):(o=E.treeContext,Tn=mi(v.nextSibling),_n=s,ut=!0,Yn=null,o!==null&&(An[xn++]=Br,An[xn++]=qr,An[xn++]=mo,Br=o.id,qr=o.overflow,mo=s),s=Qd(s,g.children),s.flags|=4096,s)}function Qm(o,s,d){o.lanes|=s;var g=o.alternate;g!==null&&(g.lanes|=s),xd(o.return,s,d)}function Xd(o,s,d,g,v){var E=o.memoizedState;E===null?o.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:v}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=g,E.tail=d,E.tailMode=v)}function Xm(o,s,d){var g=s.pendingProps,v=g.revealOrder,E=g.tail;if(nn(o,s,g.children,d),g=ct.current,(g&2)!==0)g=g&1|2,s.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=s.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Qm(o,d,s);else if(o.tag===19)Qm(o,d,s);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(nt(ct,g),(s.mode&1)===0)s.memoizedState=null;else switch(v){case"forwards":for(d=s.child,v=null;d!==null;)o=d.alternate,o!==null&&du(o)===null&&(v=d),d=d.sibling;d=v,d===null?(v=s.child,s.child=null):(v=d.sibling,d.sibling=null),Xd(s,!1,v,d,E);break;case"backwards":for(d=null,v=s.child,s.child=null;v!==null;){if(o=v.alternate,o!==null&&du(o)===null){s.child=v;break}o=v.sibling,v.sibling=d,d=v,v=o}Xd(s,!0,d,null,E);break;case"together":Xd(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function _u(o,s){(s.mode&1)===0&&o!==null&&(o.alternate=null,s.alternate=null,s.flags|=2)}function $r(o,s,d){if(o!==null&&(s.dependencies=o.dependencies),To|=s.lanes,(d&s.childLanes)===0)return null;if(o!==null&&s.child!==o.child)throw Error(t(153));if(s.child!==null){for(o=s.child,d=Ai(o,o.pendingProps),s.child=d,d.return=s;o.sibling!==null;)o=o.sibling,d=d.sibling=Ai(o,o.pendingProps),d.return=s;d.sibling=null}return s.child}function mC(o,s,d){switch(s.tag){case 3:Jm(s),ys();break;case 5:dm(s);break;case 1:ln(s.type)&&tu(s);break;case 4:Pd(s,s.stateNode.containerInfo);break;case 10:var g=s.type._context,v=s.memoizedProps.value;nt(au,g._currentValue),g._currentValue=v;break;case 13:if(g=s.memoizedState,g!==null)return g.dehydrated!==null?(nt(ct,ct.current&1),s.flags|=128,null):(d&s.child.childLanes)!==0?Ym(o,s,d):(nt(ct,ct.current&1),o=$r(o,s,d),o!==null?o.sibling:null);nt(ct,ct.current&1);break;case 19:if(g=(d&s.childLanes)!==0,(o.flags&128)!==0){if(g)return Xm(o,s,d);s.flags|=128}if(v=s.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),nt(ct,ct.current),g)break;return null;case 22:case 23:return s.lanes=0,$m(o,s,d)}return $r(o,s,d)}var Zm,Zd,jm,eg;Zm=function(o,s){for(var d=s.child;d!==null;){if(d.tag===5||d.tag===6)o.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===s)break;for(;d.sibling===null;){if(d.return===null||d.return===s)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Zd=function(){},jm=function(o,s,d,g){var v=o.memoizedProps;if(v!==g){o=s.stateNode,vo(gr.current);var E=null;switch(d){case"input":v=sr(o,v),g=sr(o,g),E=[];break;case"select":v=ue({},v,{value:void 0}),g=ue({},g,{value:void 0}),E=[];break;case"textarea":v=Wi(o,v),g=Wi(o,g),E=[];break;default:typeof v.onClick!="function"&&typeof g.onClick=="function"&&(o.onclick=Zl)}Zi(d,g);var I;d=null;for(z in v)if(!g.hasOwnProperty(z)&&v.hasOwnProperty(z)&&v[z]!=null)if(z==="style"){var V=v[z];for(I in V)V.hasOwnProperty(I)&&(d||(d={}),d[I]="")}else z!=="dangerouslySetInnerHTML"&&z!=="children"&&z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(i.hasOwnProperty(z)?E||(E=[]):(E=E||[]).push(z,null));for(z in g){var F=g[z];if(V=v?.[z],g.hasOwnProperty(z)&&F!==V&&(F!=null||V!=null))if(z==="style")if(V){for(I in V)!V.hasOwnProperty(I)||F&&F.hasOwnProperty(I)||(d||(d={}),d[I]="");for(I in F)F.hasOwnProperty(I)&&V[I]!==F[I]&&(d||(d={}),d[I]=F[I])}else d||(E||(E=[]),E.push(z,d)),d=F;else z==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,V=V?V.__html:void 0,F!=null&&V!==F&&(E=E||[]).push(z,F)):z==="children"?typeof F!="string"&&typeof F!="number"||(E=E||[]).push(z,""+F):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&(i.hasOwnProperty(z)?(F!=null&&z==="onScroll"&&rt("scroll",o),E||V===F||(E=[])):(E=E||[]).push(z,F))}d&&(E=E||[]).push("style",d);var z=E;(s.updateQueue=z)&&(s.flags|=4)}},eg=function(o,s,d,g){d!==g&&(s.flags|=4)};function ba(o,s){if(!ut)switch(o.tailMode){case"hidden":s=o.tail;for(var d=null;s!==null;)s.alternate!==null&&(d=s),s=s.sibling;d===null?o.tail=null:d.sibling=null;break;case"collapsed":d=o.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?s||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Jt(o){var s=o.alternate!==null&&o.alternate.child===o.child,d=0,g=0;if(s)for(var v=o.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags&14680064,g|=v.flags&14680064,v.return=o,v=v.sibling;else for(v=o.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags,g|=v.flags,v.return=o,v=v.sibling;return o.subtreeFlags|=g,o.childLanes=d,s}function gC(o,s,d){var g=s.pendingProps;switch(Td(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(s),null;case 1:return ln(s.type)&&eu(),Jt(s),null;case 3:return g=s.stateNode,Es(),it(an),it(zt),Dd(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(o===null||o.child===null)&&(ou(s)?s.flags|=4:o===null||o.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Yn!==null&&(cf(Yn),Yn=null))),Zd(o,s),Jt(s),null;case 5:Nd(s);var v=vo(Na.current);if(d=s.type,o!==null&&s.stateNode!=null)jm(o,s,d,g,v),o.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!g){if(s.stateNode===null)throw Error(t(166));return Jt(s),null}if(o=vo(gr.current),ou(s)){g=s.stateNode,d=s.type;var E=s.memoizedProps;switch(g[mr]=s,g[Aa]=E,o=(s.mode&1)!==0,d){case"dialog":rt("cancel",g),rt("close",g);break;case"iframe":case"object":case"embed":rt("load",g);break;case"video":case"audio":for(v=0;v<wa.length;v++)rt(wa[v],g);break;case"source":rt("error",g);break;case"img":case"image":case"link":rt("error",g),rt("load",g);break;case"details":rt("toggle",g);break;case"input":ar(g,E),rt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!E.multiple},rt("invalid",g);break;case"textarea":ri(g,E),rt("invalid",g)}Zi(d,E),v=null;for(var I in E)if(E.hasOwnProperty(I)){var V=E[I];I==="children"?typeof V=="string"?g.textContent!==V&&(E.suppressHydrationWarning!==!0&&Xl(g.textContent,V,o),v=["children",V]):typeof V=="number"&&g.textContent!==""+V&&(E.suppressHydrationWarning!==!0&&Xl(g.textContent,V,o),v=["children",""+V]):i.hasOwnProperty(I)&&V!=null&&I==="onScroll"&&rt("scroll",g)}switch(d){case"input":$t(g),Go(g,E,!0);break;case"textarea":$t(g),Ji(g);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(g.onclick=Zl)}g=v,s.updateQueue=g,g!==null&&(s.flags|=4)}else{I=v.nodeType===9?v:v.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=mt(d)),o==="http://www.w3.org/1999/xhtml"?d==="script"?(o=I.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof g.is=="string"?o=I.createElement(d,{is:g.is}):(o=I.createElement(d),d==="select"&&(I=o,g.multiple?I.multiple=!0:g.size&&(I.size=g.size))):o=I.createElementNS(o,d),o[mr]=s,o[Aa]=g,Zm(o,s,!1,!1),s.stateNode=o;e:{switch(I=ji(d,g),d){case"dialog":rt("cancel",o),rt("close",o),v=g;break;case"iframe":case"object":case"embed":rt("load",o),v=g;break;case"video":case"audio":for(v=0;v<wa.length;v++)rt(wa[v],o);v=g;break;case"source":rt("error",o),v=g;break;case"img":case"image":case"link":rt("error",o),rt("load",o),v=g;break;case"details":rt("toggle",o),v=g;break;case"input":ar(o,g),v=sr(o,g),rt("invalid",o);break;case"option":v=g;break;case"select":o._wrapperState={wasMultiple:!!g.multiple},v=ue({},g,{value:void 0}),rt("invalid",o);break;case"textarea":ri(o,g),v=Wi(o,g),rt("invalid",o);break;default:v=g}Zi(d,v),V=v;for(E in V)if(V.hasOwnProperty(E)){var F=V[E];E==="style"?Qi(o,F):E==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&Ki(o,F)):E==="children"?typeof F=="string"?(d!=="textarea"||F!=="")&&Fn(o,F):typeof F=="number"&&Fn(o,""+F):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(i.hasOwnProperty(E)?F!=null&&E==="onScroll"&&rt("scroll",o):F!=null&&Y(o,E,F,I))}switch(d){case"input":$t(o),Go(o,g,!1);break;case"textarea":$t(o),Ji(o);break;case"option":g.value!=null&&o.setAttribute("value",""+Ge(g.value));break;case"select":o.multiple=!!g.multiple,E=g.value,E!=null?Cn(o,!!g.multiple,E,!1):g.defaultValue!=null&&Cn(o,!!g.multiple,g.defaultValue,!0);break;default:typeof v.onClick=="function"&&(o.onclick=Zl)}switch(d){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Jt(s),null;case 6:if(o&&s.stateNode!=null)eg(o,s,o.memoizedProps,g);else{if(typeof g!="string"&&s.stateNode===null)throw Error(t(166));if(d=vo(Na.current),vo(gr.current),ou(s)){if(g=s.stateNode,d=s.memoizedProps,g[mr]=s,(E=g.nodeValue!==d)&&(o=_n,o!==null))switch(o.tag){case 3:Xl(g.nodeValue,d,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Xl(g.nodeValue,d,(o.mode&1)!==0)}E&&(s.flags|=4)}else g=(d.nodeType===9?d:d.ownerDocument).createTextNode(g),g[mr]=s,s.stateNode=g}return Jt(s),null;case 13:if(it(ct),g=s.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(ut&&Tn!==null&&(s.mode&1)!==0&&(s.flags&128)===0)rm(),ys(),s.flags|=98560,E=!1;else if(E=ou(s),g!==null&&g.dehydrated!==null){if(o===null){if(!E)throw Error(t(318));if(E=s.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(t(317));E[mr]=s}else ys(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Jt(s),E=!1}else Yn!==null&&(cf(Yn),Yn=null),E=!0;if(!E)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=d,s):(g=g!==null,g!==(o!==null&&o.memoizedState!==null)&&g&&(s.child.flags|=8192,(s.mode&1)!==0&&(o===null||(ct.current&1)!==0?xt===0&&(xt=3):hf())),s.updateQueue!==null&&(s.flags|=4),Jt(s),null);case 4:return Es(),Zd(o,s),o===null&&Sa(s.stateNode.containerInfo),Jt(s),null;case 10:return Ad(s.type._context),Jt(s),null;case 17:return ln(s.type)&&eu(),Jt(s),null;case 19:if(it(ct),E=s.memoizedState,E===null)return Jt(s),null;if(g=(s.flags&128)!==0,I=E.rendering,I===null)if(g)ba(E,!1);else{if(xt!==0||o!==null&&(o.flags&128)!==0)for(o=s.child;o!==null;){if(I=du(o),I!==null){for(s.flags|=128,ba(E,!1),g=I.updateQueue,g!==null&&(s.updateQueue=g,s.flags|=4),s.subtreeFlags=0,g=d,d=s.child;d!==null;)E=d,o=g,E.flags&=14680066,I=E.alternate,I===null?(E.childLanes=0,E.lanes=o,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=I.childLanes,E.lanes=I.lanes,E.child=I.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=I.memoizedProps,E.memoizedState=I.memoizedState,E.updateQueue=I.updateQueue,E.type=I.type,o=I.dependencies,E.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),d=d.sibling;return nt(ct,ct.current&1|2),s.child}o=o.sibling}E.tail!==null&&tt()>Is&&(s.flags|=128,g=!0,ba(E,!1),s.lanes=4194304)}else{if(!g)if(o=du(I),o!==null){if(s.flags|=128,g=!0,d=o.updateQueue,d!==null&&(s.updateQueue=d,s.flags|=4),ba(E,!0),E.tail===null&&E.tailMode==="hidden"&&!I.alternate&&!ut)return Jt(s),null}else 2*tt()-E.renderingStartTime>Is&&d!==1073741824&&(s.flags|=128,g=!0,ba(E,!1),s.lanes=4194304);E.isBackwards?(I.sibling=s.child,s.child=I):(d=E.last,d!==null?d.sibling=I:s.child=I,E.last=I)}return E.tail!==null?(s=E.tail,E.rendering=s,E.tail=s.sibling,E.renderingStartTime=tt(),s.sibling=null,d=ct.current,nt(ct,g?d&1|2:d&1),s):(Jt(s),null);case 22:case 23:return ff(),g=s.memoizedState!==null,o!==null&&o.memoizedState!==null!==g&&(s.flags|=8192),g&&(s.mode&1)!==0?(En&1073741824)!==0&&(Jt(s),s.subtreeFlags&6&&(s.flags|=8192)):Jt(s),null;case 24:return null;case 25:return null}throw Error(t(156,s.tag))}function yC(o,s){switch(Td(s),s.tag){case 1:return ln(s.type)&&eu(),o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 3:return Es(),it(an),it(zt),Dd(),o=s.flags,(o&65536)!==0&&(o&128)===0?(s.flags=o&-65537|128,s):null;case 5:return Nd(s),null;case 13:if(it(ct),o=s.memoizedState,o!==null&&o.dehydrated!==null){if(s.alternate===null)throw Error(t(340));ys()}return o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 19:return it(ct),null;case 4:return Es(),null;case 10:return Ad(s.type._context),null;case 22:case 23:return ff(),null;case 24:return null;default:return null}}var Tu=!1,Kt=!1,vC=typeof WeakSet=="function"?WeakSet:Set,fe=null;function ws(o,s){var d=o.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){pt(o,s,g)}else d.current=null}function jd(o,s,d){try{d()}catch(g){pt(o,s,g)}}var tg=!1;function _C(o,s){if(dd=fi,o=Dp(),rd(o)){if("selectionStart"in o)var d={start:o.selectionStart,end:o.selectionEnd};else e:{d=(d=o.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var v=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{d.nodeType,E.nodeType}catch{d=null;break e}var I=0,V=-1,F=-1,z=0,ee=0,ne=o,j=null;t:for(;;){for(var ce;ne!==d||v!==0&&ne.nodeType!==3||(V=I+v),ne!==E||g!==0&&ne.nodeType!==3||(F=I+g),ne.nodeType===3&&(I+=ne.nodeValue.length),(ce=ne.firstChild)!==null;)j=ne,ne=ce;for(;;){if(ne===o)break t;if(j===d&&++z===v&&(V=I),j===E&&++ee===g&&(F=I),(ce=ne.nextSibling)!==null)break;ne=j,j=ne.parentNode}ne=ce}d=V===-1||F===-1?null:{start:V,end:F}}else d=null}d=d||{start:0,end:0}}else d=null;for(fd={focusedElem:o,selectionRange:d},fi=!1,fe=s;fe!==null;)if(s=fe,o=s.child,(s.subtreeFlags&1028)!==0&&o!==null)o.return=s,fe=o;else for(;fe!==null;){s=fe;try{var pe=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(pe!==null){var ge=pe.memoizedProps,vt=pe.memoizedState,H=s.stateNode,B=H.getSnapshotBeforeUpdate(s.elementType===s.type?ge:Qn(s.type,ge),vt);H.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var $=s.stateNode.containerInfo;$.nodeType===1?$.textContent="":$.nodeType===9&&$.documentElement&&$.removeChild($.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ie){pt(s,s.return,ie)}if(o=s.sibling,o!==null){o.return=s.return,fe=o;break}fe=s.return}return pe=tg,tg=!1,pe}function Ua(o,s,d){var g=s.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&o)===o){var E=v.destroy;v.destroy=void 0,E!==void 0&&jd(s,d,E)}v=v.next}while(v!==g)}}function Eu(o,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var d=s=s.next;do{if((d.tag&o)===o){var g=d.create;d.destroy=g()}d=d.next}while(d!==s)}}function ef(o){var s=o.ref;if(s!==null){var d=o.stateNode;switch(o.tag){case 5:o=d;break;default:o=d}typeof s=="function"?s(o):s.current=o}}function ng(o){var s=o.alternate;s!==null&&(o.alternate=null,ng(s)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(s=o.stateNode,s!==null&&(delete s[mr],delete s[Aa],delete s[gd],delete s[tC],delete s[nC])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function rg(o){return o.tag===5||o.tag===3||o.tag===4}function ig(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||rg(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function tf(o,s,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,s?d.nodeType===8?d.parentNode.insertBefore(o,s):d.insertBefore(o,s):(d.nodeType===8?(s=d.parentNode,s.insertBefore(o,d)):(s=d,s.appendChild(o)),d=d._reactRootContainer,d!=null||s.onclick!==null||(s.onclick=Zl));else if(g!==4&&(o=o.child,o!==null))for(tf(o,s,d),o=o.sibling;o!==null;)tf(o,s,d),o=o.sibling}function nf(o,s,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,s?d.insertBefore(o,s):d.appendChild(o);else if(g!==4&&(o=o.child,o!==null))for(nf(o,s,d),o=o.sibling;o!==null;)nf(o,s,d),o=o.sibling}var Ot=null,Xn=!1;function Ei(o,s,d){for(d=d.child;d!==null;)og(o,s,d),d=d.sibling}function og(o,s,d){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(oo,d)}catch{}switch(d.tag){case 5:Kt||ws(d,s);case 6:var g=Ot,v=Xn;Ot=null,Ei(o,s,d),Ot=g,Xn=v,Ot!==null&&(Xn?(o=Ot,d=d.stateNode,o.nodeType===8?o.parentNode.removeChild(d):o.removeChild(d)):Ot.removeChild(d.stateNode));break;case 18:Ot!==null&&(Xn?(o=Ot,d=d.stateNode,o.nodeType===8?md(o.parentNode,d):o.nodeType===1&&md(o,d),Wn(o)):md(Ot,d.stateNode));break;case 4:g=Ot,v=Xn,Ot=d.stateNode.containerInfo,Xn=!0,Ei(o,s,d),Ot=g,Xn=v;break;case 0:case 11:case 14:case 15:if(!Kt&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){v=g=g.next;do{var E=v,I=E.destroy;E=E.tag,I!==void 0&&((E&2)!==0||(E&4)!==0)&&jd(d,s,I),v=v.next}while(v!==g)}Ei(o,s,d);break;case 1:if(!Kt&&(ws(d,s),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(V){pt(d,s,V)}Ei(o,s,d);break;case 21:Ei(o,s,d);break;case 22:d.mode&1?(Kt=(g=Kt)||d.memoizedState!==null,Ei(o,s,d),Kt=g):Ei(o,s,d);break;default:Ei(o,s,d)}}function sg(o){var s=o.updateQueue;if(s!==null){o.updateQueue=null;var d=o.stateNode;d===null&&(d=o.stateNode=new vC),s.forEach(function(g){var v=kC.bind(null,o,g);d.has(g)||(d.add(g),g.then(v,v))})}}function Zn(o,s){var d=s.deletions;if(d!==null)for(var g=0;g<d.length;g++){var v=d[g];try{var E=o,I=s,V=I;e:for(;V!==null;){switch(V.tag){case 5:Ot=V.stateNode,Xn=!1;break e;case 3:Ot=V.stateNode.containerInfo,Xn=!0;break e;case 4:Ot=V.stateNode.containerInfo,Xn=!0;break e}V=V.return}if(Ot===null)throw Error(t(160));og(E,I,v),Ot=null,Xn=!1;var F=v.alternate;F!==null&&(F.return=null),v.return=null}catch(z){pt(v,s,z)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)ag(s,o),s=s.sibling}function ag(o,s){var d=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Zn(s,o),vr(o),g&4){try{Ua(3,o,o.return),Eu(3,o)}catch(ge){pt(o,o.return,ge)}try{Ua(5,o,o.return)}catch(ge){pt(o,o.return,ge)}}break;case 1:Zn(s,o),vr(o),g&512&&d!==null&&ws(d,d.return);break;case 5:if(Zn(s,o),vr(o),g&512&&d!==null&&ws(d,d.return),o.flags&32){var v=o.stateNode;try{Fn(v,"")}catch(ge){pt(o,o.return,ge)}}if(g&4&&(v=o.stateNode,v!=null)){var E=o.memoizedProps,I=d!==null?d.memoizedProps:E,V=o.type,F=o.updateQueue;if(o.updateQueue=null,F!==null)try{V==="input"&&E.type==="radio"&&E.name!=null&&ti(v,E),ji(V,I);var z=ji(V,E);for(I=0;I<F.length;I+=2){var ee=F[I],ne=F[I+1];ee==="style"?Qi(v,ne):ee==="dangerouslySetInnerHTML"?Ki(v,ne):ee==="children"?Fn(v,ne):Y(v,ee,ne,z)}switch(V){case"input":Pr(v,E);break;case"textarea":ii(v,E);break;case"select":var j=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!E.multiple;var ce=E.value;ce!=null?Cn(v,!!E.multiple,ce,!1):j!==!!E.multiple&&(E.defaultValue!=null?Cn(v,!!E.multiple,E.defaultValue,!0):Cn(v,!!E.multiple,E.multiple?[]:"",!1))}v[Aa]=E}catch(ge){pt(o,o.return,ge)}}break;case 6:if(Zn(s,o),vr(o),g&4){if(o.stateNode===null)throw Error(t(162));v=o.stateNode,E=o.memoizedProps;try{v.nodeValue=E}catch(ge){pt(o,o.return,ge)}}break;case 3:if(Zn(s,o),vr(o),g&4&&d!==null&&d.memoizedState.isDehydrated)try{Wn(s.containerInfo)}catch(ge){pt(o,o.return,ge)}break;case 4:Zn(s,o),vr(o);break;case 13:Zn(s,o),vr(o),v=o.child,v.flags&8192&&(E=v.memoizedState!==null,v.stateNode.isHidden=E,!E||v.alternate!==null&&v.alternate.memoizedState!==null||(sf=tt())),g&4&&sg(o);break;case 22:if(ee=d!==null&&d.memoizedState!==null,o.mode&1?(Kt=(z=Kt)||ee,Zn(s,o),Kt=z):Zn(s,o),vr(o),g&8192){if(z=o.memoizedState!==null,(o.stateNode.isHidden=z)&&!ee&&(o.mode&1)!==0)for(fe=o,ee=o.child;ee!==null;){for(ne=fe=ee;fe!==null;){switch(j=fe,ce=j.child,j.tag){case 0:case 11:case 14:case 15:Ua(4,j,j.return);break;case 1:ws(j,j.return);var pe=j.stateNode;if(typeof pe.componentWillUnmount=="function"){g=j,d=j.return;try{s=g,pe.props=s.memoizedProps,pe.state=s.memoizedState,pe.componentWillUnmount()}catch(ge){pt(g,d,ge)}}break;case 5:ws(j,j.return);break;case 22:if(j.memoizedState!==null){cg(ne);continue}}ce!==null?(ce.return=j,fe=ce):cg(ne)}ee=ee.sibling}e:for(ee=null,ne=o;;){if(ne.tag===5){if(ee===null){ee=ne;try{v=ne.stateNode,z?(E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(V=ne.stateNode,F=ne.memoizedProps.style,I=F!=null&&F.hasOwnProperty("display")?F.display:null,V.style.display=Yi("display",I))}catch(ge){pt(o,o.return,ge)}}}else if(ne.tag===6){if(ee===null)try{ne.stateNode.nodeValue=z?"":ne.memoizedProps}catch(ge){pt(o,o.return,ge)}}else if((ne.tag!==22&&ne.tag!==23||ne.memoizedState===null||ne===o)&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===o)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===o)break e;ee===ne&&(ee=null),ne=ne.return}ee===ne&&(ee=null),ne.sibling.return=ne.return,ne=ne.sibling}}break;case 19:Zn(s,o),vr(o),g&4&&sg(o);break;case 21:break;default:Zn(s,o),vr(o)}}function vr(o){var s=o.flags;if(s&2){try{e:{for(var d=o.return;d!==null;){if(rg(d)){var g=d;break e}d=d.return}throw Error(t(160))}switch(g.tag){case 5:var v=g.stateNode;g.flags&32&&(Fn(v,""),g.flags&=-33);var E=ig(o);nf(o,E,v);break;case 3:case 4:var I=g.stateNode.containerInfo,V=ig(o);tf(o,V,I);break;default:throw Error(t(161))}}catch(F){pt(o,o.return,F)}o.flags&=-3}s&4096&&(o.flags&=-4097)}function TC(o,s,d){fe=o,lg(o)}function lg(o,s,d){for(var g=(o.mode&1)!==0;fe!==null;){var v=fe,E=v.child;if(v.tag===22&&g){var I=v.memoizedState!==null||Tu;if(!I){var V=v.alternate,F=V!==null&&V.memoizedState!==null||Kt;V=Tu;var z=Kt;if(Tu=I,(Kt=F)&&!z)for(fe=v;fe!==null;)I=fe,F=I.child,I.tag===22&&I.memoizedState!==null?dg(v):F!==null?(F.return=I,fe=F):dg(v);for(;E!==null;)fe=E,lg(E),E=E.sibling;fe=v,Tu=V,Kt=z}ug(o)}else(v.subtreeFlags&8772)!==0&&E!==null?(E.return=v,fe=E):ug(o)}}function ug(o){for(;fe!==null;){var s=fe;if((s.flags&8772)!==0){var d=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:Kt||Eu(5,s);break;case 1:var g=s.stateNode;if(s.flags&4&&!Kt)if(d===null)g.componentDidMount();else{var v=s.elementType===s.type?d.memoizedProps:Qn(s.type,d.memoizedProps);g.componentDidUpdate(v,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var E=s.updateQueue;E!==null&&cm(s,E,g);break;case 3:var I=s.updateQueue;if(I!==null){if(d=null,s.child!==null)switch(s.child.tag){case 5:d=s.child.stateNode;break;case 1:d=s.child.stateNode}cm(s,I,d)}break;case 5:var V=s.stateNode;if(d===null&&s.flags&4){d=V;var F=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":F.autoFocus&&d.focus();break;case"img":F.src&&(d.src=F.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var z=s.alternate;if(z!==null){var ee=z.memoizedState;if(ee!==null){var ne=ee.dehydrated;ne!==null&&Wn(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kt||s.flags&512&&ef(s)}catch(j){pt(s,s.return,j)}}if(s===o){fe=null;break}if(d=s.sibling,d!==null){d.return=s.return,fe=d;break}fe=s.return}}function cg(o){for(;fe!==null;){var s=fe;if(s===o){fe=null;break}var d=s.sibling;if(d!==null){d.return=s.return,fe=d;break}fe=s.return}}function dg(o){for(;fe!==null;){var s=fe;try{switch(s.tag){case 0:case 11:case 15:var d=s.return;try{Eu(4,s)}catch(F){pt(s,d,F)}break;case 1:var g=s.stateNode;if(typeof g.componentDidMount=="function"){var v=s.return;try{g.componentDidMount()}catch(F){pt(s,v,F)}}var E=s.return;try{ef(s)}catch(F){pt(s,E,F)}break;case 5:var I=s.return;try{ef(s)}catch(F){pt(s,I,F)}}}catch(F){pt(s,s.return,F)}if(s===o){fe=null;break}var V=s.sibling;if(V!==null){V.return=s.return,fe=V;break}fe=s.return}}var EC=Math.ceil,Cu=re.ReactCurrentDispatcher,rf=re.ReactCurrentOwner,Pn=re.ReactCurrentBatchConfig,We=0,Dt=null,Ct=null,Bt=0,En=0,Ss=gi(0),xt=0,Fa=null,To=0,wu=0,of=0,Oa=null,cn=null,sf=0,Is=1/0,zr=null,Su=!1,af=null,Ci=null,Iu=!1,wi=null,Au=0,Ba=0,lf=null,xu=-1,ku=0;function rn(){return(We&6)!==0?tt():xu!==-1?xu:xu=tt()}function Si(o){return(o.mode&1)===0?1:(We&2)!==0&&Bt!==0?Bt&-Bt:iC.transition!==null?(ku===0&&(ku=ao()),ku):(o=qe,o!==0||(o=window.event,o=o===void 0?16:pa(o.type)),o)}function jn(o,s,d,g){if(50<Ba)throw Ba=0,lf=null,Error(t(185));li(o,d,g),((We&2)===0||o!==Dt)&&(o===Dt&&((We&2)===0&&(wu|=d),xt===4&&Ii(o,Bt)),dn(o,g),d===1&&We===0&&(s.mode&1)===0&&(Is=tt()+500,nu&&vi()))}function dn(o,s){var d=o.callbackNode;Dr(o,s);var g=so(o,o===Dt?Bt:0);if(g===0)d!==null&&ua(d),o.callbackNode=null,o.callbackPriority=0;else if(s=g&-g,o.callbackPriority!==s){if(d!=null&&ua(d),s===1)o.tag===0?rC(hg.bind(null,o)):Zp(hg.bind(null,o)),jE(function(){(We&6)===0&&vi()}),d=null;else{switch(ci(g)){case 1:d=io;break;case 4:d=oi;break;case 16:d=wn;break;case 536870912:d=kl;break;default:d=wn}d=Eg(d,fg.bind(null,o))}o.callbackPriority=s,o.callbackNode=d}}function fg(o,s){if(xu=-1,ku=0,(We&6)!==0)throw Error(t(327));var d=o.callbackNode;if(As()&&o.callbackNode!==d)return null;var g=so(o,o===Dt?Bt:0);if(g===0)return null;if((g&30)!==0||(g&o.expiredLanes)!==0||s)s=Ru(o,g);else{s=g;var v=We;We|=2;var E=mg();(Dt!==o||Bt!==s)&&(zr=null,Is=tt()+500,Co(o,s));do try{SC();break}catch(V){pg(o,V)}while(!0);Id(),Cu.current=E,We=v,Ct!==null?s=0:(Dt=null,Bt=0,s=xt)}if(s!==0){if(s===2&&(v=gn(o),v!==0&&(g=v,s=uf(o,v))),s===1)throw d=Fa,Co(o,0),Ii(o,g),dn(o,tt()),d;if(s===6)Ii(o,g);else{if(v=o.current.alternate,(g&30)===0&&!CC(v)&&(s=Ru(o,g),s===2&&(E=gn(o),E!==0&&(g=E,s=uf(o,E))),s===1))throw d=Fa,Co(o,0),Ii(o,g),dn(o,tt()),d;switch(o.finishedWork=v,o.finishedLanes=g,s){case 0:case 1:throw Error(t(345));case 2:wo(o,cn,zr);break;case 3:if(Ii(o,g),(g&130023424)===g&&(s=sf+500-tt(),10<s)){if(so(o,0)!==0)break;if(v=o.suspendedLanes,(v&g)!==g){rn(),o.pingedLanes|=o.suspendedLanes&v;break}o.timeoutHandle=pd(wo.bind(null,o,cn,zr),s);break}wo(o,cn,zr);break;case 4:if(Ii(o,g),(g&4194240)===g)break;for(s=o.eventTimes,v=-1;0<g;){var I=31-en(g);E=1<<I,I=s[I],I>v&&(v=I),g&=~E}if(g=v,g=tt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*EC(g/1960))-g,10<g){o.timeoutHandle=pd(wo.bind(null,o,cn,zr),g);break}wo(o,cn,zr);break;case 5:wo(o,cn,zr);break;default:throw Error(t(329))}}}return dn(o,tt()),o.callbackNode===d?fg.bind(null,o):null}function uf(o,s){var d=Oa;return o.current.memoizedState.isDehydrated&&(Co(o,s).flags|=256),o=Ru(o,s),o!==2&&(s=cn,cn=d,s!==null&&cf(s)),o}function cf(o){cn===null?cn=o:cn.push.apply(cn,o)}function CC(o){for(var s=o;;){if(s.flags&16384){var d=s.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var v=d[g],E=v.getSnapshot;v=v.value;try{if(!Kn(E(),v))return!1}catch{return!1}}}if(d=s.child,s.subtreeFlags&16384&&d!==null)d.return=s,s=d;else{if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ii(o,s){for(s&=~of,s&=~wu,o.suspendedLanes|=s,o.pingedLanes&=~s,o=o.expirationTimes;0<s;){var d=31-en(s),g=1<<d;o[d]=-1,s&=~g}}function hg(o){if((We&6)!==0)throw Error(t(327));As();var s=so(o,0);if((s&1)===0)return dn(o,tt()),null;var d=Ru(o,s);if(o.tag!==0&&d===2){var g=gn(o);g!==0&&(s=g,d=uf(o,g))}if(d===1)throw d=Fa,Co(o,0),Ii(o,s),dn(o,tt()),d;if(d===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=s,wo(o,cn,zr),dn(o,tt()),null}function df(o,s){var d=We;We|=1;try{return o(s)}finally{We=d,We===0&&(Is=tt()+500,nu&&vi())}}function Eo(o){wi!==null&&wi.tag===0&&(We&6)===0&&As();var s=We;We|=1;var d=Pn.transition,g=qe;try{if(Pn.transition=null,qe=1,o)return o()}finally{qe=g,Pn.transition=d,We=s,(We&6)===0&&vi()}}function ff(){En=Ss.current,it(Ss)}function Co(o,s){o.finishedWork=null,o.finishedLanes=0;var d=o.timeoutHandle;if(d!==-1&&(o.timeoutHandle=-1,ZE(d)),Ct!==null)for(d=Ct.return;d!==null;){var g=d;switch(Td(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&eu();break;case 3:Es(),it(an),it(zt),Dd();break;case 5:Nd(g);break;case 4:Es();break;case 13:it(ct);break;case 19:it(ct);break;case 10:Ad(g.type._context);break;case 22:case 23:ff()}d=d.return}if(Dt=o,Ct=o=Ai(o.current,null),Bt=En=s,xt=0,Fa=null,of=wu=To=0,cn=Oa=null,yo!==null){for(s=0;s<yo.length;s++)if(d=yo[s],g=d.interleaved,g!==null){d.interleaved=null;var v=g.next,E=d.pending;if(E!==null){var I=E.next;E.next=v,g.next=I}d.pending=g}yo=null}return o}function pg(o,s){do{var d=Ct;try{if(Id(),fu.current=gu,hu){for(var g=dt.memoizedState;g!==null;){var v=g.queue;v!==null&&(v.pending=null),g=g.next}hu=!1}if(_o=0,Mt=At=dt=null,Ma=!1,Da=0,rf.current=null,d===null||d.return===null){xt=1,Fa=s,Ct=null;break}e:{var E=o,I=d.return,V=d,F=s;if(s=Bt,V.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var z=F,ee=V,ne=ee.tag;if((ee.mode&1)===0&&(ne===0||ne===11||ne===15)){var j=ee.alternate;j?(ee.updateQueue=j.updateQueue,ee.memoizedState=j.memoizedState,ee.lanes=j.lanes):(ee.updateQueue=null,ee.memoizedState=null)}var ce=Om(I);if(ce!==null){ce.flags&=-257,Bm(ce,I,V,E,s),ce.mode&1&&Fm(E,z,s),s=ce,F=z;var pe=s.updateQueue;if(pe===null){var ge=new Set;ge.add(F),s.updateQueue=ge}else pe.add(F);break e}else{if((s&1)===0){Fm(E,z,s),hf();break e}F=Error(t(426))}}else if(ut&&V.mode&1){var vt=Om(I);if(vt!==null){(vt.flags&65536)===0&&(vt.flags|=256),Bm(vt,I,V,E,s),wd(Cs(F,V));break e}}E=F=Cs(F,V),xt!==4&&(xt=2),Oa===null?Oa=[E]:Oa.push(E),E=I;do{switch(E.tag){case 3:E.flags|=65536,s&=-s,E.lanes|=s;var H=bm(E,F,s);um(E,H);break e;case 1:V=F;var B=E.type,$=E.stateNode;if((E.flags&128)===0&&(typeof B.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(Ci===null||!Ci.has($)))){E.flags|=65536,s&=-s,E.lanes|=s;var ie=Um(E,V,s);um(E,ie);break e}}E=E.return}while(E!==null)}yg(d)}catch(ve){s=ve,Ct===d&&d!==null&&(Ct=d=d.return);continue}break}while(!0)}function mg(){var o=Cu.current;return Cu.current=gu,o===null?gu:o}function hf(){(xt===0||xt===3||xt===2)&&(xt=4),Dt===null||(To&268435455)===0&&(wu&268435455)===0||Ii(Dt,Bt)}function Ru(o,s){var d=We;We|=2;var g=mg();(Dt!==o||Bt!==s)&&(zr=null,Co(o,s));do try{wC();break}catch(v){pg(o,v)}while(!0);if(Id(),We=d,Cu.current=g,Ct!==null)throw Error(t(261));return Dt=null,Bt=0,xt}function wC(){for(;Ct!==null;)gg(Ct)}function SC(){for(;Ct!==null&&!Al();)gg(Ct)}function gg(o){var s=Tg(o.alternate,o,En);o.memoizedProps=o.pendingProps,s===null?yg(o):Ct=s,rf.current=null}function yg(o){var s=o;do{var d=s.alternate;if(o=s.return,(s.flags&32768)===0){if(d=gC(d,s,En),d!==null){Ct=d;return}}else{if(d=yC(d,s),d!==null){d.flags&=32767,Ct=d;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{xt=6,Ct=null;return}}if(s=s.sibling,s!==null){Ct=s;return}Ct=s=o}while(s!==null);xt===0&&(xt=5)}function wo(o,s,d){var g=qe,v=Pn.transition;try{Pn.transition=null,qe=1,IC(o,s,d,g)}finally{Pn.transition=v,qe=g}return null}function IC(o,s,d,g){do As();while(wi!==null);if((We&6)!==0)throw Error(t(327));d=o.finishedWork;var v=o.finishedLanes;if(d===null)return null;if(o.finishedWork=null,o.finishedLanes=0,d===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var E=d.lanes|d.childLanes;if(et(o,E),o===Dt&&(Ct=Dt=null,Bt=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Iu||(Iu=!0,Eg(wn,function(){return As(),null})),E=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||E){E=Pn.transition,Pn.transition=null;var I=qe;qe=1;var V=We;We|=4,rf.current=null,_C(o,d),ag(d,o),zE(fd),fi=!!dd,fd=dd=null,o.current=d,TC(d),Yc(),We=V,qe=I,Pn.transition=E}else o.current=d;if(Iu&&(Iu=!1,wi=o,Au=v),E=o.pendingLanes,E===0&&(Ci=null),Rl(d.stateNode),dn(o,tt()),s!==null)for(g=o.onRecoverableError,d=0;d<s.length;d++)v=s[d],g(v.value,{componentStack:v.stack,digest:v.digest});if(Su)throw Su=!1,o=af,af=null,o;return(Au&1)!==0&&o.tag!==0&&As(),E=o.pendingLanes,(E&1)!==0?o===lf?Ba++:(Ba=0,lf=o):Ba=0,vi(),null}function As(){if(wi!==null){var o=ci(Au),s=Pn.transition,d=qe;try{if(Pn.transition=null,qe=16>o?16:o,wi===null)var g=!1;else{if(o=wi,wi=null,Au=0,(We&6)!==0)throw Error(t(331));var v=We;for(We|=4,fe=o.current;fe!==null;){var E=fe,I=E.child;if((fe.flags&16)!==0){var V=E.deletions;if(V!==null){for(var F=0;F<V.length;F++){var z=V[F];for(fe=z;fe!==null;){var ee=fe;switch(ee.tag){case 0:case 11:case 15:Ua(8,ee,E)}var ne=ee.child;if(ne!==null)ne.return=ee,fe=ne;else for(;fe!==null;){ee=fe;var j=ee.sibling,ce=ee.return;if(ng(ee),ee===z){fe=null;break}if(j!==null){j.return=ce,fe=j;break}fe=ce}}}var pe=E.alternate;if(pe!==null){var ge=pe.child;if(ge!==null){pe.child=null;do{var vt=ge.sibling;ge.sibling=null,ge=vt}while(ge!==null)}}fe=E}}if((E.subtreeFlags&2064)!==0&&I!==null)I.return=E,fe=I;else e:for(;fe!==null;){if(E=fe,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:Ua(9,E,E.return)}var H=E.sibling;if(H!==null){H.return=E.return,fe=H;break e}fe=E.return}}var B=o.current;for(fe=B;fe!==null;){I=fe;var $=I.child;if((I.subtreeFlags&2064)!==0&&$!==null)$.return=I,fe=$;else e:for(I=B;fe!==null;){if(V=fe,(V.flags&2048)!==0)try{switch(V.tag){case 0:case 11:case 15:Eu(9,V)}}catch(ve){pt(V,V.return,ve)}if(V===I){fe=null;break e}var ie=V.sibling;if(ie!==null){ie.return=V.return,fe=ie;break e}fe=V.return}}if(We=v,vi(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(oo,o)}catch{}g=!0}return g}finally{qe=d,Pn.transition=s}}return!1}function vg(o,s,d){s=Cs(d,s),s=bm(o,s,1),o=Ti(o,s,1),s=rn(),o!==null&&(li(o,1,s),dn(o,s))}function pt(o,s,d){if(o.tag===3)vg(o,o,d);else for(;s!==null;){if(s.tag===3){vg(s,o,d);break}else if(s.tag===1){var g=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Ci===null||!Ci.has(g))){o=Cs(d,o),o=Um(s,o,1),s=Ti(s,o,1),o=rn(),s!==null&&(li(s,1,o),dn(s,o));break}}s=s.return}}function AC(o,s,d){var g=o.pingCache;g!==null&&g.delete(s),s=rn(),o.pingedLanes|=o.suspendedLanes&d,Dt===o&&(Bt&d)===d&&(xt===4||xt===3&&(Bt&130023424)===Bt&&500>tt()-sf?Co(o,0):of|=d),dn(o,s)}function _g(o,s){s===0&&((o.mode&1)===0?s=1:(s=Yo,Yo<<=1,(Yo&130023424)===0&&(Yo=4194304)));var d=rn();o=Gr(o,s),o!==null&&(li(o,s,d),dn(o,d))}function xC(o){var s=o.memoizedState,d=0;s!==null&&(d=s.retryLane),_g(o,d)}function kC(o,s){var d=0;switch(o.tag){case 13:var g=o.stateNode,v=o.memoizedState;v!==null&&(d=v.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(s),_g(o,d)}var Tg;Tg=function(o,s,d){if(o!==null)if(o.memoizedProps!==s.pendingProps||an.current)un=!0;else{if((o.lanes&d)===0&&(s.flags&128)===0)return un=!1,mC(o,s,d);un=(o.flags&131072)!==0}else un=!1,ut&&(s.flags&1048576)!==0&&jp(s,iu,s.index);switch(s.lanes=0,s.tag){case 2:var g=s.type;_u(o,s),o=s.pendingProps;var v=ps(s,zt.current);Ts(s,d),v=bd(null,s,g,o,v,d);var E=Ud();return s.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,ln(g)?(E=!0,tu(s)):E=!1,s.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Rd(s),v.updater=yu,s.stateNode=v,v._reactInternals=s,Hd(s,g,o,d),s=Jd(null,s,g,!0,E,d)):(s.tag=0,ut&&E&&_d(s),nn(null,s,v,d),s=s.child),s;case 16:g=s.elementType;e:{switch(_u(o,s),o=s.pendingProps,v=g._init,g=v(g._payload),s.type=g,v=s.tag=PC(g),o=Qn(g,o),v){case 0:s=Wd(null,s,g,o,d);break e;case 1:s=Wm(null,s,g,o,d);break e;case 11:s=qm(null,s,g,o,d);break e;case 14:s=Gm(null,s,g,Qn(g.type,o),d);break e}throw Error(t(306,g,""))}return s;case 0:return g=s.type,v=s.pendingProps,v=s.elementType===g?v:Qn(g,v),Wd(o,s,g,v,d);case 1:return g=s.type,v=s.pendingProps,v=s.elementType===g?v:Qn(g,v),Wm(o,s,g,v,d);case 3:e:{if(Jm(s),o===null)throw Error(t(387));g=s.pendingProps,E=s.memoizedState,v=E.element,lm(o,s),cu(s,g,null,d);var I=s.memoizedState;if(g=I.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},s.updateQueue.baseState=E,s.memoizedState=E,s.flags&256){v=Cs(Error(t(423)),s),s=Km(o,s,g,d,v);break e}else if(g!==v){v=Cs(Error(t(424)),s),s=Km(o,s,g,d,v);break e}else for(Tn=mi(s.stateNode.containerInfo.firstChild),_n=s,ut=!0,Yn=null,d=sm(s,null,g,d),s.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(ys(),g===v){s=$r(o,s,d);break e}nn(o,s,g,d)}s=s.child}return s;case 5:return dm(s),o===null&&Cd(s),g=s.type,v=s.pendingProps,E=o!==null?o.memoizedProps:null,I=v.children,hd(g,v)?I=null:E!==null&&hd(g,E)&&(s.flags|=32),zm(o,s),nn(o,s,I,d),s.child;case 6:return o===null&&Cd(s),null;case 13:return Ym(o,s,d);case 4:return Pd(s,s.stateNode.containerInfo),g=s.pendingProps,o===null?s.child=vs(s,null,g,d):nn(o,s,g,d),s.child;case 11:return g=s.type,v=s.pendingProps,v=s.elementType===g?v:Qn(g,v),qm(o,s,g,v,d);case 7:return nn(o,s,s.pendingProps,d),s.child;case 8:return nn(o,s,s.pendingProps.children,d),s.child;case 12:return nn(o,s,s.pendingProps.children,d),s.child;case 10:e:{if(g=s.type._context,v=s.pendingProps,E=s.memoizedProps,I=v.value,nt(au,g._currentValue),g._currentValue=I,E!==null)if(Kn(E.value,I)){if(E.children===v.children&&!an.current){s=$r(o,s,d);break e}}else for(E=s.child,E!==null&&(E.return=s);E!==null;){var V=E.dependencies;if(V!==null){I=E.child;for(var F=V.firstContext;F!==null;){if(F.context===g){if(E.tag===1){F=Hr(-1,d&-d),F.tag=2;var z=E.updateQueue;if(z!==null){z=z.shared;var ee=z.pending;ee===null?F.next=F:(F.next=ee.next,ee.next=F),z.pending=F}}E.lanes|=d,F=E.alternate,F!==null&&(F.lanes|=d),xd(E.return,d,s),V.lanes|=d;break}F=F.next}}else if(E.tag===10)I=E.type===s.type?null:E.child;else if(E.tag===18){if(I=E.return,I===null)throw Error(t(341));I.lanes|=d,V=I.alternate,V!==null&&(V.lanes|=d),xd(I,d,s),I=E.sibling}else I=E.child;if(I!==null)I.return=E;else for(I=E;I!==null;){if(I===s){I=null;break}if(E=I.sibling,E!==null){E.return=I.return,I=E;break}I=I.return}E=I}nn(o,s,v.children,d),s=s.child}return s;case 9:return v=s.type,g=s.pendingProps.children,Ts(s,d),v=kn(v),g=g(v),s.flags|=1,nn(o,s,g,d),s.child;case 14:return g=s.type,v=Qn(g,s.pendingProps),v=Qn(g.type,v),Gm(o,s,g,v,d);case 15:return Hm(o,s,s.type,s.pendingProps,d);case 17:return g=s.type,v=s.pendingProps,v=s.elementType===g?v:Qn(g,v),_u(o,s),s.tag=1,ln(g)?(o=!0,tu(s)):o=!1,Ts(s,d),Vm(s,g,v),Hd(s,g,v,d),Jd(null,s,g,!0,o,d);case 19:return Xm(o,s,d);case 22:return $m(o,s,d)}throw Error(t(156,s.tag))};function Eg(o,s){return Jo(o,s)}function RC(o,s,d,g){this.tag=o,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nn(o,s,d,g){return new RC(o,s,d,g)}function pf(o){return o=o.prototype,!(!o||!o.isReactComponent)}function PC(o){if(typeof o=="function")return pf(o)?1:0;if(o!=null){if(o=o.$$typeof,o===b)return 11;if(o===De)return 14}return 2}function Ai(o,s){var d=o.alternate;return d===null?(d=Nn(o.tag,s,o.key,o.mode),d.elementType=o.elementType,d.type=o.type,d.stateNode=o.stateNode,d.alternate=o,o.alternate=d):(d.pendingProps=s,d.type=o.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=o.flags&14680064,d.childLanes=o.childLanes,d.lanes=o.lanes,d.child=o.child,d.memoizedProps=o.memoizedProps,d.memoizedState=o.memoizedState,d.updateQueue=o.updateQueue,s=o.dependencies,d.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},d.sibling=o.sibling,d.index=o.index,d.ref=o.ref,d}function Pu(o,s,d,g,v,E){var I=2;if(g=o,typeof o=="function")pf(o)&&(I=1);else if(typeof o=="string")I=5;else e:switch(o){case D:return So(d.children,v,E,s);case k:I=8,v|=8;break;case x:return o=Nn(12,d,s,v|2),o.elementType=x,o.lanes=E,o;case M:return o=Nn(13,d,s,v),o.elementType=M,o.lanes=E,o;case Pe:return o=Nn(19,d,s,v),o.elementType=Pe,o.lanes=E,o;case Le:return Nu(d,v,E,s);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case P:I=10;break e;case N:I=9;break e;case b:I=11;break e;case De:I=14;break e;case Ne:I=16,g=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return s=Nn(I,d,s,v),s.elementType=o,s.type=g,s.lanes=E,s}function So(o,s,d,g){return o=Nn(7,o,g,s),o.lanes=d,o}function Nu(o,s,d,g){return o=Nn(22,o,g,s),o.elementType=Le,o.lanes=d,o.stateNode={isHidden:!1},o}function mf(o,s,d){return o=Nn(6,o,null,s),o.lanes=d,o}function gf(o,s,d){return s=Nn(4,o.children!==null?o.children:[],o.key,s),s.lanes=d,s.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},s}function NC(o,s,d,g,v){this.tag=s,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ai(0),this.expirationTimes=ai(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ai(0),this.identifierPrefix=g,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function yf(o,s,d,g,v,E,I,V,F){return o=new NC(o,s,d,V,F),s===1?(s=1,E===!0&&(s|=8)):s=0,E=Nn(3,null,null,s),o.current=E,E.stateNode=o,E.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rd(E),o}function MC(o,s,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Z,key:g==null?null:""+g,children:o,containerInfo:s,implementation:d}}function Cg(o){if(!o)return yi;o=o._reactInternals;e:{if(qn(o)!==o||o.tag!==1)throw Error(t(170));var s=o;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(ln(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(t(171))}if(o.tag===1){var d=o.type;if(ln(d))return Qp(o,d,s)}return s}function wg(o,s,d,g,v,E,I,V,F){return o=yf(d,g,!0,o,v,E,I,V,F),o.context=Cg(null),d=o.current,g=rn(),v=Si(d),E=Hr(g,v),E.callback=s??null,Ti(d,E,v),o.current.lanes=v,li(o,v,g),dn(o,g),o}function Mu(o,s,d,g){var v=s.current,E=rn(),I=Si(v);return d=Cg(d),s.context===null?s.context=d:s.pendingContext=d,s=Hr(E,I),s.payload={element:o},g=g===void 0?null:g,g!==null&&(s.callback=g),o=Ti(v,s,I),o!==null&&(jn(o,v,I,E),uu(o,v,I)),I}function Du(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function Sg(o,s){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var d=o.retryLane;o.retryLane=d!==0&&d<s?d:s}}function vf(o,s){Sg(o,s),(o=o.alternate)&&Sg(o,s)}function DC(){return null}var Ig=typeof reportError=="function"?reportError:function(o){console.error(o)};function _f(o){this._internalRoot=o}Vu.prototype.render=_f.prototype.render=function(o){var s=this._internalRoot;if(s===null)throw Error(t(409));Mu(o,s,null,null)},Vu.prototype.unmount=_f.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var s=o.containerInfo;Eo(function(){Mu(null,o,null,null)}),s[Fr]=null}};function Vu(o){this._internalRoot=o}Vu.prototype.unstable_scheduleHydration=function(o){if(o){var s=Vl();o={blockedOn:null,target:o,priority:s};for(var d=0;d<dr.length&&s!==0&&s<dr[d].priority;d++);dr.splice(d,0,o),d===0&&Ul(o)}};function Tf(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Lu(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function Ag(){}function VC(o,s,d,g,v){if(v){if(typeof g=="function"){var E=g;g=function(){var z=Du(I);E.call(z)}}var I=wg(s,g,o,0,null,!1,!1,"",Ag);return o._reactRootContainer=I,o[Fr]=I.current,Sa(o.nodeType===8?o.parentNode:o),Eo(),I}for(;v=o.lastChild;)o.removeChild(v);if(typeof g=="function"){var V=g;g=function(){var z=Du(F);V.call(z)}}var F=yf(o,0,!1,null,null,!1,!1,"",Ag);return o._reactRootContainer=F,o[Fr]=F.current,Sa(o.nodeType===8?o.parentNode:o),Eo(function(){Mu(s,F,d,g)}),F}function bu(o,s,d,g,v){var E=d._reactRootContainer;if(E){var I=E;if(typeof v=="function"){var V=v;v=function(){var F=Du(I);V.call(F)}}Mu(s,I,o,v)}else I=VC(d,s,o,v,g);return Du(I)}Ml=function(o){switch(o.tag){case 3:var s=o.stateNode;if(s.current.memoizedState.isDehydrated){var d=si(s.pendingLanes);d!==0&&(ui(s,d|1),dn(s,tt()),(We&6)===0&&(Is=tt()+500,vi()))}break;case 13:Eo(function(){var g=Gr(o,1);if(g!==null){var v=rn();jn(g,o,1,v)}}),vf(o,1)}},Qo=function(o){if(o.tag===13){var s=Gr(o,134217728);if(s!==null){var d=rn();jn(s,o,134217728,d)}vf(o,134217728)}},Dl=function(o){if(o.tag===13){var s=Si(o),d=Gr(o,s);if(d!==null){var g=rn();jn(d,o,s,g)}vf(o,s)}},Vl=function(){return qe},Ll=function(o,s){var d=qe;try{return qe=o,s()}finally{qe=d}},Qe=function(o,s,d){switch(s){case"input":if(Pr(o,d),s=d.name,d.type==="radio"&&s!=null){for(d=o;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<d.length;s++){var g=d[s];if(g!==o&&g.form===o.form){var v=jl(g);if(!v)throw Error(t(90));or(g),Pr(g,v)}}}break;case"textarea":ii(o,d);break;case"select":s=d.value,s!=null&&Cn(o,!!d.multiple,s,!1)}},eo=df,oa=Eo;var LC={usingClientEntryPoint:!1,Events:[xa,fs,jl,ur,ia,df]},qa={findFiberByHostInstance:ho,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bC={bundleType:qa.bundleType,version:qa.version,rendererPackageName:qa.rendererPackageName,rendererConfig:qa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:re.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=la(o),o===null?null:o.stateNode},findFiberByHostInstance:qa.findFiberByHostInstance||DC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uu.isDisabled&&Uu.supportsFiber)try{oo=Uu.inject(bC),mn=Uu}catch{}}return fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LC,fn.createPortal=function(o,s){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tf(s))throw Error(t(200));return MC(o,s,null,d)},fn.createRoot=function(o,s){if(!Tf(o))throw Error(t(299));var d=!1,g="",v=Ig;return s!=null&&(s.unstable_strictMode===!0&&(d=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onRecoverableError!==void 0&&(v=s.onRecoverableError)),s=yf(o,1,!1,null,null,d,!1,g,v),o[Fr]=s.current,Sa(o.nodeType===8?o.parentNode:o),new _f(s)},fn.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var s=o._reactInternals;if(s===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=la(s),o=o===null?null:o.stateNode,o},fn.flushSync=function(o){return Eo(o)},fn.hydrate=function(o,s,d){if(!Lu(s))throw Error(t(200));return bu(null,o,s,!0,d)},fn.hydrateRoot=function(o,s,d){if(!Tf(o))throw Error(t(405));var g=d!=null&&d.hydratedSources||null,v=!1,E="",I=Ig;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(E=d.identifierPrefix),d.onRecoverableError!==void 0&&(I=d.onRecoverableError)),s=wg(s,null,o,1,d??null,v,!1,E,I),o[Fr]=s.current,Sa(o),g)for(o=0;o<g.length;o++)d=g[o],v=d._getVersion,v=v(d._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[d,v]:s.mutableSourceEagerHydrationData.push(d,v);return new Vu(s)},fn.render=function(o,s,d){if(!Lu(s))throw Error(t(200));return bu(null,o,s,!1,d)},fn.unmountComponentAtNode=function(o){if(!Lu(o))throw Error(t(40));return o._reactRootContainer?(Eo(function(){bu(null,null,o,!1,function(){o._reactRootContainer=null,o[Fr]=null})}),!0):!1},fn.unstable_batchedUpdates=df,fn.unstable_renderSubtreeIntoContainer=function(o,s,d,g){if(!Lu(d))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return bu(o,s,d,!1,g)},fn.version="18.3.1-next-f1338f8080-20240426",fn}var Vg;function $C(){if(Vg)return wf.exports;Vg=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),wf.exports=HC(),wf.exports}var Lg;function zC(){if(Lg)return Fu;Lg=1;var n=$C();return Fu.createRoot=n.createRoot,Fu.hydrateRoot=n.hydrateRoot,Fu}var WC=zC();const JC=k_(WC),nl=["月","火","水","木","金","土","日"],Vi=[{name:"Sky",bg:"bg-sky-500",text:"text-white"},{name:"Emerald",bg:"bg-emerald-500",text:"text-white"},{name:"Indigo",bg:"bg-indigo-500",text:"text-white"},{name:"Pink",bg:"bg-pink-500",text:"text-white"},{name:"Rose",bg:"bg-rose-500",text:"text-white"},{name:"Amber",bg:"bg-amber-500",text:"text-white"},{name:"Teal",bg:"bg-teal-500",text:"text-white"},{name:"Purple",bg:"bg-purple-500",text:"text-white"},{name:"Purple-Indigo",bg:"bg-gradient-to-br from-purple-500 to-indigo-600",text:"text-white"},{name:"Green-Blue",bg:"bg-gradient-to-br from-green-400 to-blue-500",text:"text-white"},{name:"Pink-Rose",bg:"bg-gradient-to-br from-pink-500 to-rose-500",text:"text-white"},{name:"Yellow-Orange",bg:"bg-gradient-to-br from-yellow-400 to-orange-500",text:"text-white"},{name:"Teal-Cyan",bg:"bg-gradient-to-br from-teal-400 to-cyan-600",text:"text-white"},{name:"Red-Pink",bg:"bg-gradient-to-br from-red-500 to-pink-600",text:"text-white"},{name:"Sky-Blue",bg:"bg-gradient-to-br from-sky-400 to-blue-600",text:"text-white"},{name:"Lime-Green",bg:"bg-gradient-to-br from-lime-400 to-green-600",text:"text-white"},{name:"Slate",bg:"bg-slate-200 dark:bg-slate-700",text:"text-slate-800 dark:text-slate-100"},{name:"Gray",bg:"bg-gray-200 dark:bg-gray-700",text:"text-gray-800 dark:text-gray-100"},{name:"Zinc",bg:"bg-zinc-200 dark:bg-zinc-700",text:"text-zinc-800 dark:text-zinc-100"},{name:"Stone",bg:"bg-stone-200 dark:bg-stone-700",text:"text-stone-800 dark:text-stone-100"}],KC=["gemini-2.5-flash","gemini-2.5-flash-lite"],YC="gemini-2.5-flash",QC=()=>{};var bg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},XC=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],c=n[t++],f=n[t++],m=((i&7)<<18|(a&63)<<12|(c&63)<<6|f&63)-65536;e[r++]=String.fromCharCode(55296+(m>>10)),e[r++]=String.fromCharCode(56320+(m&1023))}else{const a=n[t++],c=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|c&63)}}return e.join("")},N_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],c=i+1<n.length,f=c?n[i+1]:0,m=i+2<n.length,p=m?n[i+2]:0,y=a>>2,T=(a&3)<<4|f>>4;let C=(f&15)<<2|p>>6,A=p&63;m||(A=64,c||(C=64)),r.push(t[y],t[T],t[C],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(P_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):XC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],f=i<n.length?t[n.charAt(i)]:0;++i;const p=i<n.length?t[n.charAt(i)]:64;++i;const T=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||f==null||p==null||T==null)throw new ZC;const C=a<<2|f>>4;if(r.push(C),p!==64){const A=f<<4&240|p>>2;if(r.push(A),T!==64){const L=p<<6&192|T;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class ZC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jC=function(n){const e=P_(n);return N_.encodeByteArray(e,!0)},sc=function(n){return jC(n).replace(/\./g,"")},M_=function(n){try{return N_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=()=>ew().__FIREBASE_DEFAULTS__,nw=()=>{if(typeof process>"u"||typeof bg>"u")return;const n=bg.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},rw=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&M_(n[1]);return e&&JSON.parse(e)},Rc=()=>{try{return QC()||tw()||nw()||rw()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},D_=n=>Rc()?.emulatorHosts?.[n],iw=n=>{const e=D_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},V_=()=>Rc()?.config,L_=n=>Rc()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Js(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function b_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[sc(JSON.stringify(t)),sc(JSON.stringify(c)),""].join(".")}const Ka={};function aw(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ka))Ka[e]?n.emulator.push(e):n.prod.push(e);return n}function lw(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Ug=!1;function U_(n,e){if(typeof window>"u"||typeof document>"u"||!Js(window.location.host)||Ka[n]===e||Ka[n]||Ug)return;Ka[n]=e;function t(C){return`__firebase__banner__${C}`}const r="__firebase__banner",a=aw().prod.length>0;function c(){const C=document.getElementById(r);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function m(C,A){C.setAttribute("width","24"),C.setAttribute("id",A),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function p(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{Ug=!0,c()},C}function y(C,A){C.setAttribute("id",A),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function T(){const C=lw(r),A=t("text"),L=document.getElementById(A)||document.createElement("span"),U=t("learnmore"),O=document.getElementById(U)||document.createElement("a"),K=t("preprendIcon"),W=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const Y=C.element;f(Y),y(O,U);const re=p();m(W,K),Y.append(W,L,O,re),document.body.appendChild(Y)}a?(L.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,L.innerText="Preview backend running in this workspace."),L.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function uw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jt())}function cw(){const n=Rc()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dw(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function fw(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function hw(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pw(){const n=jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function mw(){return!cw()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gw(){try{return typeof indexedDB=="object"}catch{return!1}}function yw(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw="FirebaseError";class ir extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=vw,Object.setPrototypeOf(this,ir.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hl.prototype.create)}}class hl{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],c=a?_w(a,r):"Error",f=`${this.serviceName}: ${c} (${i}).`;return new ir(i,f,r)}}function _w(n,e){return n.replace(Tw,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Tw=/\{\$([^}]+)}/g;function Ew(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Po(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],c=e[i];if(Fg(a)&&Fg(c)){if(!Po(a,c))return!1}else if(a!==c)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Fg(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Cw(n,e){const t=new ww(n,e);return t.subscribe.bind(t)}class ww{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Sw(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Af),i.error===void 0&&(i.error=Af),i.complete===void 0&&(i.complete=Af);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Sw(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Af(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(n){return n&&n._delegate?n._delegate:n}class No{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ow;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xw(e))try{this.getOrInitializeService({instanceIdentifier:Io})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Io){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Io){return this.instances.has(e)}getOptions(e=Io){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,c]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(a);r===f&&c.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Aw(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Io){return this.component?this.component.multipleInstances?e:Io:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Aw(n){return n===Io?void 0:n}function xw(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Iw(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Fe||(Fe={}));const Rw={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},Pw=Fe.INFO,Nw={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},Mw=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Nw[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wh{constructor(e){this.name=e,this._logLevel=Pw,this._logHandler=Mw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Rw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const Dw=(n,e)=>e.some(t=>n instanceof t);let Og,Bg;function Vw(){return Og||(Og=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Lw(){return Bg||(Bg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const F_=new WeakMap,Of=new WeakMap,O_=new WeakMap,xf=new WeakMap,Sh=new WeakMap;function bw(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",c)},a=()=>{t(Li(n.result)),i()},c=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&F_.set(t,n)}).catch(()=>{}),Sh.set(e,n),e}function Uw(n){if(Of.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",c),n.removeEventListener("abort",c)},a=()=>{t(),i()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",c),n.addEventListener("abort",c)});Of.set(n,e)}let Bf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Of.get(n);if(e==="objectStoreNames")return n.objectStoreNames||O_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Li(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Fw(n){Bf=n(Bf)}function Ow(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(kf(this),e,...t);return O_.set(r,e.sort?e.sort():[e]),Li(r)}:Lw().includes(n)?function(...e){return n.apply(kf(this),e),Li(F_.get(this))}:function(...e){return Li(n.apply(kf(this),e))}}function Bw(n){return typeof n=="function"?Ow(n):(n instanceof IDBTransaction&&Uw(n),Dw(n,Vw())?new Proxy(n,Bf):n)}function Li(n){if(n instanceof IDBRequest)return bw(n);if(xf.has(n))return xf.get(n);const e=Bw(n);return e!==n&&(xf.set(n,e),Sh.set(e,n)),e}const kf=n=>Sh.get(n);function qw(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const c=indexedDB.open(n,e),f=Li(c);return r&&c.addEventListener("upgradeneeded",m=>{r(Li(c.result),m.oldVersion,m.newVersion,Li(c.transaction),m)}),t&&c.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{a&&m.addEventListener("close",()=>a()),i&&m.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),f}const Gw=["get","getKey","getAll","getAllKeys","count"],Hw=["put","add","delete","clear"],Rf=new Map;function qg(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Rf.get(e))return Rf.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Hw.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Gw.includes(t)))return;const a=async function(c,...f){const m=this.transaction(c,i?"readwrite":"readonly");let p=m.store;return r&&(p=p.index(f.shift())),(await Promise.all([p[t](...f),i&&m.done]))[0]};return Rf.set(e,a),a}Fw(n=>({...n,get:(e,t,r)=>qg(e,t)||n.get(e,t,r),has:(e,t)=>!!qg(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(zw(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function zw(n){return n.getComponent()?.type==="VERSION"}const qf="@firebase/app",Gg="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=new wh("@firebase/app"),Ww="@firebase/app-compat",Jw="@firebase/analytics-compat",Kw="@firebase/analytics",Yw="@firebase/app-check-compat",Qw="@firebase/app-check",Xw="@firebase/auth",Zw="@firebase/auth-compat",jw="@firebase/database",eS="@firebase/data-connect",tS="@firebase/database-compat",nS="@firebase/functions",rS="@firebase/functions-compat",iS="@firebase/installations",oS="@firebase/installations-compat",sS="@firebase/messaging",aS="@firebase/messaging-compat",lS="@firebase/performance",uS="@firebase/performance-compat",cS="@firebase/remote-config",dS="@firebase/remote-config-compat",fS="@firebase/storage",hS="@firebase/storage-compat",pS="@firebase/firestore",mS="@firebase/ai",gS="@firebase/firestore-compat",yS="firebase",vS="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf="[DEFAULT]",_S={[qf]:"fire-core",[Ww]:"fire-core-compat",[Kw]:"fire-analytics",[Jw]:"fire-analytics-compat",[Qw]:"fire-app-check",[Yw]:"fire-app-check-compat",[Xw]:"fire-auth",[Zw]:"fire-auth-compat",[jw]:"fire-rtdb",[eS]:"fire-data-connect",[tS]:"fire-rtdb-compat",[nS]:"fire-fn",[rS]:"fire-fn-compat",[iS]:"fire-iid",[oS]:"fire-iid-compat",[sS]:"fire-fcm",[aS]:"fire-fcm-compat",[lS]:"fire-perf",[uS]:"fire-perf-compat",[cS]:"fire-rc",[dS]:"fire-rc-compat",[fS]:"fire-gcs",[hS]:"fire-gcs-compat",[pS]:"fire-fst",[gS]:"fire-fst-compat",[mS]:"fire-vertex","fire-js":"fire-js",[yS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac=new Map,TS=new Map,Hf=new Map;function Hg(n,e){try{n.container.addComponent(e)}catch(t){Qr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Os(n){const e=n.name;if(Hf.has(e))return Qr.debug(`There were multiple attempts to register component ${e}.`),!1;Hf.set(e,n);for(const t of ac.values())Hg(t,n);for(const t of TS.values())Hg(t,n);return!0}function Ih(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function er(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bi=new hl("app","Firebase",ES);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new No("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks=vS;function B_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Gf,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw bi.create("bad-app-name",{appName:String(i)});if(t||(t=V_()),!t)throw bi.create("no-options");const a=ac.get(i);if(a){if(Po(t,a.options)&&Po(r,a.config))return a;throw bi.create("duplicate-app",{appName:i})}const c=new kw(i);for(const m of Hf.values())c.addComponent(m);const f=new CS(t,r,c);return ac.set(i,f),f}function q_(n=Gf){const e=ac.get(n);if(!e&&n===Gf&&V_())return B_();if(!e)throw bi.create("no-app",{appName:n});return e}function Ui(n,e,t){let r=_S[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const c=[`Unable to register library "${r}" with version "${e}":`];i&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qr.warn(c.join(" "));return}Os(new No(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="firebase-heartbeat-database",SS=1,rl="firebase-heartbeat-store";let Pf=null;function G_(){return Pf||(Pf=qw(wS,SS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(rl)}catch(t){console.warn(t)}}}}).catch(n=>{throw bi.create("idb-open",{originalErrorMessage:n.message})})),Pf}async function IS(n){try{const t=(await G_()).transaction(rl),r=await t.objectStore(rl).get(H_(n));return await t.done,r}catch(e){if(e instanceof ir)Qr.warn(e.message);else{const t=bi.create("idb-get",{originalErrorMessage:e?.message});Qr.warn(t.message)}}}async function $g(n,e){try{const r=(await G_()).transaction(rl,"readwrite");await r.objectStore(rl).put(e,H_(n)),await r.done}catch(t){if(t instanceof ir)Qr.warn(t.message);else{const r=bi.create("idb-set",{originalErrorMessage:t?.message});Qr.warn(r.message)}}}function H_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=1024,xS=30;class kS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new PS(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=zg();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>xS){const i=NS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Qr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=zg(),{heartbeatsToSend:t,unsentEntries:r}=RS(this._heartbeatsCache.heartbeats),i=sc(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Qr.warn(e),""}}}function zg(){return new Date().toISOString().substring(0,10)}function RS(n,e=AS){const t=[];let r=n.slice();for(const i of n){const a=t.find(c=>c.agent===i.agent);if(a){if(a.dates.push(i.date),Wg(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Wg(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class PS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gw()?yw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await IS(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return $g(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return $g(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Wg(n){return sc(JSON.stringify({version:2,heartbeats:n})).length}function NS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(n){Os(new No("platform-logger",e=>new $w(e),"PRIVATE")),Os(new No("heartbeat",e=>new kS(e),"PRIVATE")),Ui(qf,Gg,n),Ui(qf,Gg,"esm2020"),Ui("fire-js","")}MS("");var DS="firebase",VS="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ui(DS,VS,"app");function $_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const LS=$_,z_=new hl("auth","Firebase",$_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=new wh("@firebase/auth");function bS(n,...e){lc.logLevel<=Fe.WARN&&lc.warn(`Auth (${Ks}): ${n}`,...e)}function Ju(n,...e){lc.logLevel<=Fe.ERROR&&lc.error(`Auth (${Ks}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(n,...e){throw xh(n,...e)}function rr(n,...e){return xh(n,...e)}function Ah(n,e,t){const r={...LS(),[e]:t};return new hl("auth","Firebase",r).create(e,{appName:n.name})}function ko(n){return Ah(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function US(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ir(n,"argument-error"),Ah(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function xh(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return z_.create(n,...e)}function Ae(n,e,...t){if(!n)throw xh(e,...t)}function Jr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ju(e),new Error(e)}function Xr(n,e){n||Jr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $f(){return typeof self<"u"&&self.location?.href||""}function FS(){return Jg()==="http:"||Jg()==="https:"}function Jg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FS()||fw()||"connection"in navigator)?navigator.onLine:!0}function BS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xr(t>e,"Short delay should be less than long delay!"),this.isMobile=uw()||hw()}get(){return OS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(n,e){Xr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Jr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Jr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Jr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],HS=new ml(3e4,6e4);function Rh(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ys(n,e,t,r,i={}){return J_(n,i,async()=>{let a={},c={};r&&(e==="GET"?c=r:a={body:JSON.stringify(r)});const f=pl({key:n.config.apiKey,...c}).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:m,...a};return dw()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Js(n.emulatorConfig.host)&&(p.credentials="include"),W_.fetch()(await K_(n,n.config.apiHost,t,f),p)})}async function J_(n,e,t){n._canInitEmulator=!1;const r={...qS,...e};try{const i=new zS(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const c=await a.json();if("needConfirmation"in c)throw Ou(n,"account-exists-with-different-credential",c);if(a.ok&&!("errorMessage"in c))return c;{const f=a.ok?c.errorMessage:c.error.message,[m,p]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ou(n,"credential-already-in-use",c);if(m==="EMAIL_EXISTS")throw Ou(n,"email-already-in-use",c);if(m==="USER_DISABLED")throw Ou(n,"user-disabled",c);const y=r[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Ah(n,y,p);Ir(n,y)}}catch(i){if(i instanceof ir)throw i;Ir(n,"network-request-failed",{message:String(i)})}}async function $S(n,e,t,r,i={}){const a=await Ys(n,e,t,r,i);return"mfaPendingCredential"in a&&Ir(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function K_(n,e,t,r){const i=`${e}${t}?${r}`,a=n,c=a.config.emulator?kh(n.config,i):`${n.config.apiScheme}://${i}`;return GS.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(c).toString():c}class zS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(rr(this.auth,"network-request-failed")),HS.get())})}}function Ou(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=rr(n,e,r);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WS(n,e){return Ys(n,"POST","/v1/accounts:delete",e)}async function uc(n,e){return Ys(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ya(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JS(n,e=!1){const t=Ln(n),r=await t.getIdToken(e),i=Ph(r);Ae(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,c=a?.sign_in_provider;return{claims:i,token:r,authTime:Ya(Nf(i.auth_time)),issuedAtTime:Ya(Nf(i.iat)),expirationTime:Ya(Nf(i.exp)),signInProvider:c||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Nf(n){return Number(n)*1e3}function Ph(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ju("JWT malformed, contained fewer than 3 sections"),null;try{const i=M_(t);return i?JSON.parse(i):(Ju("Failed to decode base64 JWT payload"),null)}catch(i){return Ju("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Kg(n){const e=Ph(n);return Ae(e,"internal-error"),Ae(typeof e.exp<"u","internal-error"),Ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function il(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof ir&&KS(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function KS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ya(this.lastLoginAt),this.creationTime=Ya(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cc(n){const e=n.auth,t=await n.getIdToken(),r=await il(n,uc(e,{idToken:t}));Ae(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?Y_(i.providerUserInfo):[],c=XS(n.providerData,a),f=n.isAnonymous,m=!(n.email&&i.passwordHash)&&!c?.length,p=f?m:!1,y={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new zf(i.createdAt,i.lastLoginAt),isAnonymous:p};Object.assign(n,y)}async function QS(n){const e=Ln(n);await cc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function XS(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Y_(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZS(n,e){const t=await J_(n,{},async()=>{const r=pl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,c=await K_(n,i,"/v1/token",`key=${a}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:r};return n.emulatorConfig&&Js(n.emulatorConfig.host)&&(m.credentials="include"),W_.fetch()(c,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function jS(n,e){return Ys(n,"POST","/v2/accounts:revokeToken",Rh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ae(e.idToken,"internal-error"),Ae(typeof e.idToken<"u","internal-error"),Ae(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Kg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ae(e.length!==0,"internal-error");const t=Kg(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await ZS(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,c=new Ms;return r&&(Ae(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),i&&(Ae(typeof i=="string","internal-error",{appName:e}),c.accessToken=i),a&&(Ae(typeof a=="number","internal-error",{appName:e}),c.expirationTime=a),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ms,this.toJSON())}_performRefresh(){return Jr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(n,e){Ae(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class tr{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new YS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new zf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await il(this,this.stsTokenManager.getToken(this.auth,e));return Ae(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return JS(this,e)}reload(){return QS(this)}_assign(e){this!==e&&(Ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new tr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await cc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(er(this.auth.app))return Promise.reject(ko(this.auth));const e=await this.getIdToken();return await il(this,WS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,c=t.photoURL??void 0,f=t.tenantId??void 0,m=t._redirectEventId??void 0,p=t.createdAt??void 0,y=t.lastLoginAt??void 0,{uid:T,emailVerified:C,isAnonymous:A,providerData:L,stsTokenManager:U}=t;Ae(T&&U,e,"internal-error");const O=Ms.fromJSON(this.name,U);Ae(typeof T=="string",e,"internal-error"),ki(r,e.name),ki(i,e.name),Ae(typeof C=="boolean",e,"internal-error"),Ae(typeof A=="boolean",e,"internal-error"),ki(a,e.name),ki(c,e.name),ki(f,e.name),ki(m,e.name),ki(p,e.name),ki(y,e.name);const K=new tr({uid:T,auth:e,email:i,emailVerified:C,displayName:r,isAnonymous:A,photoURL:c,phoneNumber:a,tenantId:f,stsTokenManager:O,createdAt:p,lastLoginAt:y});return L&&Array.isArray(L)&&(K.providerData=L.map(W=>({...W}))),m&&(K._redirectEventId=m),K}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ms;i.updateFromServerResponse(t);const a=new tr({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await cc(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Ae(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?Y_(i.providerUserInfo):[],c=!(i.email&&i.passwordHash)&&!a?.length,f=new Ms;f.updateFromIdToken(r);const m=new tr({uid:i.localId,auth:e,stsTokenManager:f,isAnonymous:c}),p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new zf(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(m,p),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg=new Map;function Kr(n){Xr(n instanceof Function,"Expected a class definition");let e=Yg.get(n);return e?(Xr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Yg.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Q_.type="NONE";const Qg=Q_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(n,e,t){return`firebase:${n}:${e}:${t}`}class Ds{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=Ku(this.userKey,i.apiKey,a),this.fullPersistenceKey=Ku("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await uc(this.auth,{idToken:e}).catch(()=>{});return t?tr._fromGetAccountInfoResponse(this.auth,t,e):null}return tr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ds(Kr(Qg),e,r);const i=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=i[0]||Kr(Qg);const c=Ku(r,e.config.apiKey,e.name);let f=null;for(const p of t)try{const y=await p._get(c);if(y){let T;if(typeof y=="string"){const C=await uc(e,{idToken:y}).catch(()=>{});if(!C)break;T=await tr._fromGetAccountInfoResponse(e,C,y)}else T=tr._fromJSON(e,y);p!==a&&(f=T),a=p;break}}catch{}const m=i.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!m.length?new Ds(a,e,r):(a=m[0],f&&await a._set(c,f.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(c)}catch{}})),new Ds(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(eT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(X_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nT(e))return"Blackberry";if(rT(e))return"Webos";if(Z_(e))return"Safari";if((e.includes("chrome/")||j_(e))&&!e.includes("edge/"))return"Chrome";if(tT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function X_(n=jt()){return/firefox\//i.test(n)}function Z_(n=jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function j_(n=jt()){return/crios\//i.test(n)}function eT(n=jt()){return/iemobile/i.test(n)}function tT(n=jt()){return/android/i.test(n)}function nT(n=jt()){return/blackberry/i.test(n)}function rT(n=jt()){return/webos/i.test(n)}function Nh(n=jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function eI(n=jt()){return Nh(n)&&!!window.navigator?.standalone}function tI(){return pw()&&document.documentMode===10}function iT(n=jt()){return Nh(n)||tT(n)||rT(n)||nT(n)||/windows phone/i.test(n)||eT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oT(n,e=[]){let t;switch(n){case"Browser":t=Xg(jt());break;case"Worker":t=`${Xg(jt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ks}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((c,f)=>{try{const m=e(a);c(m)}catch(m){f(m)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rI(n,e={}){return Ys(n,"GET","/v2/passwordPolicy",Rh(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI=6;class oI{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??iI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zg(this),this.idTokenSubscription=new Zg(this),this.beforeStateQueue=new nI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=z_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Kr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ds.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await uc(this,{idToken:e}),r=await tr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(er(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,c=r?._redirectEventId,f=await this.tryRedirectSignIn(e);(!a||a===c)&&f?.user&&(r=f.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await cc(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=BS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(er(this.app))return Promise.reject(ko(this));const t=e?Ln(e):null;return t&&Ae(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return er(this.app)?Promise.reject(ko(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return er(this.app)?Promise.reject(ko(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Kr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await rI(this),t=new oI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hl("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await jS(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Kr(e)||this._popupRedirectResolver;Ae(t,this,"argument-error"),this.redirectPersistenceManager=await Ds.create(this,[Kr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let c=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ae(f,this,"internal-error"),f.then(()=>{c||a(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,r,i);return()=>{c=!0,m()}}else{const m=e.addObserver(t);return()=>{c=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=oT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&bS(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Pc(n){return Ln(n)}class Zg{constructor(e){this.auth=e,this.observer=null,this.addObserver=Cw(t=>this.observer=t)}get next(){return Ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aI(n){Mh=n}function lI(n){return Mh.loadJS(n)}function uI(){return Mh.gapiScript}function cI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dI(n,e){const t=Ih(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(Po(a,e??{}))return i;Ir(i,"already-initialized")}return t.initialize({options:e})}function fI(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Kr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function hI(n,e,t){const r=Pc(n);Ae(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=sT(e),{host:c,port:f}=pI(e),m=f===null?"":`:${f}`,p={url:`${a}//${c}${m}/`},y=Object.freeze({host:c,port:f,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ae(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ae(Po(p,r.config.emulator)&&Po(y,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=y,r.settings.appVerificationDisabledForTesting=!0,Js(c)?(b_(`${a}//${c}${m}`),U_("Auth",!0)):mI()}function sT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function pI(n){const e=sT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:jg(r.substr(a.length+1))}}else{const[a,c]=r.split(":");return{host:a,port:jg(c)}}}function jg(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function mI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Jr("not implemented")}_getIdTokenResponse(e){return Jr("not implemented")}_linkToIdToken(e,t){return Jr("not implemented")}_getReauthenticationResolver(e){return Jr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vs(n,e){return $S(n,"POST","/v1/accounts:signInWithIdp",Rh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI="http://localhost";class Mo extends aT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Mo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ir("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const c=new Mo(r,i);return c.idToken=a.idToken||void 0,c.accessToken=a.accessToken||void 0,c.secret=a.secret,c.nonce=a.nonce,c.pendingToken=a.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Vs(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Vs(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vs(e,t)}buildRequest(){const e={requestUri:gI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl extends Dh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri extends gl{constructor(){super("facebook.com")}static credential(e){return Mo._fromParams({providerId:Ri.PROVIDER_ID,signInMethod:Ri.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ri.credentialFromTaggedObject(e)}static credentialFromError(e){return Ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ri.credential(e.oauthAccessToken)}catch{return null}}}Ri.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ri.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends gl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Mo._fromParams({providerId:Wr.PROVIDER_ID,signInMethod:Wr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Wr.credentialFromTaggedObject(e)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Wr.credential(t,r)}catch{return null}}}Wr.GOOGLE_SIGN_IN_METHOD="google.com";Wr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi extends gl{constructor(){super("github.com")}static credential(e){return Mo._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pi.credential(e.oauthAccessToken)}catch{return null}}}Pi.GITHUB_SIGN_IN_METHOD="github.com";Pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends gl{constructor(){super("twitter.com")}static credential(e,t){return Mo._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ni.credential(t,r)}catch{return null}}}Ni.TWITTER_SIGN_IN_METHOD="twitter.com";Ni.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await tr._fromIdTokenResponse(e,r,i),c=ey(r);return new Bs({user:a,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=ey(r);return new Bs({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function ey(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc extends ir{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,dc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new dc(e,t,r,i)}}function lT(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?dc._fromErrorAndOperation(n,a,e,r):a})}async function yI(n,e,t=!1){const r=await il(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Bs._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vI(n,e,t=!1){const{auth:r}=n;if(er(r.app))return Promise.reject(ko(r));const i="reauthenticate";try{const a=await il(n,lT(r,i,e,n),t);Ae(a.idToken,r,"internal-error");const c=Ph(a.idToken);Ae(c,r,"internal-error");const{sub:f}=c;return Ae(n.uid===f,r,"user-mismatch"),Bs._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&Ir(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _I(n,e,t=!1){if(er(n.app))return Promise.reject(ko(n));const r="signIn",i=await lT(n,r,e),a=await Bs._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}function TI(n,e,t,r){return Ln(n).onIdTokenChanged(e,t,r)}function EI(n,e,t){return Ln(n).beforeAuthStateChanged(e,t)}function CI(n,e,t,r){return Ln(n).onAuthStateChanged(e,t,r)}function wI(n){return Ln(n).signOut()}const fc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(fc,"1"),this.storage.removeItem(fc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI=1e3,II=10;class cT extends uT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=iT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,f,m)=>{this.notifyListeners(c,m)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},a=this.storage.getItem(r);tI()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,II):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},SI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}cT.type="LOCAL";const AI=cT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT extends uT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}dT.type="SESSION";const fT=dT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Nc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,c=this.handlersMap[i];if(!c?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const f=Array.from(c).map(async p=>p(t.origin,a)),m=await xI(f);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,c;return new Promise((f,m)=>{const p=Vh("",20);i.port1.start();const y=setTimeout(()=>{m(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(T){const C=T;if(C.data.eventId===p)switch(C.data.status){case"ack":clearTimeout(y),a=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),f(C.data.response);break;default:clearTimeout(y),clearTimeout(a),m(new Error("invalid_response"));break}}},this.handlers.add(c),i.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[i.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(){return window}function RI(n){Tr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(){return typeof Tr().WorkerGlobalScope<"u"&&typeof Tr().importScripts=="function"}async function PI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function NI(){return navigator?.serviceWorker?.controller||null}function MI(){return hT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT="firebaseLocalStorageDb",DI=1,hc="firebaseLocalStorage",mT="fbase_key";class yl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Mc(n,e){return n.transaction([hc],e?"readwrite":"readonly").objectStore(hc)}function VI(){const n=indexedDB.deleteDatabase(pT);return new yl(n).toPromise()}function Wf(){const n=indexedDB.open(pT,DI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(hc,{keyPath:mT})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(hc)?e(r):(r.close(),await VI(),e(await Wf()))})})}async function ty(n,e,t){const r=Mc(n,!0).put({[mT]:e,value:t});return new yl(r).toPromise()}async function LI(n,e){const t=Mc(n,!1).get(e),r=await new yl(t).toPromise();return r===void 0?null:r.value}function ny(n,e){const t=Mc(n,!0).delete(e);return new yl(t).toPromise()}const bI=800,UI=3;class gT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>UI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nc._getInstance(MI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await PI(),!this.activeServiceWorker)return;this.sender=new kI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||NI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wf();return await ty(e,fc,"1"),await ny(e,fc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>ty(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>LI(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ny(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Mc(i,!1).getAll();return new yl(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gT.type="LOCAL";const FI=gT;new ml(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yT(n,e){return e?Kr(e):(Ae(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh extends aT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function OI(n){return _I(n.auth,new Lh(n),n.bypassAuthState)}function BI(n){const{auth:e,user:t}=n;return Ae(t,e,"internal-error"),vI(t,new Lh(n),n.bypassAuthState)}async function qI(n){const{auth:e,user:t}=n;return Ae(t,e,"internal-error"),yI(t,new Lh(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:c,type:f}=e;if(c){this.reject(c);return}const m={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OI;case"linkViaPopup":case"linkViaRedirect":return qI;case"reauthViaPopup":case"reauthViaRedirect":return BI;default:Ir(this.auth,"internal-error")}}resolve(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI=new ml(2e3,1e4);async function HI(n,e,t){if(er(n.app))return Promise.reject(rr(n,"operation-not-supported-in-this-environment"));const r=Pc(n);US(n,e,Dh);const i=yT(r,t);return new Ao(r,"signInViaPopup",e,i).executeNotNull()}class Ao extends vT{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Ao.currentPopupAction&&Ao.currentPopupAction.cancel(),Ao.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ae(e,this.auth,"internal-error"),e}async onExecution(){Xr(this.filter.length===1,"Popup operations only handle one event");const e=Vh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(rr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(rr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ao.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(rr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,GI.get())};e()}}Ao.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I="pendingRedirect",Yu=new Map;class zI extends vT{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Yu.get(this.auth._key());if(!e){try{const r=await WI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Yu.set(this.auth._key(),e)}return this.bypassAuthState||Yu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function WI(n,e){const t=YI(e),r=KI(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function JI(n,e){Yu.set(n._key(),e)}function KI(n){return Kr(n._redirectPersistence)}function YI(n){return Ku($I,n.config.apiKey,n.name)}async function QI(n,e,t=!1){if(er(n.app))return Promise.reject(ko(n));const r=Pc(n),i=yT(r,e),c=await new zI(r,i,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI=600*1e3;class ZI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!jI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!_T(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(rr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=XI&&this.cachedEventUids.clear(),this.cachedEventUids.has(ry(e))}saveEventToCache(e){this.cachedEventUids.add(ry(e)),this.lastProcessedEventTime=Date.now()}}function ry(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function _T({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function jI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _T(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eA(n,e={}){return Ys(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nA=/^https?/;async function rA(n){if(n.config.emulator)return;const{authorizedDomains:e}=await eA(n);for(const t of e)try{if(iA(t))return}catch{}Ir(n,"unauthorized-domain")}function iA(n){const e=$f(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!nA.test(t))return!1;if(tA.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=new ml(3e4,6e4);function iy(){const n=Tr().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function sA(n){return new Promise((e,t)=>{function r(){iy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iy(),t(rr(n,"network-request-failed"))},timeout:oA.get()})}if(Tr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Tr().gapi?.load)r();else{const i=cI("iframefcb");return Tr()[i]=()=>{gapi.load?r():t(rr(n,"network-request-failed"))},lI(`${uI()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw Qu=null,e})}let Qu=null;function aA(n){return Qu=Qu||sA(n),Qu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA=new ml(5e3,15e3),uA="__/auth/iframe",cA="emulator/auth/iframe",dA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hA(n){const e=n.config;Ae(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?kh(e,cA):`https://${n.config.authDomain}/${uA}`,r={apiKey:e.apiKey,appName:n.name,v:Ks},i=fA.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${pl(r).slice(1)}`}async function pA(n){const e=await aA(n),t=Tr().gapi;return Ae(t,n,"internal-error"),e.open({where:document.body,url:hA(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dA,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const c=rr(n,"network-request-failed"),f=Tr().setTimeout(()=>{a(c)},lA.get());function m(){Tr().clearTimeout(f),i(r)}r.ping(m).then(m,()=>{a(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},gA=500,yA=600,vA="_blank",_A="http://localhost";class oy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function TA(n,e,t,r=gA,i=yA){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let f="";const m={...mA,width:r.toString(),height:i.toString(),top:a,left:c},p=jt().toLowerCase();t&&(f=j_(p)?vA:t),X_(p)&&(e=e||_A,m.scrollbars="yes");const y=Object.entries(m).reduce((C,[A,L])=>`${C}${A}=${L},`,"");if(eI(p)&&f!=="_self")return EA(e||"",f),new oy(null);const T=window.open(e||"",f,y);Ae(T,n,"popup-blocked");try{T.focus()}catch{}return new oy(T)}function EA(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA="__/auth/handler",wA="emulator/auth/handler",SA=encodeURIComponent("fac");async function sy(n,e,t,r,i,a){Ae(n.config.authDomain,n,"auth-domain-config-required"),Ae(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ks,eventId:i};if(e instanceof Dh){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",Ew(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,T]of Object.entries({}))c[y]=T}if(e instanceof gl){const y=e.getScopes().filter(T=>T!=="");y.length>0&&(c.scopes=y.join(","))}n.tenantId&&(c.tid=n.tenantId);const f=c;for(const y of Object.keys(f))f[y]===void 0&&delete f[y];const m=await n._getAppCheckToken(),p=m?`#${SA}=${encodeURIComponent(m)}`:"";return`${IA(n)}?${pl(f).slice(1)}${p}`}function IA({config:n}){return n.emulator?kh(n,wA):`https://${n.authDomain}/${CA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf="webStorageSupport";class AA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fT,this._completeRedirectFn=QI,this._overrideRedirectResult=JI}async _openPopup(e,t,r,i){Xr(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await sy(e,t,r,$f(),i);return TA(e,a,Vh())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await sy(e,t,r,$f(),i);return RI(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Xr(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await pA(e),r=new ZI(e);return t.register("authEvent",i=>(Ae(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mf,{type:Mf},i=>{const a=i?.[0]?.[Mf];a!==void 0&&t(!!a),Ir(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rA(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return iT()||Z_()||Nh()}}const xA=AA;var ay="@firebase/auth",ly="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function PA(n){Os(new No("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:c,authDomain:f}=r.options;Ae(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const m={apiKey:c,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:oT(n)},p=new sI(r,i,a,m);return fI(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Os(new No("auth-internal",e=>{const t=Pc(e.getProvider("auth").getImmediate());return(r=>new kA(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ui(ay,ly,RA(n)),Ui(ay,ly,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=300,MA=L_("authIdTokenMaxAge")||NA;let uy=null;const DA=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>MA)return;const i=t?.token;uy!==i&&(uy=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function VA(n=q_()){const e=Ih(n,"auth");if(e.isInitialized())return e.getImmediate();const t=dI(n,{popupRedirectResolver:xA,persistence:[FI,AI,fT]}),r=L_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const c=DA(a.toString());EI(t,c,()=>c(t.currentUser)),TI(t,f=>c(f))}}const i=D_("auth");return i&&hI(t,`http://${i}`),t}function LA(){return document.getElementsByTagName("head")?.[0]??document}aI({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=rr("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",LA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});PA("Browser");var cy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fi,TT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,k){function x(){}x.prototype=k.prototype,D.D=k.prototype,D.prototype=new x,D.prototype.constructor=D,D.C=function(P,N,b){for(var M=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)M[Pe-2]=arguments[Pe];return k.prototype[N].apply(P,M)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,k,x){x||(x=0);var P=Array(16);if(typeof k=="string")for(var N=0;16>N;++N)P[N]=k.charCodeAt(x++)|k.charCodeAt(x++)<<8|k.charCodeAt(x++)<<16|k.charCodeAt(x++)<<24;else for(N=0;16>N;++N)P[N]=k[x++]|k[x++]<<8|k[x++]<<16|k[x++]<<24;k=D.g[0],x=D.g[1],N=D.g[2];var b=D.g[3],M=k+(b^x&(N^b))+P[0]+3614090360&4294967295;k=x+(M<<7&4294967295|M>>>25),M=b+(N^k&(x^N))+P[1]+3905402710&4294967295,b=k+(M<<12&4294967295|M>>>20),M=N+(x^b&(k^x))+P[2]+606105819&4294967295,N=b+(M<<17&4294967295|M>>>15),M=x+(k^N&(b^k))+P[3]+3250441966&4294967295,x=N+(M<<22&4294967295|M>>>10),M=k+(b^x&(N^b))+P[4]+4118548399&4294967295,k=x+(M<<7&4294967295|M>>>25),M=b+(N^k&(x^N))+P[5]+1200080426&4294967295,b=k+(M<<12&4294967295|M>>>20),M=N+(x^b&(k^x))+P[6]+2821735955&4294967295,N=b+(M<<17&4294967295|M>>>15),M=x+(k^N&(b^k))+P[7]+4249261313&4294967295,x=N+(M<<22&4294967295|M>>>10),M=k+(b^x&(N^b))+P[8]+1770035416&4294967295,k=x+(M<<7&4294967295|M>>>25),M=b+(N^k&(x^N))+P[9]+2336552879&4294967295,b=k+(M<<12&4294967295|M>>>20),M=N+(x^b&(k^x))+P[10]+4294925233&4294967295,N=b+(M<<17&4294967295|M>>>15),M=x+(k^N&(b^k))+P[11]+2304563134&4294967295,x=N+(M<<22&4294967295|M>>>10),M=k+(b^x&(N^b))+P[12]+1804603682&4294967295,k=x+(M<<7&4294967295|M>>>25),M=b+(N^k&(x^N))+P[13]+4254626195&4294967295,b=k+(M<<12&4294967295|M>>>20),M=N+(x^b&(k^x))+P[14]+2792965006&4294967295,N=b+(M<<17&4294967295|M>>>15),M=x+(k^N&(b^k))+P[15]+1236535329&4294967295,x=N+(M<<22&4294967295|M>>>10),M=k+(N^b&(x^N))+P[1]+4129170786&4294967295,k=x+(M<<5&4294967295|M>>>27),M=b+(x^N&(k^x))+P[6]+3225465664&4294967295,b=k+(M<<9&4294967295|M>>>23),M=N+(k^x&(b^k))+P[11]+643717713&4294967295,N=b+(M<<14&4294967295|M>>>18),M=x+(b^k&(N^b))+P[0]+3921069994&4294967295,x=N+(M<<20&4294967295|M>>>12),M=k+(N^b&(x^N))+P[5]+3593408605&4294967295,k=x+(M<<5&4294967295|M>>>27),M=b+(x^N&(k^x))+P[10]+38016083&4294967295,b=k+(M<<9&4294967295|M>>>23),M=N+(k^x&(b^k))+P[15]+3634488961&4294967295,N=b+(M<<14&4294967295|M>>>18),M=x+(b^k&(N^b))+P[4]+3889429448&4294967295,x=N+(M<<20&4294967295|M>>>12),M=k+(N^b&(x^N))+P[9]+568446438&4294967295,k=x+(M<<5&4294967295|M>>>27),M=b+(x^N&(k^x))+P[14]+3275163606&4294967295,b=k+(M<<9&4294967295|M>>>23),M=N+(k^x&(b^k))+P[3]+4107603335&4294967295,N=b+(M<<14&4294967295|M>>>18),M=x+(b^k&(N^b))+P[8]+1163531501&4294967295,x=N+(M<<20&4294967295|M>>>12),M=k+(N^b&(x^N))+P[13]+2850285829&4294967295,k=x+(M<<5&4294967295|M>>>27),M=b+(x^N&(k^x))+P[2]+4243563512&4294967295,b=k+(M<<9&4294967295|M>>>23),M=N+(k^x&(b^k))+P[7]+1735328473&4294967295,N=b+(M<<14&4294967295|M>>>18),M=x+(b^k&(N^b))+P[12]+2368359562&4294967295,x=N+(M<<20&4294967295|M>>>12),M=k+(x^N^b)+P[5]+4294588738&4294967295,k=x+(M<<4&4294967295|M>>>28),M=b+(k^x^N)+P[8]+2272392833&4294967295,b=k+(M<<11&4294967295|M>>>21),M=N+(b^k^x)+P[11]+1839030562&4294967295,N=b+(M<<16&4294967295|M>>>16),M=x+(N^b^k)+P[14]+4259657740&4294967295,x=N+(M<<23&4294967295|M>>>9),M=k+(x^N^b)+P[1]+2763975236&4294967295,k=x+(M<<4&4294967295|M>>>28),M=b+(k^x^N)+P[4]+1272893353&4294967295,b=k+(M<<11&4294967295|M>>>21),M=N+(b^k^x)+P[7]+4139469664&4294967295,N=b+(M<<16&4294967295|M>>>16),M=x+(N^b^k)+P[10]+3200236656&4294967295,x=N+(M<<23&4294967295|M>>>9),M=k+(x^N^b)+P[13]+681279174&4294967295,k=x+(M<<4&4294967295|M>>>28),M=b+(k^x^N)+P[0]+3936430074&4294967295,b=k+(M<<11&4294967295|M>>>21),M=N+(b^k^x)+P[3]+3572445317&4294967295,N=b+(M<<16&4294967295|M>>>16),M=x+(N^b^k)+P[6]+76029189&4294967295,x=N+(M<<23&4294967295|M>>>9),M=k+(x^N^b)+P[9]+3654602809&4294967295,k=x+(M<<4&4294967295|M>>>28),M=b+(k^x^N)+P[12]+3873151461&4294967295,b=k+(M<<11&4294967295|M>>>21),M=N+(b^k^x)+P[15]+530742520&4294967295,N=b+(M<<16&4294967295|M>>>16),M=x+(N^b^k)+P[2]+3299628645&4294967295,x=N+(M<<23&4294967295|M>>>9),M=k+(N^(x|~b))+P[0]+4096336452&4294967295,k=x+(M<<6&4294967295|M>>>26),M=b+(x^(k|~N))+P[7]+1126891415&4294967295,b=k+(M<<10&4294967295|M>>>22),M=N+(k^(b|~x))+P[14]+2878612391&4294967295,N=b+(M<<15&4294967295|M>>>17),M=x+(b^(N|~k))+P[5]+4237533241&4294967295,x=N+(M<<21&4294967295|M>>>11),M=k+(N^(x|~b))+P[12]+1700485571&4294967295,k=x+(M<<6&4294967295|M>>>26),M=b+(x^(k|~N))+P[3]+2399980690&4294967295,b=k+(M<<10&4294967295|M>>>22),M=N+(k^(b|~x))+P[10]+4293915773&4294967295,N=b+(M<<15&4294967295|M>>>17),M=x+(b^(N|~k))+P[1]+2240044497&4294967295,x=N+(M<<21&4294967295|M>>>11),M=k+(N^(x|~b))+P[8]+1873313359&4294967295,k=x+(M<<6&4294967295|M>>>26),M=b+(x^(k|~N))+P[15]+4264355552&4294967295,b=k+(M<<10&4294967295|M>>>22),M=N+(k^(b|~x))+P[6]+2734768916&4294967295,N=b+(M<<15&4294967295|M>>>17),M=x+(b^(N|~k))+P[13]+1309151649&4294967295,x=N+(M<<21&4294967295|M>>>11),M=k+(N^(x|~b))+P[4]+4149444226&4294967295,k=x+(M<<6&4294967295|M>>>26),M=b+(x^(k|~N))+P[11]+3174756917&4294967295,b=k+(M<<10&4294967295|M>>>22),M=N+(k^(b|~x))+P[2]+718787259&4294967295,N=b+(M<<15&4294967295|M>>>17),M=x+(b^(N|~k))+P[9]+3951481745&4294967295,D.g[0]=D.g[0]+k&4294967295,D.g[1]=D.g[1]+(N+(M<<21&4294967295|M>>>11))&4294967295,D.g[2]=D.g[2]+N&4294967295,D.g[3]=D.g[3]+b&4294967295}r.prototype.u=function(D,k){k===void 0&&(k=D.length);for(var x=k-this.blockSize,P=this.B,N=this.h,b=0;b<k;){if(N==0)for(;b<=x;)i(this,D,b),b+=this.blockSize;if(typeof D=="string"){for(;b<k;)if(P[N++]=D.charCodeAt(b++),N==this.blockSize){i(this,P),N=0;break}}else for(;b<k;)if(P[N++]=D[b++],N==this.blockSize){i(this,P),N=0;break}}this.h=N,this.o+=k},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var k=1;k<D.length-8;++k)D[k]=0;var x=8*this.o;for(k=D.length-8;k<D.length;++k)D[k]=x&255,x/=256;for(this.u(D),D=Array(16),k=x=0;4>k;++k)for(var P=0;32>P;P+=8)D[x++]=this.g[k]>>>P&255;return D};function a(D,k){var x=f;return Object.prototype.hasOwnProperty.call(x,D)?x[D]:x[D]=k(D)}function c(D,k){this.h=k;for(var x=[],P=!0,N=D.length-1;0<=N;N--){var b=D[N]|0;P&&b==k||(x[N]=b,P=!1)}this.g=x}var f={};function m(D){return-128<=D&&128>D?a(D,function(k){return new c([k|0],0>k?-1:0)}):new c([D|0],0>D?-1:0)}function p(D){if(isNaN(D)||!isFinite(D))return T;if(0>D)return O(p(-D));for(var k=[],x=1,P=0;D>=x;P++)k[P]=D/x|0,x*=4294967296;return new c(k,0)}function y(D,k){if(D.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(D.charAt(0)=="-")return O(y(D.substring(1),k));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=p(Math.pow(k,8)),P=T,N=0;N<D.length;N+=8){var b=Math.min(8,D.length-N),M=parseInt(D.substring(N,N+b),k);8>b?(b=p(Math.pow(k,b)),P=P.j(b).add(p(M))):(P=P.j(x),P=P.add(p(M)))}return P}var T=m(0),C=m(1),A=m(16777216);n=c.prototype,n.m=function(){if(U(this))return-O(this).m();for(var D=0,k=1,x=0;x<this.g.length;x++){var P=this.i(x);D+=(0<=P?P:4294967296+P)*k,k*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(L(this))return"0";if(U(this))return"-"+O(this).toString(D);for(var k=p(Math.pow(D,6)),x=this,P="";;){var N=re(x,k).g;x=K(x,N.j(k));var b=((0<x.g.length?x.g[0]:x.h)>>>0).toString(D);if(x=N,L(x))return b+P;for(;6>b.length;)b="0"+b;P=b+P}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function L(D){if(D.h!=0)return!1;for(var k=0;k<D.g.length;k++)if(D.g[k]!=0)return!1;return!0}function U(D){return D.h==-1}n.l=function(D){return D=K(this,D),U(D)?-1:L(D)?0:1};function O(D){for(var k=D.g.length,x=[],P=0;P<k;P++)x[P]=~D.g[P];return new c(x,~D.h).add(C)}n.abs=function(){return U(this)?O(this):this},n.add=function(D){for(var k=Math.max(this.g.length,D.g.length),x=[],P=0,N=0;N<=k;N++){var b=P+(this.i(N)&65535)+(D.i(N)&65535),M=(b>>>16)+(this.i(N)>>>16)+(D.i(N)>>>16);P=M>>>16,b&=65535,M&=65535,x[N]=M<<16|b}return new c(x,x[x.length-1]&-2147483648?-1:0)};function K(D,k){return D.add(O(k))}n.j=function(D){if(L(this)||L(D))return T;if(U(this))return U(D)?O(this).j(O(D)):O(O(this).j(D));if(U(D))return O(this.j(O(D)));if(0>this.l(A)&&0>D.l(A))return p(this.m()*D.m());for(var k=this.g.length+D.g.length,x=[],P=0;P<2*k;P++)x[P]=0;for(P=0;P<this.g.length;P++)for(var N=0;N<D.g.length;N++){var b=this.i(P)>>>16,M=this.i(P)&65535,Pe=D.i(N)>>>16,De=D.i(N)&65535;x[2*P+2*N]+=M*De,W(x,2*P+2*N),x[2*P+2*N+1]+=b*De,W(x,2*P+2*N+1),x[2*P+2*N+1]+=M*Pe,W(x,2*P+2*N+1),x[2*P+2*N+2]+=b*Pe,W(x,2*P+2*N+2)}for(P=0;P<k;P++)x[P]=x[2*P+1]<<16|x[2*P];for(P=k;P<2*k;P++)x[P]=0;return new c(x,0)};function W(D,k){for(;(D[k]&65535)!=D[k];)D[k+1]+=D[k]>>>16,D[k]&=65535,k++}function Y(D,k){this.g=D,this.h=k}function re(D,k){if(L(k))throw Error("division by zero");if(L(D))return new Y(T,T);if(U(D))return k=re(O(D),k),new Y(O(k.g),O(k.h));if(U(k))return k=re(D,O(k)),new Y(O(k.g),k.h);if(30<D.g.length){if(U(D)||U(k))throw Error("slowDivide_ only works with positive integers.");for(var x=C,P=k;0>=P.l(D);)x=le(x),P=le(P);var N=Z(x,1),b=Z(P,1);for(P=Z(P,2),x=Z(x,2);!L(P);){var M=b.add(P);0>=M.l(D)&&(N=N.add(x),b=M),P=Z(P,1),x=Z(x,1)}return k=K(D,N.j(k)),new Y(N,k)}for(N=T;0<=D.l(k);){for(x=Math.max(1,Math.floor(D.m()/k.m())),P=Math.ceil(Math.log(x)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),b=p(x),M=b.j(k);U(M)||0<M.l(D);)x-=P,b=p(x),M=b.j(k);L(b)&&(b=C),N=N.add(b),D=K(D,M)}return new Y(N,D)}n.A=function(D){return re(this,D).h},n.and=function(D){for(var k=Math.max(this.g.length,D.g.length),x=[],P=0;P<k;P++)x[P]=this.i(P)&D.i(P);return new c(x,this.h&D.h)},n.or=function(D){for(var k=Math.max(this.g.length,D.g.length),x=[],P=0;P<k;P++)x[P]=this.i(P)|D.i(P);return new c(x,this.h|D.h)},n.xor=function(D){for(var k=Math.max(this.g.length,D.g.length),x=[],P=0;P<k;P++)x[P]=this.i(P)^D.i(P);return new c(x,this.h^D.h)};function le(D){for(var k=D.g.length+1,x=[],P=0;P<k;P++)x[P]=D.i(P)<<1|D.i(P-1)>>>31;return new c(x,D.h)}function Z(D,k){var x=k>>5;k%=32;for(var P=D.g.length-x,N=[],b=0;b<P;b++)N[b]=0<k?D.i(b+x)>>>k|D.i(b+x+1)<<32-k:D.i(b+x);return new c(N,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,TT=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=y,Fi=c}).apply(typeof cy<"u"?cy:typeof self<"u"?self:typeof window<"u"?window:{});var Bu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ET,$a,CT,Xu,Jf,wT,ST,IT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,_,w){return h==Array.prototype||h==Object.prototype||(h[_]=w.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bu=="object"&&Bu];for(var _=0;_<h.length;++_){var w=h[_];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function i(h,_){if(_)e:{var w=r;h=h.split(".");for(var R=0;R<h.length-1;R++){var G=h[R];if(!(G in w))break e;w=w[G]}h=h[h.length-1],R=w[h],_=_(R),_!=R&&_!=null&&e(w,h,{configurable:!0,writable:!0,value:_})}}function a(h,_){h instanceof String&&(h+="");var w=0,R=!1,G={next:function(){if(!R&&w<h.length){var J=w++;return{value:_(J,h[J]),done:!1}}return R=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}i("Array.prototype.values",function(h){return h||function(){return a(this,function(_,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},f=this||self;function m(h){var _=typeof h;return _=_!="object"?_:h?Array.isArray(h)?"array":_:"null",_=="array"||_=="object"&&typeof h.length=="number"}function p(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function y(h,_,w){return h.call.apply(h.bind,arguments)}function T(h,_,w){if(!h)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,R),h.apply(_,G)}}return function(){return h.apply(_,arguments)}}function C(h,_,w){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:T,C.apply(null,arguments)}function A(h,_){var w=Array.prototype.slice.call(arguments,1);return function(){var R=w.slice();return R.push.apply(R,arguments),h.apply(this,R)}}function L(h,_){function w(){}w.prototype=_.prototype,h.aa=_.prototype,h.prototype=new w,h.prototype.constructor=h,h.Qb=function(R,G,J){for(var se=Array(arguments.length-2),je=2;je<arguments.length;je++)se[je-2]=arguments[je];return _.prototype[G].apply(R,se)}}function U(h){const _=h.length;if(0<_){const w=Array(_);for(let R=0;R<_;R++)w[R]=h[R];return w}return[]}function O(h,_){for(let w=1;w<arguments.length;w++){const R=arguments[w];if(m(R)){const G=h.length||0,J=R.length||0;h.length=G+J;for(let se=0;se<J;se++)h[G+se]=R[se]}else h.push(R)}}class K{constructor(_,w){this.i=_,this.j=w,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function W(h){return/^[\s\xa0]*$/.test(h)}function Y(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function re(h){return re[" "](h),h}re[" "]=function(){};var le=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function Z(h,_,w){for(const R in h)_.call(w,h[R],R,h)}function D(h,_){for(const w in h)_.call(void 0,h[w],w,h)}function k(h){const _={};for(const w in h)_[w]=h[w];return _}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(h,_){let w,R;for(let G=1;G<arguments.length;G++){R=arguments[G];for(w in R)h[w]=R[w];for(let J=0;J<x.length;J++)w=x[J],Object.prototype.hasOwnProperty.call(R,w)&&(h[w]=R[w])}}function N(h){var _=1;h=h.split(":");const w=[];for(;0<_&&h.length;)w.push(h.shift()),_--;return h.length&&w.push(h.join(":")),w}function b(h){f.setTimeout(()=>{throw h},0)}function M(){var h=ye;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class Pe{constructor(){this.h=this.g=null}add(_,w){const R=De.get();R.set(_,w),this.h?this.h.next=R:this.g=R,this.h=R}}var De=new K(()=>new Ne,h=>h.reset());class Ne{constructor(){this.next=this.g=this.h=null}set(_,w){this.h=_,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let Le,oe=!1,ye=new Pe,ue=()=>{const h=f.Promise.resolve(void 0);Le=()=>{h.then(q)}};var q=()=>{for(var h;h=M();){try{h.h.call(h.g)}catch(w){b(w)}var _=De;_.j(h),100>_.h&&(_.h++,h.next=_.g,_.g=h)}oe=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _e(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}_e.prototype.h=function(){this.defaultPrevented=!0};var ke=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};f.addEventListener("test",w,_),f.removeEventListener("test",w,_)}catch{}return h})();function Me(h,_){if(_e.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var w=this.type=h.type,R=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget){if(le){e:{try{re(_.nodeName);var G=!0;break e}catch{}G=!1}G||(_=null)}}else w=="mouseover"?_=h.fromElement:w=="mouseout"&&(_=h.toElement);this.relatedTarget=_,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Ue[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Me.aa.h.call(this)}}L(Me,_e);var Ue={2:"touch",3:"pen",4:"mouse"};Me.prototype.h=function(){Me.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ze="closure_listenable_"+(1e6*Math.random()|0),Ge=0;function Je(h,_,w,R,G){this.listener=h,this.proxy=null,this.src=_,this.type=w,this.capture=!!R,this.ha=G,this.key=++Ge,this.da=this.fa=!1}function at(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function $t(h){this.src=h,this.g={},this.h=0}$t.prototype.add=function(h,_,w,R,G){var J=h.toString();h=this.g[J],h||(h=this.g[J]=[],this.h++);var se=Tt(h,_,R,G);return-1<se?(_=h[se],w||(_.fa=!1)):(_=new Je(_,this.src,J,!!R,G),_.fa=w,h.push(_)),_};function or(h,_){var w=_.type;if(w in h.g){var R=h.g[w],G=Array.prototype.indexOf.call(R,_,void 0),J;(J=0<=G)&&Array.prototype.splice.call(R,G,1),J&&(at(_),h.g[w].length==0&&(delete h.g[w],h.h--))}}function Tt(h,_,w,R){for(var G=0;G<h.length;++G){var J=h[G];if(!J.da&&J.listener==_&&J.capture==!!w&&J.ha==R)return G}return-1}var sr="closure_lm_"+(1e6*Math.random()|0),ar={};function ti(h,_,w,R,G){if(Array.isArray(_)){for(var J=0;J<_.length;J++)ti(h,_[J],w,R,G);return null}return w=Ji(w),h&&h[ze]?h.K(_,w,p(R)?!!R.capture:!1,G):Pr(h,_,w,!1,R,G)}function Pr(h,_,w,R,G,J){if(!_)throw Error("Invalid event type");var se=p(G)?!!G.capture:!!G,je=ri(h);if(je||(h[sr]=je=new $t(h)),w=je.add(_,w,R,se,J),w.proxy)return w;if(R=Go(),w.proxy=R,R.src=h,R.listener=w,h.addEventListener)ke||(G=se),G===void 0&&(G=!1),h.addEventListener(_.toString(),R,G);else if(h.attachEvent)h.attachEvent(Cn(_.toString()),R);else if(h.addListener&&h.removeListener)h.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Go(){function h(w){return _.call(h.src,h.listener,w)}const _=Wi;return h}function ni(h,_,w,R,G){if(Array.isArray(_))for(var J=0;J<_.length;J++)ni(h,_[J],w,R,G);else R=p(R)?!!R.capture:!!R,w=Ji(w),h&&h[ze]?(h=h.i,_=String(_).toString(),_ in h.g&&(J=h.g[_],w=Tt(J,w,R,G),-1<w&&(at(J[w]),Array.prototype.splice.call(J,w,1),J.length==0&&(delete h.g[_],h.h--)))):h&&(h=ri(h))&&(_=h.g[_.toString()],h=-1,_&&(h=Tt(_,w,R,G)),(w=-1<h?_[h]:null)&&bn(w))}function bn(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[ze])or(_.i,h);else{var w=h.type,R=h.proxy;_.removeEventListener?_.removeEventListener(w,R,h.capture):_.detachEvent?_.detachEvent(Cn(w),R):_.addListener&&_.removeListener&&_.removeListener(R),(w=ri(_))?(or(w,h),w.h==0&&(w.src=null,_[sr]=null)):at(h)}}}function Cn(h){return h in ar?ar[h]:ar[h]="on"+h}function Wi(h,_){if(h.da)h=!0;else{_=new Me(_,this);var w=h.listener,R=h.ha||h.src;h.fa&&bn(h),h=w.call(R,_)}return h}function ri(h){return h=h[sr],h instanceof $t?h:null}var ii="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ji(h){return typeof h=="function"?h:(h[ii]||(h[ii]=function(_){return h.handleEvent(_)}),h[ii])}function mt(){Q.call(this),this.i=new $t(this),this.M=this,this.F=null}L(mt,Q),mt.prototype[ze]=!0,mt.prototype.removeEventListener=function(h,_,w,R){ni(this,h,_,w,R)};function gt(h,_){var w,R=h.F;if(R)for(w=[];R;R=R.F)w.push(R);if(h=h.M,R=_.type||_,typeof _=="string")_=new _e(_,h);else if(_ instanceof _e)_.target=_.target||h;else{var G=_;_=new _e(R,h),P(_,G)}if(G=!0,w)for(var J=w.length-1;0<=J;J--){var se=_.g=w[J];G=Un(se,R,!0,_)&&G}if(se=_.g=h,G=Un(se,R,!0,_)&&G,G=Un(se,R,!1,_)&&G,w)for(J=0;J<w.length;J++)se=_.g=w[J],G=Un(se,R,!1,_)&&G}mt.prototype.N=function(){if(mt.aa.N.call(this),this.i){var h=this.i,_;for(_ in h.g){for(var w=h.g[_],R=0;R<w.length;R++)at(w[R]);delete h.g[_],h.h--}}this.F=null},mt.prototype.K=function(h,_,w,R){return this.i.add(String(h),_,!1,w,R)},mt.prototype.L=function(h,_,w,R){return this.i.add(String(h),_,!0,w,R)};function Un(h,_,w,R){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();for(var G=!0,J=0;J<_.length;++J){var se=_[J];if(se&&!se.da&&se.capture==w){var je=se.listener,It=se.ha||se.src;se.fa&&or(h.i,se),G=je.call(It,R)!==!1&&G}}return G&&!R.defaultPrevented}function Ki(h,_,w){if(typeof h=="function")w&&(h=C(h,w));else if(h&&typeof h.handleEvent=="function")h=C(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:f.setTimeout(h,_||0)}function Fn(h){h.g=Ki(()=>{h.g=null,h.i&&(h.i=!1,Fn(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class Nr extends Q{constructor(_,w){super(),this.m=_,this.l=w,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Fn(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lr(h){Q.call(this),this.h=h,this.g={}}L(lr,Q);var Yi=[];function Qi(h){Z(h.g,function(_,w){this.g.hasOwnProperty(w)&&bn(_)},h),h.g={}}lr.prototype.N=function(){lr.aa.N.call(this),Qi(this)},lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xi=f.JSON.stringify,Zi=f.JSON.parse,ji=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function he(){}he.prototype.h=null;function Ve(h){return h.h||(h.h=h.i())}function Qe(){}var Ke={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Pt(){_e.call(this,"d")}L(Pt,_e);function pn(){_e.call(this,"c")}L(pn,_e);var ur={},ia=null;function eo(){return ia=ia||new mt}ur.La="serverreachability";function oa(h){_e.call(this,ur.La,h)}L(oa,_e);function Mr(h){const _=eo();gt(_,new oa(_))}ur.STAT_EVENT="statevent";function sa(h,_){_e.call(this,ur.STAT_EVENT,h),this.stat=_}L(sa,_e);function yt(h){const _=eo();gt(_,new sa(_,h))}ur.Ma="timingevent";function Ho(h,_){_e.call(this,ur.Ma,h),this.size=_}L(Ho,_e);function On(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},_)}function to(){this.g=!0}to.prototype.xa=function(){this.g=!1};function no(h,_,w,R,G,J){h.info(function(){if(h.g)if(J)for(var se="",je=J.split("&"),It=0;It<je.length;It++){var He=je[It].split("=");if(1<He.length){var Nt=He[0];He=He[1];var Et=Nt.split("_");se=2<=Et.length&&Et[1]=="type"?se+(Nt+"="+He+"&"):se+(Nt+"=redacted&")}}else se=null;else se=J;return"XMLHTTP REQ ("+R+") [attempt "+G+"]: "+_+`
`+w+`
`+se})}function $o(h,_,w,R,G,J,se){h.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+G+"]: "+_+`
`+w+`
`+J+" "+se})}function Bn(h,_,w,R){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+Kc(h,w)+(R?" "+R:"")})}function aa(h,_){h.info(function(){return"TIMEOUT: "+_})}to.prototype.info=function(){};function Kc(h,_){if(!h.g)return _;if(!_)return null;try{var w=JSON.parse(_);if(w){for(h=0;h<w.length;h++)if(Array.isArray(w[h])){var R=w[h];if(!(2>R.length)){var G=R[1];if(Array.isArray(G)&&!(1>G.length)){var J=G[0];if(J!="noop"&&J!="stop"&&J!="close")for(var se=1;se<G.length;se++)G[se]=""}}}}return Xi(w)}catch{return _}}var zo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Sl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},qn;function ro(){}L(ro,he),ro.prototype.g=function(){return new XMLHttpRequest},ro.prototype.i=function(){return{}},qn=new ro;function Gn(h,_,w,R){this.j=h,this.i=_,this.l=w,this.R=R||1,this.U=new lr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Il}function Il(){this.i=null,this.g="",this.h=!1}var la={},Wo={};function Jo(h,_,w){h.L=1,h.v=ui(gn(_)),h.m=w,h.P=!0,ua(h,null)}function ua(h,_){h.F=Date.now(),tt(h),h.A=gn(h.v);var w=h.A,R=h.R;Array.isArray(R)||(R=[String(R)]),di(w.i,"t",R),h.C=0,w=h.j.J,h.h=new Il,h.g=Hl(h.j,w?_:null,!h.m),0<h.O&&(h.M=new Nr(C(h.Y,h,h.g),h.O)),_=h.U,w=h.g,R=h.ca;var G="readystatechange";Array.isArray(G)||(G&&(Yi[0]=G.toString()),G=Yi);for(var J=0;J<G.length;J++){var se=ti(w,G[J],R||_.handleEvent,!1,_.h||_);if(!se)break;_.g[se.key]=se}_=h.H?k(h.H):{},h.m?(h.u||(h.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,_)):(h.u="GET",h.g.ea(h.A,h.u,null,_)),Mr(),no(h.i,h.u,h.A,h.l,h.R,h.m)}Gn.prototype.ca=function(h){h=h.target;const _=this.M;_&&sn(h)==3?_.j():this.Y(h)},Gn.prototype.Y=function(h){try{if(h==this.g)e:{const Et=sn(this.g);var _=this.g.Ba();const In=this.g.Z();if(!(3>Et)&&(Et!=3||this.g&&(this.h.h||this.g.oa()||ma(this.g)))){this.J||Et!=4||_==7||(_==8||0>=In?Mr(3):Mr(2)),io(this);var w=this.g.Z();this.X=w;t:if(Al(this)){var R=ma(this.g);h="";var G=R.length,J=sn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wn(this),oi(this);var se="";break t}this.h.i=new f.TextDecoder}for(_=0;_<G;_++)this.h.h=!0,h+=this.h.i.decode(R[_],{stream:!(J&&_==G-1)});R.length=0,this.h.g+=h,this.C=0,se=this.h.g}else se=this.g.oa();if(this.o=w==200,$o(this.i,this.u,this.A,this.l,this.R,Et,w),this.o){if(this.T&&!this.K){t:{if(this.g){var je,It=this.g;if((je=It.g?It.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(je)){var He=je;break t}}He=null}if(w=He)Bn(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ca(this,w);else{this.o=!1,this.s=3,yt(12),wn(this),oi(this);break e}}if(this.P){w=!0;let vn;for(;!this.J&&this.C<se.length;)if(vn=Yc(this,se),vn==Wo){Et==4&&(this.s=4,yt(14),w=!1),Bn(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==la){this.s=4,yt(15),Bn(this.i,this.l,se,"[Invalid Chunk]"),w=!1;break}else Bn(this.i,this.l,vn,null),ca(this,vn);if(Al(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Et!=4||se.length!=0||this.h.h||(this.s=1,yt(16),w=!1),this.o=this.o&&w,!w)Bn(this.i,this.l,se,"[Invalid Chunked Response]"),wn(this),oi(this);else if(0<se.length&&!this.W){this.W=!0;var Nt=this.j;Nt.g==this&&Nt.ba&&!Nt.M&&(Nt.j.info("Great, no buffering proxy detected. Bytes received: "+se.length),ya(Nt),Nt.M=!0,yt(11))}}else Bn(this.i,this.l,se,null),ca(this,se);Et==4&&wn(this),this.o&&!this.J&&(Et==4?is(this.j,this):(this.o=!1,tt(this)))}else jo(this.g),w==400&&0<se.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),wn(this),oi(this)}}}catch{}finally{}};function Al(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Yc(h,_){var w=h.C,R=_.indexOf(`
`,w);return R==-1?Wo:(w=Number(_.substring(w,R)),isNaN(w)?la:(R+=1,R+w>_.length?Wo:(_=_.slice(R,R+w),h.C=R+w,_)))}Gn.prototype.cancel=function(){this.J=!0,wn(this)};function tt(h){h.S=Date.now()+h.I,xl(h,h.I)}function xl(h,_){if(h.B!=null)throw Error("WatchDog timer not null");h.B=On(C(h.ba,h),_)}function io(h){h.B&&(f.clearTimeout(h.B),h.B=null)}Gn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(aa(this.i,this.A),this.L!=2&&(Mr(),yt(17)),wn(this),this.s=2,oi(this)):xl(this,this.S-h)};function oi(h){h.j.G==0||h.J||is(h.j,h)}function wn(h){io(h);var _=h.M;_&&typeof _.ma=="function"&&_.ma(),h.M=null,Qi(h.U),h.g&&(_=h.g,h.g=null,_.abort(),_.ma())}function ca(h,_){try{var w=h.j;if(w.G!=0&&(w.g==h||en(w.h,h))){if(!h.K&&en(w.h,h)&&w.G==3){try{var R=w.Da.g.parse(_)}catch{R=null}if(Array.isArray(R)&&R.length==3){var G=R;if(G[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<h.F)rs(w),Jn(w);else break e;ns(w),yt(18)}}else w.za=G[1],0<w.za-w.T&&37500>G[2]&&w.F&&w.v==0&&!w.C&&(w.C=On(C(w.Za,w),6e3));if(1>=Rl(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else Ur(w,11)}else if((h.K||w.g==h)&&rs(w),!W(_))for(G=w.Da.g.parse(_),_=0;_<G.length;_++){let He=G[_];if(w.T=He[0],He=He[1],w.G==2)if(He[0]=="c"){w.K=He[1],w.ia=He[2];const Nt=He[3];Nt!=null&&(w.la=Nt,w.j.info("VER="+w.la));const Et=He[4];Et!=null&&(w.Aa=Et,w.j.info("SVER="+w.Aa));const In=He[5];In!=null&&typeof In=="number"&&0<In&&(R=1.5*In,w.L=R,w.j.info("backChannelRequestTimeoutMs_="+R)),R=w;const vn=h.g;if(vn){const fo=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fo){var J=R.h;J.g||fo.indexOf("spdy")==-1&&fo.indexOf("quic")==-1&&fo.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(da(J,J.h),J.h=null))}if(R.D){const ss=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;ss&&(R.ya=ss,et(R.I,R.D,ss))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-h.F,w.j.info("Handshake RTT: "+w.R+"ms")),R=w;var se=h;if(R.qa=Gl(R,R.J?R.ia:null,R.W),se.K){Pl(R.h,se);var je=se,It=R.L;It&&(je.I=It),je.B&&(io(je),tt(je)),R.g=se}else co(R);0<w.i.length&&hr(w)}else He[0]!="stop"&&He[0]!="close"||Ur(w,7);else w.G==3&&(He[0]=="stop"||He[0]=="close"?He[0]=="stop"?Ur(w,7):Ft(w):He[0]!="noop"&&w.l&&w.l.ta(He),w.v=0)}}Mr(4)}catch{}}var kl=class{constructor(h,_){this.g=h,this.map=_}};function oo(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mn(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Rl(h){return h.h?1:h.g?h.g.size:0}function en(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function da(h,_){h.g?h.g.add(_):h.h=_}function Pl(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}oo.prototype.cancel=function(){if(this.i=Nl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Nl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const w of h.g.values())_=_.concat(w.D);return _}return U(h.i)}function Ko(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(m(h)){for(var _=[],w=h.length,R=0;R<w;R++)_.push(h[R]);return _}_=[],w=0;for(R in h)_[w++]=h[R];return _}function Yo(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(m(h)||typeof h=="string"){var _=[];h=h.length;for(var w=0;w<h;w++)_.push(w);return _}_=[],w=0;for(const R in h)_[w++]=R;return _}}}function si(h,_){if(h.forEach&&typeof h.forEach=="function")h.forEach(_,void 0);else if(m(h)||typeof h=="string")Array.prototype.forEach.call(h,_,void 0);else for(var w=Yo(h),R=Ko(h),G=R.length,J=0;J<G;J++)_.call(void 0,R[J],w&&w[J],h)}var so=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qc(h,_){if(h){h=h.split("&");for(var w=0;w<h.length;w++){var R=h[w].indexOf("="),G=null;if(0<=R){var J=h[w].substring(0,R);G=h[w].substring(R+1)}else J=h[w];_(J,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function Dr(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Dr){this.h=h.h,ao(this,h.j),this.o=h.o,this.g=h.g,ai(this,h.s),this.l=h.l;var _=h.i,w=new cr;w.i=_.i,_.g&&(w.g=new Map(_.g),w.h=_.h),li(this,w),this.m=h.m}else h&&(_=String(h).match(so))?(this.h=!1,ao(this,_[1]||"",!0),this.o=qe(_[2]||""),this.g=qe(_[3]||"",!0),ai(this,_[4]),this.l=qe(_[5]||"",!0),li(this,_[6]||"",!0),this.m=qe(_[7]||"")):(this.h=!1,this.i=new cr(null,this.h))}Dr.prototype.toString=function(){var h=[],_=this.j;_&&h.push(ci(_,Qo,!0),":");var w=this.g;return(w||_=="file")&&(h.push("//"),(_=this.o)&&h.push(ci(_,Qo,!0),"@"),h.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&h.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(ci(w,w.charAt(0)=="/"?Vl:Dl,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",ci(w,fa)),h.join("")};function gn(h){return new Dr(h)}function ao(h,_,w){h.j=w?qe(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function ai(h,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);h.s=_}else h.s=null}function li(h,_,w){_ instanceof cr?(h.i=_,dr(h.i,h.h)):(w||(_=ci(_,Ll)),h.i=new cr(_,h.h))}function et(h,_,w){h.i.set(_,w)}function ui(h){return et(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function qe(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ci(h,_,w){return typeof h=="string"?(h=encodeURI(h).replace(_,Ml),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Ml(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Qo=/[#\/\?@]/g,Dl=/[#\?:]/g,Vl=/[#\?]/g,Ll=/[#\?@]/g,fa=/#/g;function cr(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function Ut(h){h.g||(h.g=new Map,h.h=0,h.i&&Qc(h.i,function(_,w){h.add(decodeURIComponent(_.replace(/\+/g," ")),w)}))}n=cr.prototype,n.add=function(h,_){Ut(this),this.i=null,h=Sn(this,h);var w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(_),this.h+=1,this};function Hn(h,_){Ut(h),_=Sn(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function $n(h,_){return Ut(h),_=Sn(h,_),h.g.has(_)}n.forEach=function(h,_){Ut(this),this.g.forEach(function(w,R){w.forEach(function(G){h.call(_,G,R,this)},this)},this)},n.na=function(){Ut(this);const h=Array.from(this.g.values()),_=Array.from(this.g.keys()),w=[];for(let R=0;R<_.length;R++){const G=h[R];for(let J=0;J<G.length;J++)w.push(_[R])}return w},n.V=function(h){Ut(this);let _=[];if(typeof h=="string")$n(this,h)&&(_=_.concat(this.g.get(Sn(this,h))));else{h=Array.from(this.g.values());for(let w=0;w<h.length;w++)_=_.concat(h[w])}return _},n.set=function(h,_){return Ut(this),this.i=null,h=Sn(this,h),$n(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},n.get=function(h,_){return h?(h=this.V(h),0<h.length?String(h[0]):_):_};function di(h,_,w){Hn(h,_),0<w.length&&(h.i=null,h.g.set(Sn(h,_),U(w)),h.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(var w=0;w<_.length;w++){var R=_[w];const J=encodeURIComponent(String(R)),se=this.V(R);for(R=0;R<se.length;R++){var G=J;se[R]!==""&&(G+="="+encodeURIComponent(String(se[R]))),h.push(G)}}return this.i=h.join("&")};function Sn(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function dr(h,_){_&&!h.j&&(Ut(h),h.i=null,h.g.forEach(function(w,R){var G=R.toLowerCase();R!=G&&(Hn(this,R),di(this,G,w))},h)),h.j=_}function Xc(h,_){const w=new to;if(f.Image){const R=new Image;R.onload=A(on,w,"TestLoadImage: loaded",!0,_,R),R.onerror=A(on,w,"TestLoadImage: error",!1,_,R),R.onabort=A(on,w,"TestLoadImage: abort",!1,_,R),R.ontimeout=A(on,w,"TestLoadImage: timeout",!1,_,R),f.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=h}else _(!1)}function bl(h,_){const w=new to,R=new AbortController,G=setTimeout(()=>{R.abort(),on(w,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:R.signal}).then(J=>{clearTimeout(G),J.ok?on(w,"TestPingServer: ok",!0,_):on(w,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(G),on(w,"TestPingServer: error",!1,_)})}function on(h,_,w,R,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),R(w)}catch{}}function Zc(){this.g=new ji}function Ul(h,_,w){const R=w||"";try{si(h,function(G,J){let se=G;p(G)&&(se=Xi(G)),_.push(R+J+"="+encodeURIComponent(se))})}catch(G){throw _.push(R+"type="+encodeURIComponent("_badmap")),G}}function Vr(h){this.l=h.Ub||null,this.j=h.eb||!1}L(Vr,he),Vr.prototype.g=function(){return new lo(this.l,this.j)},Vr.prototype.i=(function(h){return function(){return h}})({});function lo(h,_){mt.call(this),this.D=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}L(lo,mt),n=lo.prototype,n.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=_,this.readyState=1,Wn(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(_.body=h),(this.D||f).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,zn(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Wn(this)),this.g&&(this.readyState=3,Wn(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?zn(this):Wn(this),this.readyState==3&&Fl(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,zn(this))},n.Qa=function(h){this.g&&(this.response=h,zn(this))},n.ga=function(){this.g&&zn(this)};function zn(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Wn(h)}n.setRequestHeader=function(h,_){this.u.append(h,_)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var w=_.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=_.next();return h.join(`\r
`)};function Wn(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(lo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Lr(h){let _="";return Z(h,function(w,R){_+=R,_+=":",_+=w,_+=`\r
`}),_}function fi(h,_,w){e:{for(R in w){var R=!1;break e}R=!0}R||(w=Lr(w),typeof h=="string"?w!=null&&encodeURIComponent(String(w)):et(h,_,w))}function lt(h){mt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}L(lt,mt);var jc=/^https?$/i,ha=["POST","PUT"];n=lt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,_,w,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():qn.g(),this.v=this.o?Ve(this.o):Ve(qn),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(J){uo(this,J);return}if(h=w||"",w=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var G in R)w.set(G,R[G]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const J of R.keys())w.set(J,R.get(J));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(w.keys()).find(J=>J.toLowerCase()=="content-type"),G=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(ha,_,void 0))||R||G||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,se]of w)this.g.setRequestHeader(J,se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Zo(this),this.u=!0,this.g.send(h),this.u=!1}catch(J){uo(this,J)}};function uo(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.m=5,Xo(h),yn(h)}function Xo(h){h.A||(h.A=!0,gt(h,"complete"),gt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,gt(this,"complete"),gt(this,"abort"),yn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yn(this,!0)),lt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?pa(this):this.bb())},n.bb=function(){pa(this)};function pa(h){if(h.h&&typeof c<"u"&&(!h.v[1]||sn(h)!=4||h.Z()!=2)){if(h.u&&sn(h)==4)Ki(h.Ea,0,h);else if(gt(h,"readystatechange"),sn(h)==4){h.h=!1;try{const se=h.Z();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var w;if(!(w=_)){var R;if(R=se===0){var G=String(h.D).match(so)[1]||null;!G&&f.self&&f.self.location&&(G=f.self.location.protocol.slice(0,-1)),R=!jc.test(G?G.toLowerCase():"")}w=R}if(w)gt(h,"complete"),gt(h,"success");else{h.m=6;try{var J=2<sn(h)?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.Z()+"]",Xo(h)}}finally{yn(h)}}}}function yn(h,_){if(h.g){Zo(h);const w=h.g,R=h.v[0]?()=>{}:null;h.g=null,h.v=null,_||gt(h,"ready");try{w.onreadystatechange=R}catch{}}}function Zo(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function sn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<sn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),Zi(_)}};function ma(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function jo(h){const _={};h=(h.g&&2<=sn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<h.length;R++){if(W(h[R]))continue;var w=N(h[R]);const G=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const J=_[G]||[];_[G]=J,J.push(w)}D(_,function(R){return R.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fr(h,_,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||_}function ga(h){this.Aa=0,this.i=[],this.j=new to,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fr("baseRetryDelayMs",5e3,h),this.cb=fr("retryDelaySeedMs",1e4,h),this.Wa=fr("forwardChannelMaxRetries",2,h),this.wa=fr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new oo(h&&h.concurrentRequestLimit),this.Da=new Zc,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ga.prototype,n.la=8,n.G=1,n.connect=function(h,_,w,R){yt(0),this.W=h,this.H=_||{},w&&R!==void 0&&(this.H.OSID=w,this.H.OAID=R),this.F=this.X,this.I=Gl(this,null,this.W),hr(this)};function Ft(h){if(es(h),h.G==3){var _=h.U++,w=gn(h.I);if(et(w,"SID",h.K),et(w,"RID",_),et(w,"TYPE","terminate"),br(h,w),_=new Gn(h,h.j,_),_.L=2,_.v=ui(gn(w)),w=!1,f.navigator&&f.navigator.sendBeacon)try{w=f.navigator.sendBeacon(_.v.toString(),"")}catch{}!w&&f.Image&&(new Image().src=_.v,w=!0),w||(_.g=Hl(_.j,null),_.g.ea(_.v)),_.F=Date.now(),tt(_)}ql(h)}function Jn(h){h.g&&(ya(h),h.g.cancel(),h.g=null)}function es(h){Jn(h),h.u&&(f.clearTimeout(h.u),h.u=null),rs(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function hr(h){if(!mn(h.h)&&!h.s){h.s=!0;var _=h.Ga;Le||ue(),oe||(Le(),oe=!0),ye.add(_,h),h.B=0}}function ed(h,_){return Rl(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=_.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=On(C(h.Ga,h,_),Bl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const G=new Gn(this,this.j,h);let J=this.o;if(this.S&&(J?(J=k(J),P(J,this.S)):J=this.S),this.m!==null||this.O||(G.H=J,J=null),this.P)e:{for(var _=0,w=0;w<this.i.length;w++){t:{var R=this.i[w];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(_+=R,4096<_){_=w;break e}if(_===4096||w===this.i.length-1){_=w+1;break e}}_=1e3}else _=1e3;_=hi(this,G,_),w=gn(this.I),et(w,"RID",h),et(w,"CVER",22),this.D&&et(w,"X-HTTP-Session-Id",this.D),br(this,w),J&&(this.O?_="headers="+encodeURIComponent(String(Lr(J)))+"&"+_:this.m&&fi(w,this.m,J)),da(this.h,G),this.Ua&&et(w,"TYPE","init"),this.P?(et(w,"$req",_),et(w,"SID","null"),G.T=!0,Jo(G,w,null)):Jo(G,w,_),this.G=2}}else this.G==3&&(h?ts(this,h):this.i.length==0||mn(this.h)||ts(this))};function ts(h,_){var w;_?w=_.l:w=h.U++;const R=gn(h.I);et(R,"SID",h.K),et(R,"RID",w),et(R,"AID",h.T),br(h,R),h.m&&h.o&&fi(R,h.m,h.o),w=new Gn(h,h.j,w,h.B+1),h.m===null&&(w.H=h.o),_&&(h.i=_.D.concat(h.i)),_=hi(h,w,1e3),w.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),da(h.h,w),Jo(w,R,_)}function br(h,_){h.H&&Z(h.H,function(w,R){et(_,R,w)}),h.l&&si({},function(w,R){et(_,R,w)})}function hi(h,_,w){w=Math.min(h.i.length,w);var R=h.l?C(h.l.Na,h.l,h):null;e:{var G=h.i;let J=-1;for(;;){const se=["count="+w];J==-1?0<w?(J=G[0].g,se.push("ofs="+J)):J=0:se.push("ofs="+J);let je=!0;for(let It=0;It<w;It++){let He=G[It].g;const Nt=G[It].map;if(He-=J,0>He)J=Math.max(0,G[It].g-100),je=!1;else try{Ul(Nt,se,"req"+He+"_")}catch{R&&R(Nt)}}if(je){R=se.join("&");break e}}}return h=h.i.splice(0,w),_.D=h,R}function co(h){if(!h.g&&!h.u){h.Y=1;var _=h.Fa;Le||ue(),oe||(Le(),oe=!0),ye.add(_,h),h.v=0}}function ns(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=On(C(h.Fa,h),Bl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Ol(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=On(C(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),Jn(this),Ol(this))};function ya(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function Ol(h){h.g=new Gn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var _=gn(h.qa);et(_,"RID","rpc"),et(_,"SID",h.K),et(_,"AID",h.T),et(_,"CI",h.F?"0":"1"),!h.F&&h.ja&&et(_,"TO",h.ja),et(_,"TYPE","xmlhttp"),br(h,_),h.m&&h.o&&fi(_,h.m,h.o),h.L&&(h.g.I=h.L);var w=h.g;h=h.ia,w.L=1,w.v=ui(gn(_)),w.m=null,w.P=!0,ua(w,h)}n.Za=function(){this.C!=null&&(this.C=null,Jn(this),ns(this),yt(19))};function rs(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function is(h,_){var w=null;if(h.g==_){rs(h),ya(h),h.g=null;var R=2}else if(en(h.h,_))w=_.D,Pl(h.h,_),R=1;else return;if(h.G!=0){if(_.o)if(R==1){w=_.m?_.m.length:0,_=Date.now()-_.F;var G=h.B;R=eo(),gt(R,new Ho(R,w)),hr(h)}else co(h);else if(G=_.s,G==3||G==0&&0<_.X||!(R==1&&ed(h,_)||R==2&&ns(h)))switch(w&&0<w.length&&(_=h.h,_.i=_.i.concat(w)),G){case 1:Ur(h,5);break;case 4:Ur(h,10);break;case 3:Ur(h,6);break;default:Ur(h,2)}}}function Bl(h,_){let w=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(w*=2),w*_}function Ur(h,_){if(h.j.info("Error code "+_),_==2){var w=C(h.fb,h),R=h.Xa;const G=!R;R=new Dr(R||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||ao(R,"https"),ui(R),G?Xc(R.toString(),w):bl(R.toString(),w)}else yt(2);h.G=0,h.l&&h.l.sa(_),ql(h),es(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function ql(h){if(h.G=0,h.ka=[],h.l){const _=Nl(h.h);(_.length!=0||h.i.length!=0)&&(O(h.ka,_),O(h.ka,h.i),h.h.i.length=0,U(h.i),h.i.length=0),h.l.ra()}}function Gl(h,_,w){var R=w instanceof Dr?gn(w):new Dr(w);if(R.g!="")_&&(R.g=_+"."+R.g),ai(R,R.s);else{var G=f.location;R=G.protocol,_=_?_+"."+G.hostname:G.hostname,G=+G.port;var J=new Dr(null);R&&ao(J,R),_&&(J.g=_),G&&ai(J,G),w&&(J.l=w),R=J}return w=h.D,_=h.ya,w&&_&&et(R,w,_),et(R,"VER",h.la),br(h,R),R}function Hl(h,_,w){if(_&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Ca&&!h.pa?new lt(new Vr({eb:w})):new lt(h.pa),_.Ha(h.J),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function va(){}n=va.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function os(){}os.prototype.g=function(h,_){return new tn(h,_)};function tn(h,_){mt.call(this),this.g=new ga(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(h?h["X-WebChannel-Client-Profile"]=_.va:h={"X-WebChannel-Client-Profile":_.va}),this.g.S=h,(h=_&&_.Sb)&&!W(h)&&(this.g.m=h),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!W(_)&&(this.g.D=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new pr(this)}L(tn,mt),tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},tn.prototype.close=function(){Ft(this.g)},tn.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.u&&(w={},w.__data__=Xi(h),h=w);_.i.push(new kl(_.Ya++,h)),_.G==3&&hr(_)},tn.prototype.N=function(){this.g.l=null,delete this.j,Ft(this.g),delete this.g,tn.aa.N.call(this)};function $l(h){Pt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const w in _){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}L($l,Pt);function zl(){pn.call(this),this.status=1}L(zl,pn);function pr(h){this.g=h}L(pr,va),pr.prototype.ua=function(){gt(this.g,"a")},pr.prototype.ta=function(h){gt(this.g,new $l(h))},pr.prototype.sa=function(h){gt(this.g,new zl)},pr.prototype.ra=function(){gt(this.g,"b")},os.prototype.createWebChannel=os.prototype.g,tn.prototype.send=tn.prototype.o,tn.prototype.open=tn.prototype.m,tn.prototype.close=tn.prototype.close,IT=function(){return new os},ST=function(){return eo()},wT=ur,Jf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},zo.NO_ERROR=0,zo.TIMEOUT=8,zo.HTTP_ERROR=6,Xu=zo,Sl.COMPLETE="complete",CT=Sl,Qe.EventType=Ke,Ke.OPEN="a",Ke.CLOSE="b",Ke.ERROR="c",Ke.MESSAGE="d",mt.prototype.listen=mt.prototype.K,$a=Qe,lt.prototype.listenOnce=lt.prototype.L,lt.prototype.getLastError=lt.prototype.Ka,lt.prototype.getLastErrorCode=lt.prototype.Ba,lt.prototype.getStatus=lt.prototype.Z,lt.prototype.getResponseJson=lt.prototype.Oa,lt.prototype.getResponseText=lt.prototype.oa,lt.prototype.send=lt.prototype.ea,lt.prototype.setWithCredentials=lt.prototype.Ha,ET=lt}).apply(typeof Bu<"u"?Bu:typeof self<"u"?self:typeof window<"u"?window:{});const dy="@firebase/firestore",fy="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qs="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do=new wh("@firebase/firestore");function xs(){return Do.logLevel}function de(n,...e){if(Do.logLevel<=Fe.DEBUG){const t=e.map(bh);Do.debug(`Firestore (${Qs}): ${n}`,...t)}}function Zr(n,...e){if(Do.logLevel<=Fe.ERROR){const t=e.map(bh);Do.error(`Firestore (${Qs}): ${n}`,...t)}}function qs(n,...e){if(Do.logLevel<=Fe.WARN){const t=e.map(bh);Do.warn(`Firestore (${Qs}): ${n}`,...t)}}function bh(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,AT(n,r,t)}function AT(n,e,t){let r=`FIRESTORE (${Qs}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Zr(r),new Error(r)}function Ze(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||AT(e,i,r)}function Re(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends ir{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class bA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Qt.UNAUTHENTICATED)))}shutdown(){}}class UA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class FA{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let r=this.i;const i=m=>this.i!==r?(r=this.i,t(m)):Promise.resolve();let a=new Oi;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Oi,e.enqueueRetryable((()=>i(this.currentUser)))};const c=()=>{const m=a;e.enqueueRetryable((async()=>{await m.promise,await i(this.currentUser)}))},f=m=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Oi)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ze(typeof r.accessToken=="string",31837,{l:r}),new xT(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new Qt(e)}}class OA{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class BA{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new OA(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Qt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class hy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,er(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const r=a=>{a.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.m;return this.m=a.token,de("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new hy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new hy(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=GA(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function Oe(n,e){return n<e?-1:n>e?1:0}function Kf(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return Df(i)===Df(a)?Oe(i,a):Df(i)?1:-1}return Oe(n.length,e.length)}const HA=55296,$A=57343;function Df(n){const e=n.charCodeAt(0);return e>=HA&&e<=$A}function Gs(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py="__name__";class _r{constructor(e,t,r){t===void 0?t=0:t>e.length&&Se(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Se(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return _r.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _r?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=_r.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return Oe(e.length,t.length)}static compareSegments(e,t){const r=_r.isNumericId(e),i=_r.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?_r.extractNumericId(e).compare(_r.extractNumericId(t)):Kf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fi.fromString(e.substring(4,e.length-2))}}class ft extends _r{construct(e,t,r){return new ft(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Te(te.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new ft(t)}static emptyPath(){return new ft([])}}const zA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gt extends _r{construct(e,t,r){return new Gt(e,t,r)}static isValidIdentifier(e){return zA.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===py}static keyField(){return new Gt([py])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Te(te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;i<e.length;){const f=e[i];if(f==="\\"){if(i+1===e.length)throw new Te(te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[i+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Te(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,i+=2}else f==="`"?(c=!c,i++):f!=="."||c?(r+=f,i++):(a(),i++)}if(a(),c)throw new Te(te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gt(t)}static emptyPath(){return new Gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(ft.fromString(e))}static fromName(e){return new we(ft.fromString(e).popFirst(5))}static empty(){return new we(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new ft(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(n,e,t){if(!t)throw new Te(te.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function JA(n,e,t,r){if(e===!0&&r===!0)throw new Te(te.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function my(n){if(!we.isDocumentKey(n))throw new Te(te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function kT(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Fh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Se(12329,{type:typeof n})}function ol(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Te(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Fh(n);throw new Te(te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(n,e){const t={typeString:n};return e&&(t.value=e),t}function vl(n,e){if(!kT(n))throw new Te(te.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const c=n[r];if(i&&typeof c!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&c!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Te(te.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy=-62135596800,yy=1e6;class st{static now(){return st.fromMillis(Date.now())}static fromDate(e){return st.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*yy);return new st(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gy)throw new Te(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yy}_compareTo(e){return this.seconds===e.seconds?Oe(this.nanoseconds,e.nanoseconds):Oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:st._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vl(e,st._jsonSchema))return new st(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}st._jsonSchemaVersion="firestore/timestamp/1.0",st._jsonSchema={type:St("string",st._jsonSchemaVersion),seconds:St("number"),nanoseconds:St("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{static fromTimestamp(e){return new xe(e)}static min(){return new xe(new st(0,0))}static max(){return new xe(new st(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl=-1;function KA(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=xe.fromTimestamp(r===1e9?new st(t+1,0):new st(t,r));return new Bi(i,we.empty(),e)}function YA(n){return new Bi(n.readTime,n.key,sl)}class Bi{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Bi(xe.min(),we.empty(),sl)}static max(){return new Bi(xe.max(),we.empty(),sl)}}function QA(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=we.comparator(n.documentKey,e.documentKey),t!==0?t:Oe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xs(n){if(n.code!==te.FAILED_PRECONDITION||n.message!==XA)throw n;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new X(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof X?t:X.resolve(t)}catch(t){return X.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):X.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):X.reject(t)}static resolve(e){return new X(((t,r)=>{t(e)}))}static reject(e){return new X(((t,r)=>{r(e)}))}static waitFor(e){return new X(((t,r)=>{let i=0,a=0,c=!1;e.forEach((f=>{++i,f.next((()=>{++a,c&&a===i&&t()}),(m=>r(m)))})),c=!0,a===i&&t()}))}static or(e){let t=X.resolve(!1);for(const r of e)t=t.next((i=>i?X.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new X(((r,i)=>{const a=e.length,c=new Array(a);let f=0;for(let m=0;m<a;m++){const p=m;t(e[p]).next((y=>{c[p]=y,++f,f===a&&r(c)}),(y=>i(y)))}}))}static doWhile(e,t){return new X(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}function jA(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Zs(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Dc.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=-1;function Vc(n){return n==null}function pc(n){return n===0&&1/n==-1/0}function ex(n){return typeof n=="number"&&Number.isInteger(n)&&!pc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT="";function tx(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vy(e)),e=nx(n.get(t),e);return vy(e)}function nx(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case RT:t+="";break;default:t+=a}}return t}function vy(n){return n+RT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function PT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,t){this.comparator=e,this.root=t||qt.EMPTY}insert(e,t){return new ht(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qt.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qu(this.root,e,this.comparator,!1)}getReverseIterator(){return new qu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qu(this.root,e,this.comparator,!0)}}class qu{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qt{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??qt.RED,this.left=i??qt.EMPTY,this.right=a??qt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new qt(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return qt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Se(27949);return e+(this.isRed()?0:1)}}qt.EMPTY=null,qt.RED=!0,qt.BLACK=!1;qt.EMPTY=new class{constructor(){this.size=0}get key(){throw Se(57766)}get value(){throw Se(16141)}get color(){throw Se(16727)}get left(){throw Se(29726)}get right(){throw Se(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new qt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ty(this.data.getIterator())}getIteratorFrom(e){return new Ty(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Rt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Rt(this.comparator);return t.data=e,t}}class Ty{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this.fields=e,e.sort(Gt.comparator)}static empty(){return new nr([])}unionWith(e){let t=new Rt(Gt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new nr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Gs(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new NT("Invalid base64 string: "+a):a}})(e);return new Ht(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let c=0;c<i.length;++c)a+=String.fromCharCode(i[c]);return a})(e);return new Ht(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ht.EMPTY_BYTE_STRING=new Ht("");const rx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qi(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=rx.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:_t(n.seconds),nanos:_t(n.nanos)}}function _t(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Gi(n){return typeof n=="string"?Ht.fromBase64String(n):Ht.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="server_timestamp",DT="__type__",VT="__previous_value__",LT="__local_write_time__";function Bh(n){return(n?.mapValue?.fields||{})[DT]?.stringValue===MT}function Lc(n){const e=n.mapValue.fields[VT];return Bh(e)?Lc(e):e}function al(n){const e=qi(n.mapValue.fields[LT].timestampValue);return new st(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(e,t,r,i,a,c,f,m,p,y){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=p,this.isUsingEmulator=y}}const mc="(default)";class ll{constructor(e,t){this.projectId=e,this.database=t||mc}static empty(){return new ll("","")}get isDefaultDatabase(){return this.database===mc}isEqual(e){return e instanceof ll&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="__type__",ox="__max__",Gu={mapValue:{}},UT="__vector__",gc="value";function Hi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Bh(n)?4:ax(n)?9007199254740991:sx(n)?10:11:Se(28295,{value:n})}function Ar(n,e){if(n===e)return!0;const t=Hi(n);if(t!==Hi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return al(n).isEqual(al(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const c=qi(i.timestampValue),f=qi(a.timestampValue);return c.seconds===f.seconds&&c.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return Gi(i.bytesValue).isEqual(Gi(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return _t(i.geoPointValue.latitude)===_t(a.geoPointValue.latitude)&&_t(i.geoPointValue.longitude)===_t(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return _t(i.integerValue)===_t(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const c=_t(i.doubleValue),f=_t(a.doubleValue);return c===f?pc(c)===pc(f):isNaN(c)&&isNaN(f)}return!1})(n,e);case 9:return Gs(n.arrayValue.values||[],e.arrayValue.values||[],Ar);case 10:case 11:return(function(i,a){const c=i.mapValue.fields||{},f=a.mapValue.fields||{};if(_y(c)!==_y(f))return!1;for(const m in c)if(c.hasOwnProperty(m)&&(f[m]===void 0||!Ar(c[m],f[m])))return!1;return!0})(n,e);default:return Se(52216,{left:n})}}function ul(n,e){return(n.values||[]).find((t=>Ar(t,e)))!==void 0}function Hs(n,e){if(n===e)return 0;const t=Hi(n),r=Hi(e);if(t!==r)return Oe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Oe(n.booleanValue,e.booleanValue);case 2:return(function(a,c){const f=_t(a.integerValue||a.doubleValue),m=_t(c.integerValue||c.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return Ey(n.timestampValue,e.timestampValue);case 4:return Ey(al(n),al(e));case 5:return Kf(n.stringValue,e.stringValue);case 6:return(function(a,c){const f=Gi(a),m=Gi(c);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(a,c){const f=a.split("/"),m=c.split("/");for(let p=0;p<f.length&&p<m.length;p++){const y=Oe(f[p],m[p]);if(y!==0)return y}return Oe(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,c){const f=Oe(_t(a.latitude),_t(c.latitude));return f!==0?f:Oe(_t(a.longitude),_t(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Cy(n.arrayValue,e.arrayValue);case 10:return(function(a,c){const f=a.fields||{},m=c.fields||{},p=f[gc]?.arrayValue,y=m[gc]?.arrayValue,T=Oe(p?.values?.length||0,y?.values?.length||0);return T!==0?T:Cy(p,y)})(n.mapValue,e.mapValue);case 11:return(function(a,c){if(a===Gu.mapValue&&c===Gu.mapValue)return 0;if(a===Gu.mapValue)return 1;if(c===Gu.mapValue)return-1;const f=a.fields||{},m=Object.keys(f),p=c.fields||{},y=Object.keys(p);m.sort(),y.sort();for(let T=0;T<m.length&&T<y.length;++T){const C=Kf(m[T],y[T]);if(C!==0)return C;const A=Hs(f[m[T]],p[y[T]]);if(A!==0)return A}return Oe(m.length,y.length)})(n.mapValue,e.mapValue);default:throw Se(23264,{he:t})}}function Ey(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Oe(n,e);const t=qi(n),r=qi(e),i=Oe(t.seconds,r.seconds);return i!==0?i:Oe(t.nanos,r.nanos)}function Cy(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=Hs(t[i],r[i]);if(a)return a}return Oe(t.length,r.length)}function $s(n){return Yf(n)}function Yf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=qi(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Gi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return we.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=Yf(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const c of r)a?a=!1:i+=",",i+=`${c}:${Yf(t.fields[c])}`;return i+"}"})(n.mapValue):Se(61005,{value:n})}function Zu(n){switch(Hi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Lc(n);return e?16+Zu(e):16;case 5:return 2*n.stringValue.length;case 6:return Gi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+Zu(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return bo(r.fields,((a,c)=>{i+=a.length+Zu(c)})),i})(n.mapValue);default:throw Se(13486,{value:n})}}function Qf(n){return!!n&&"integerValue"in n}function qh(n){return!!n&&"arrayValue"in n}function wy(n){return!!n&&"nullValue"in n}function Sy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ju(n){return!!n&&"mapValue"in n}function sx(n){return(n?.mapValue?.fields||{})[bT]?.stringValue===UT}function Qa(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return bo(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Qa(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Qa(n.arrayValue.values[t]);return e}return{...n}}function ax(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===ox}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.value=e}static empty(){return new Mn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ju(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qa(t)}setAll(e){let t=Gt.emptyPath(),r={},i=[];e.forEach(((c,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,r,i),r={},i=[],t=f.popLast()}c?r[f.lastSegment()]=Qa(c):i.push(f.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());ju(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ar(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ju(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){bo(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Mn(Qa(this.value))}}function FT(n){const e=[];return bo(n.fields,((t,r)=>{const i=new Gt([t]);if(ju(r)){const a=FT(r.mapValue).fields;if(a.length===0)e.push(i);else for(const c of a)e.push(i.child(c))}else e.push(i)})),new nr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,t,r,i,a,c,f){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=c,this.documentState=f}static newInvalidDocument(e){return new Xt(e,0,xe.min(),xe.min(),xe.min(),Mn.empty(),0)}static newFoundDocument(e,t,r,i){return new Xt(e,1,t,xe.min(),r,i,0)}static newNoDocument(e,t){return new Xt(e,2,t,xe.min(),xe.min(),Mn.empty(),0)}static newUnknownDocument(e,t){return new Xt(e,3,t,xe.min(),xe.min(),Mn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,t){this.position=e,this.inclusive=t}}function Iy(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],c=n.position[i];if(a.field.isKeyField()?r=we.comparator(we.fromName(c.referenceValue),t.key):r=Hs(c,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ay(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ar(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e,t="asc"){this.field=e,this.dir=t}}function lx(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{}class kt extends OT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new cx(e,t,r):t==="array-contains"?new hx(e,r):t==="in"?new px(e,r):t==="not-in"?new mx(e,r):t==="array-contains-any"?new gx(e,r):new kt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new dx(e,r):new fx(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Hs(t,this.value)):t!==null&&Hi(this.value)===Hi(t)&&this.matchesComparison(Hs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xr extends OT{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new xr(e,t)}matches(e){return BT(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function BT(n){return n.op==="and"}function qT(n){return ux(n)&&BT(n)}function ux(n){for(const e of n.filters)if(e instanceof xr)return!1;return!0}function Xf(n){if(n instanceof kt)return n.field.canonicalString()+n.op.toString()+$s(n.value);if(qT(n))return n.filters.map((e=>Xf(e))).join(",");{const e=n.filters.map((t=>Xf(t))).join(",");return`${n.op}(${e})`}}function GT(n,e){return n instanceof kt?(function(r,i){return i instanceof kt&&r.op===i.op&&r.field.isEqual(i.field)&&Ar(r.value,i.value)})(n,e):n instanceof xr?(function(r,i){return i instanceof xr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,c,f)=>a&&GT(c,i.filters[f])),!0):!1})(n,e):void Se(19439)}function HT(n){return n instanceof kt?(function(t){return`${t.field.canonicalString()} ${t.op} ${$s(t.value)}`})(n):n instanceof xr?(function(t){return t.op.toString()+" {"+t.getFilters().map(HT).join(" ,")+"}"})(n):"Filter"}class cx extends kt{constructor(e,t,r){super(e,t,r),this.key=we.fromName(r.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class dx extends kt{constructor(e,t){super(e,"in",t),this.keys=$T("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class fx extends kt{constructor(e,t){super(e,"not-in",t),this.keys=$T("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function $T(n,e){return(e.arrayValue?.values||[]).map((t=>we.fromName(t.referenceValue)))}class hx extends kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qh(t)&&ul(t.arrayValue,this.value)}}class px extends kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ul(this.value.arrayValue,t)}}class mx extends kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(ul(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ul(this.value.arrayValue,t)}}class gx extends kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>ul(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{constructor(e,t=null,r=[],i=[],a=null,c=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=c,this.endAt=f,this.Te=null}}function xy(n,e=null,t=[],r=[],i=null,a=null,c=null){return new yx(n,e,t,r,i,a,c)}function Gh(n){const e=Re(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Xf(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Vc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>$s(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>$s(r))).join(",")),e.Te=t}return e.Te}function Hh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lx(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!GT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ay(n.startAt,e.startAt)&&Ay(n.endAt,e.endAt)}function Zf(n){return we.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,t=null,r=[],i=[],a=null,c="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=c,this.startAt=f,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function vx(n,e,t,r,i,a,c,f){return new bc(n,e,t,r,i,a,c,f)}function $h(n){return new bc(n)}function ky(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function _x(n){return n.collectionGroup!==null}function Xa(n){const e=Re(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let f=new Rt(Gt.comparator);return c.filters.forEach((m=>{m.getFlattenedFilters().forEach((p=>{p.isInequality()&&(f=f.add(p.field))}))})),f})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new vc(a,r))})),t.has(Gt.keyField().canonicalString())||e.Ie.push(new vc(Gt.keyField(),r))}return e.Ie}function Er(n){const e=Re(n);return e.Ee||(e.Ee=Tx(e,Xa(n))),e.Ee}function Tx(n,e){if(n.limitType==="F")return xy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new vc(i.field,a)}));const t=n.endAt?new yc(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new yc(n.startAt.position,n.startAt.inclusive):null;return xy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function jf(n,e,t){return new bc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Uc(n,e){return Hh(Er(n),Er(e))&&n.limitType===e.limitType}function zT(n){return`${Gh(Er(n))}|lt:${n.limitType}`}function ks(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>HT(i))).join(", ")}]`),Vc(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>$s(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>$s(i))).join(",")),`Target(${r})`})(Er(n))}; limitType=${n.limitType})`}function Fc(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):we.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of Xa(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(c,f,m){const p=Iy(c,f,m);return c.inclusive?p<=0:p<0})(r.startAt,Xa(r),i)||r.endAt&&!(function(c,f,m){const p=Iy(c,f,m);return c.inclusive?p>=0:p>0})(r.endAt,Xa(r),i))})(n,e)}function Ex(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function WT(n){return(e,t)=>{let r=!1;for(const i of Xa(n)){const a=Cx(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function Cx(n,e,t){const r=n.field.isKeyField()?we.comparator(e.key,t.key):(function(a,c,f){const m=c.data.field(a),p=f.data.field(a);return m!==null&&p!==null?Hs(m,p):Se(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Se(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){bo(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return PT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx=new ht(we.comparator);function jr(){return wx}const JT=new ht(we.comparator);function za(...n){let e=JT;for(const t of n)e=e.insert(t.key,t);return e}function KT(n){let e=JT;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function xo(){return Za()}function YT(){return Za()}function Za(){return new Uo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Sx=new ht(we.comparator),Ix=new Rt(we.comparator);function Be(...n){let e=Ix;for(const t of n)e=e.add(t);return e}const Ax=new Rt(Oe);function xx(){return Ax}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pc(e)?"-0":e}}function QT(n){return{integerValue:""+n}}function kx(n,e){return ex(e)?QT(e):zh(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(){this._=void 0}}function Rx(n,e,t){return n instanceof _c?(function(i,a){const c={fields:{[DT]:{stringValue:MT},[LT]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Bh(a)&&(a=Lc(a)),a&&(c.fields[VT]=a),{mapValue:c}})(t,e):n instanceof cl?ZT(n,e):n instanceof dl?jT(n,e):(function(i,a){const c=XT(i,a),f=Ry(c)+Ry(i.Ae);return Qf(c)&&Qf(i.Ae)?QT(f):zh(i.serializer,f)})(n,e)}function Px(n,e,t){return n instanceof cl?ZT(n,e):n instanceof dl?jT(n,e):t}function XT(n,e){return n instanceof Tc?(function(r){return Qf(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class _c extends Oc{}class cl extends Oc{constructor(e){super(),this.elements=e}}function ZT(n,e){const t=e0(e);for(const r of n.elements)t.some((i=>Ar(i,r)))||t.push(r);return{arrayValue:{values:t}}}class dl extends Oc{constructor(e){super(),this.elements=e}}function jT(n,e){let t=e0(e);for(const r of n.elements)t=t.filter((i=>!Ar(i,r)));return{arrayValue:{values:t}}}class Tc extends Oc{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ry(n){return _t(n.integerValue||n.doubleValue)}function e0(n){return qh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Nx(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof cl&&i instanceof cl||r instanceof dl&&i instanceof dl?Gs(r.elements,i.elements,Ar):r instanceof Tc&&i instanceof Tc?Ar(r.Ae,i.Ae):r instanceof _c&&i instanceof _c})(n.transform,e.transform)}class Mx{constructor(e,t){this.version=e,this.transformResults=t}}class Yr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Yr}static exists(e){return new Yr(void 0,e)}static updateTime(e){return new Yr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ec(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Bc{}function t0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new r0(n.key,Yr.none()):new _l(n.key,n.data,Yr.none());{const t=n.data,r=Mn.empty();let i=new Rt(Gt.comparator);for(let a of e.fields)if(!i.has(a)){let c=t.field(a);c===null&&a.length>1&&(a=a.popLast(),c=t.field(a)),c===null?r.delete(a):r.set(a,c),i=i.add(a)}return new Fo(n.key,r,new nr(i.toArray()),Yr.none())}}function Dx(n,e,t){n instanceof _l?(function(i,a,c){const f=i.value.clone(),m=Ny(i.fieldTransforms,a,c.transformResults);f.setAll(m),a.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(n,e,t):n instanceof Fo?(function(i,a,c){if(!ec(i.precondition,a))return void a.convertToUnknownDocument(c.version);const f=Ny(i.fieldTransforms,a,c.transformResults),m=a.data;m.setAll(n0(i)),m.setAll(f),a.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(n,e,t):(function(i,a,c){a.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function ja(n,e,t,r){return n instanceof _l?(function(a,c,f,m){if(!ec(a.precondition,c))return f;const p=a.value.clone(),y=My(a.fieldTransforms,m,c);return p.setAll(y),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(n,e,t,r):n instanceof Fo?(function(a,c,f,m){if(!ec(a.precondition,c))return f;const p=My(a.fieldTransforms,m,c),y=c.data;return y.setAll(n0(a)),y.setAll(p),c.convertToFoundDocument(c.version,y).setHasLocalMutations(),f===null?null:f.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((T=>T.field)))})(n,e,t,r):(function(a,c,f){return ec(a.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):f})(n,e,t)}function Vx(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=XT(r.transform,i||null);a!=null&&(t===null&&(t=Mn.empty()),t.set(r.field,a))}return t||null}function Py(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Gs(r,i,((a,c)=>Nx(a,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class _l extends Bc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Fo extends Bc{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function n0(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function Ny(n,e,t){const r=new Map;Ze(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],c=a.transform,f=e.data.field(a.field);r.set(a.field,Px(c,f,t[i]))}return r}function My(n,e,t){const r=new Map;for(const i of n){const a=i.transform,c=t.data.field(i.field);r.set(i.field,Rx(a,c,e))}return r}class r0 extends Bc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Lx extends Bc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&Dx(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ja(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ja(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=YT();return this.mutations.forEach((i=>{const a=e.get(i.key),c=a.overlayedDocument;let f=this.applyToLocalView(c,a.mutatedFields);f=t.has(i.key)?null:f;const m=t0(c,f);m!==null&&r.set(i.key,m),c.isValidDocument()||c.convertToNoDocument(xe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Be())}isEqual(e){return this.batchId===e.batchId&&Gs(this.mutations,e.mutations,((t,r)=>Py(t,r)))&&Gs(this.baseMutations,e.baseMutations,((t,r)=>Py(t,r)))}}class Wh{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ze(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return Sx})();const a=e.mutations;for(let c=0;c<a.length;c++)i=i.insert(a[c].key,r[c].version);return new Wh(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wt,$e;function Ox(n){switch(n){case te.OK:return Se(64938);case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0;default:return Se(15467,{code:n})}}function i0(n){if(n===void 0)return Zr("GRPC error has no .code"),te.UNKNOWN;switch(n){case wt.OK:return te.OK;case wt.CANCELLED:return te.CANCELLED;case wt.UNKNOWN:return te.UNKNOWN;case wt.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case wt.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case wt.INTERNAL:return te.INTERNAL;case wt.UNAVAILABLE:return te.UNAVAILABLE;case wt.UNAUTHENTICATED:return te.UNAUTHENTICATED;case wt.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case wt.NOT_FOUND:return te.NOT_FOUND;case wt.ALREADY_EXISTS:return te.ALREADY_EXISTS;case wt.PERMISSION_DENIED:return te.PERMISSION_DENIED;case wt.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case wt.ABORTED:return te.ABORTED;case wt.OUT_OF_RANGE:return te.OUT_OF_RANGE;case wt.UNIMPLEMENTED:return te.UNIMPLEMENTED;case wt.DATA_LOSS:return te.DATA_LOSS;default:return Se(39323,{code:n})}}($e=wt||(wt={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx=new Fi([4294967295,4294967295],0);function Dy(n){const e=Bx().encode(n),t=new TT;return t.update(e),new Uint8Array(t.digest())}function Vy(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Fi([t,r],0),new Fi([i,a],0)]}class Jh{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Wa(`Invalid padding: ${t}`);if(r<0)throw new Wa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wa(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Wa(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Fi.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Fi.fromNumber(r)));return i.compare(qx)===1&&(i=new Fi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Dy(e),[r,i]=Vy(t);for(let a=0;a<this.hashCount;a++){const c=this.ye(r,i,a);if(!this.we(c))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),c=new Jh(a,i,t);return r.forEach((f=>c.insert(f))),c}insert(e){if(this.ge===0)return;const t=Dy(e),[r,i]=Vy(t);for(let a=0;a<this.hashCount;a++){const c=this.ye(r,i,a);this.Se(c)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Wa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Tl.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new qc(xe.min(),i,new ht(Oe),jr(),Be())}}class Tl{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Tl(r,t,Be(),Be(),Be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class o0{constructor(e,t){this.targetId=e,this.Ce=t}}class s0{constructor(e,t,r=Ht.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Ly{constructor(){this.ve=0,this.Fe=by(),this.Me=Ht.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Be(),t=Be(),r=Be();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Se(38017,{changeType:a})}})),new Tl(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=by()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ze(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Gx{constructor(e){this.Ge=e,this.ze=new Map,this.je=jr(),this.Je=Hu(),this.He=Hu(),this.Ye=new ht(Oe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Se(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(Zf(a))if(r===0){const c=new we(a.path);this.et(t,c,Xt.newNoDocument(c,xe.min()))}else Ze(r===1,20013,{expectedCount:r});else{const c=this._t(t);if(c!==r){const f=this.ut(e),m=f?this.ct(f,e,c):1;if(m!==0){this.it(t);const p=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let c,f;try{c=Gi(r).toUint8Array()}catch(m){if(m instanceof NT)return qs("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new Jh(c,i,a)}catch(m){return qs(m instanceof Wa?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.ge===0?null:f}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const c=this.Ge.ht(),f=`projects/${c.projectId}/databases/${c.database}/documents/${a.path.canonicalString()}`;e.mightContain(f)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,c)=>{const f=this.ot(c);if(f){if(a.current&&Zf(f.target)){const m=new we(f.target.path);this.It(m).has(c)||this.Et(c,m)||this.et(c,m,Xt.newNoDocument(m,e))}a.Be&&(t.set(c,a.ke()),a.qe())}}));let r=Be();this.He.forEach(((a,c)=>{let f=!0;c.forEachWhile((m=>{const p=this.ot(m);return!p||p.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(r=r.add(a))})),this.je.forEach(((a,c)=>c.setReadTime(e)));const i=new qc(e,t,this.Ye,this.je,r);return this.je=jr(),this.Je=Hu(),this.He=Hu(),this.Ye=new ht(Oe),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Ly,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Rt(Oe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Rt(Oe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||de("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ly),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Hu(){return new ht(we.comparator)}function by(){return new ht(we.comparator)}const Hx={asc:"ASCENDING",desc:"DESCENDING"},$x={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zx={and:"AND",or:"OR"};class Wx{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function eh(n,e){return n.useProto3Json||Vc(e)?e:{value:e}}function Ec(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function a0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Jx(n,e){return Ec(n,e.toTimestamp())}function Cr(n){return Ze(!!n,49232),xe.fromTimestamp((function(t){const r=qi(t);return new st(r.seconds,r.nanos)})(n))}function Kh(n,e){return th(n,e).canonicalString()}function th(n,e){const t=(function(i){return new ft(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function l0(n){const e=ft.fromString(n);return Ze(h0(e),10190,{key:e.toString()}),e}function nh(n,e){return Kh(n.databaseId,e.path)}function Vf(n,e){const t=l0(e);if(t.get(1)!==n.databaseId.projectId)throw new Te(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Te(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new we(c0(t))}function u0(n,e){return Kh(n.databaseId,e)}function Kx(n){const e=l0(n);return e.length===4?ft.emptyPath():c0(e)}function rh(n){return new ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function c0(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Uy(n,e,t){return{name:nh(n,e),fields:t.value.mapValue.fields}}function Yx(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Se(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(p,y){return p.useProto3Json?(Ze(y===void 0||typeof y=="string",58123),Ht.fromBase64String(y||"")):(Ze(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),Ht.fromUint8Array(y||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,f=c&&(function(p){const y=p.code===void 0?te.UNKNOWN:i0(p.code);return new Te(y,p.message||"")})(c);t=new s0(r,i,a,f||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Vf(n,r.document.name),a=Cr(r.document.updateTime),c=r.document.createTime?Cr(r.document.createTime):xe.min(),f=new Mn({mapValue:{fields:r.document.fields}}),m=Xt.newFoundDocument(i,a,c,f),p=r.targetIds||[],y=r.removedTargetIds||[];t=new tc(p,y,m.key,m)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Vf(n,r.document),a=r.readTime?Cr(r.readTime):xe.min(),c=Xt.newNoDocument(i,a),f=r.removedTargetIds||[];t=new tc([],f,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Vf(n,r.document),a=r.removedTargetIds||[];t=new tc([],a,i,null)}else{if(!("filter"in e))return Se(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,c=new Fx(i,a),f=r.targetId;t=new o0(f,c)}}return t}function Qx(n,e){let t;if(e instanceof _l)t={update:Uy(n,e.key,e.value)};else if(e instanceof r0)t={delete:nh(n,e.key)};else if(e instanceof Fo)t={update:Uy(n,e.key,e.data),updateMask:ok(e.fieldMask)};else{if(!(e instanceof Lx))return Se(16599,{Vt:e.type});t={verify:nh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,c){const f=c.transform;if(f instanceof _c)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof cl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof dl)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Tc)return{fieldPath:c.field.canonicalString(),increment:f.Ae};throw Se(20930,{transform:c.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:Jx(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Se(27497)})(n,e.precondition)),t}function Xx(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map((t=>(function(i,a){let c=i.updateTime?Cr(i.updateTime):Cr(a);return c.isEqual(xe.min())&&(c=Cr(a)),new Mx(c,i.transformResults||[])})(t,e)))):[]}function Zx(n,e){return{documents:[u0(n,e.path)]}}function jx(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=u0(n,i);const a=(function(p){if(p.length!==0)return f0(xr.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const c=(function(p){if(p.length!==0)return p.map((y=>(function(C){return{field:Rs(C.field),direction:nk(C.dir)}})(y)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const f=eh(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:i}}function ek(n){let e=Kx(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ze(r===1,65062);const y=t.from[0];y.allDescendants?i=y.collectionId:e=e.child(y.collectionId)}let a=[];t.where&&(a=(function(T){const C=d0(T);return C instanceof xr&&qT(C)?C.getFilters():[C]})(t.where));let c=[];t.orderBy&&(c=(function(T){return T.map((C=>(function(L){return new vc(Ps(L.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(L.direction))})(C)))})(t.orderBy));let f=null;t.limit&&(f=(function(T){let C;return C=typeof T=="object"?T.value:T,Vc(C)?null:C})(t.limit));let m=null;t.startAt&&(m=(function(T){const C=!!T.before,A=T.values||[];return new yc(A,C)})(t.startAt));let p=null;return t.endAt&&(p=(function(T){const C=!T.before,A=T.values||[];return new yc(A,C)})(t.endAt)),vx(e,i,c,a,f,"F",m,p)}function tk(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function d0(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ps(t.unaryFilter.field);return kt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ps(t.unaryFilter.field);return kt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ps(t.unaryFilter.field);return kt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Ps(t.unaryFilter.field);return kt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Se(61313);default:return Se(60726)}})(n):n.fieldFilter!==void 0?(function(t){return kt.create(Ps(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Se(58110);default:return Se(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return xr.create(t.compositeFilter.filters.map((r=>d0(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Se(1026)}})(t.compositeFilter.op))})(n):Se(30097,{filter:n})}function nk(n){return Hx[n]}function rk(n){return $x[n]}function ik(n){return zx[n]}function Rs(n){return{fieldPath:n.canonicalString()}}function Ps(n){return Gt.fromServerFormat(n.fieldPath)}function f0(n){return n instanceof kt?(function(t){if(t.op==="=="){if(Sy(t.value))return{unaryFilter:{field:Rs(t.field),op:"IS_NAN"}};if(wy(t.value))return{unaryFilter:{field:Rs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Sy(t.value))return{unaryFilter:{field:Rs(t.field),op:"IS_NOT_NAN"}};if(wy(t.value))return{unaryFilter:{field:Rs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rs(t.field),op:rk(t.op),value:t.value}}})(n):n instanceof xr?(function(t){const r=t.getFilters().map((i=>f0(i)));return r.length===1?r[0]:{compositeFilter:{op:ik(t.op),filters:r}}})(n):Se(54877,{filter:n})}function ok(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function h0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,t,r,i,a=xe.min(),c=xe.min(),f=Ht.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Mi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.yt=e}}function ak(n){const e=ek({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?jf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(){this.Cn=new uk}addToCollectionParentIndex(e,t){return this.Cn.add(t),X.resolve()}getCollectionParents(e,t){return X.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return X.resolve()}deleteFieldIndex(e,t){return X.resolve()}deleteAllFieldIndexes(e){return X.resolve()}createTargetIndexes(e,t){return X.resolve()}getDocumentsMatchingTarget(e,t){return X.resolve(null)}getIndexType(e,t){return X.resolve(0)}getFieldIndexes(e,t){return X.resolve([])}getNextCollectionGroupToUpdate(e){return X.resolve(null)}getMinOffset(e,t){return X.resolve(Bi.min())}getMinOffsetFromCollectionGroup(e,t){return X.resolve(Bi.min())}updateCollectionGroup(e,t,r){return X.resolve()}updateIndexEntries(e,t){return X.resolve()}}class uk{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Rt(ft.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Rt(ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},p0=41943040;class hn{static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(p0,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new zs(0)}static cr(){return new zs(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy="LruGarbageCollector",ck=1048576;function By([n,e],[t,r]){const i=Oe(n,t);return i===0?Oe(e,r):i}class dk{constructor(e){this.Ir=e,this.buffer=new Rt(By),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();By(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class fk{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){de(Oy,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Zs(t)?de(Oy,"Ignoring IndexedDB error during garbage collection: ",t):await Xs(t)}await this.Vr(3e5)}))}}class hk{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return X.resolve(Dc.ce);const r=new dk(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),X.resolve(Fy)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fy):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,c,f,m,p;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),i=this.params.maximumSequenceNumbersToCollect):i=T,c=Date.now(),this.nthSequenceNumber(e,i)))).next((T=>(r=T,f=Date.now(),this.removeTargets(e,r,t)))).next((T=>(a=T,m=Date.now(),this.removeOrphanedDocuments(e,r)))).next((T=>(p=Date.now(),xs()<=Fe.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-y}ms
	Determined least recently used ${i} in `+(f-c)+`ms
	Removed ${a} targets in `+(m-f)+`ms
	Removed ${T} documents in `+(p-m)+`ms
Total Duration: ${p-y}ms`),X.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:T}))))}}function pk(n,e){return new hk(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(){this.changes=new Uo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?X.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&ja(r.mutation,i,nr.empty(),st.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Be()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Be()){const i=xo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let c=za();return a.forEach(((f,m)=>{c=c.insert(f,m.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const r=xo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Be())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((c,f)=>{t.set(c,f)}))}))}computeViews(e,t,r,i){let a=jr();const c=Za(),f=(function(){return Za()})();return t.forEach(((m,p)=>{const y=r.get(p.key);i.has(p.key)&&(y===void 0||y.mutation instanceof Fo)?a=a.insert(p.key,p):y!==void 0?(c.set(p.key,y.mutation.getFieldMask()),ja(y.mutation,p,y.mutation.getFieldMask(),st.now())):c.set(p.key,nr.empty())})),this.recalculateAndSaveOverlays(e,a).next((m=>(m.forEach(((p,y)=>c.set(p,y))),t.forEach(((p,y)=>f.set(p,new gk(y,c.get(p)??null)))),f)))}recalculateAndSaveOverlays(e,t){const r=Za();let i=new ht(((c,f)=>c-f)),a=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const f of c)f.keys().forEach((m=>{const p=t.get(m);if(p===null)return;let y=r.get(m)||nr.empty();y=f.applyToLocalView(p,y),r.set(m,y);const T=(i.get(f.batchId)||Be()).add(m);i=i.insert(f.batchId,T)}))})).next((()=>{const c=[],f=i.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),p=m.key,y=m.value,T=YT();y.forEach((C=>{if(!a.has(C)){const A=t0(t.get(C),r.get(C));A!==null&&T.set(C,A),a=a.add(C)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,T))}return X.waitFor(c)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(c){return we.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_x(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const c=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):X.resolve(xo());let f=sl,m=a;return c.next((p=>X.forEach(p,((y,T)=>(f<T.largestBatchId&&(f=T.largestBatchId),a.get(y)?X.resolve():this.remoteDocumentCache.getEntry(e,y).next((C=>{m=m.insert(y,C)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,m,p,Be()))).next((y=>({batchId:f,changes:KT(y)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next((r=>{let i=za();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let c=za();return this.indexManager.getCollectionParents(e,a).next((f=>X.forEach(f,(m=>{const p=(function(T,C){return new bc(C,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,m.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,r,i).next((y=>{y.forEach(((T,C)=>{c=c.insert(T,C)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((c=>(a=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((c=>{a.forEach(((m,p)=>{const y=p.getKey();c.get(y)===null&&(c=c.insert(y,Xt.newInvalidDocument(y)))}));let f=za();return c.forEach(((m,p)=>{const y=a.get(m);y!==void 0&&ja(y.mutation,p,nr.empty(),st.now()),Fc(t,p)&&(f=f.insert(m,p))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return X.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Cr(i.createTime)}})(t)),X.resolve()}getNamedQuery(e,t){return X.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:ak(i.bundledQuery),readTime:Cr(i.readTime)}})(t)),X.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k{constructor(){this.overlays=new ht(we.comparator),this.qr=new Map}getOverlay(e,t){return X.resolve(this.overlays.get(t))}getOverlays(e,t){const r=xo();return X.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),X.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),X.resolve()}getOverlaysForCollection(e,t,r){const i=xo(),a=t.length+1,c=new we(t.child("")),f=this.overlays.getIteratorFrom(c);for(;f.hasNext();){const m=f.getNext().value,p=m.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&m.largestBatchId>r&&i.set(m.getKey(),m)}return X.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new ht(((p,y)=>p-y));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let y=a.get(p.largestBatchId);y===null&&(y=xo(),a=a.insert(p.largestBatchId,y)),y.set(p.getKey(),p)}}const f=xo(),m=a.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((p,y)=>f.set(p,y))),!(f.size()>=i)););return X.resolve(f)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const c=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new Ux(t,r));let a=this.qr.get(t);a===void 0&&(a=Be(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(){this.sessionToken=Ht.EMPTY_BYTE_STRING}getSessionToken(e){return X.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,X.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(){this.Qr=new Rt(Lt.$r),this.Ur=new Rt(Lt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Lt(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Lt(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new we(new ft([])),r=new Lt(t,e),i=new Lt(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(c=>{this.Gr(c),a.push(c.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new we(new ft([])),r=new Lt(t,e),i=new Lt(t,e+1);let a=Be();return this.Ur.forEachInRange([r,i],(c=>{a=a.add(c.key)})),a}containsKey(e){const t=new Lt(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Lt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return we.comparator(e.key,t.key)||Oe(e.Yr,t.Yr)}static Kr(e,t){return Oe(e.Yr,t.Yr)||we.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Rt(Lt.$r)}checkEmpty(e){return X.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new bx(a,t,r,i);this.mutationQueue.push(c);for(const f of i)this.Zr=this.Zr.add(new Lt(f.key,a)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return X.resolve(c)}lookupMutationBatch(e,t){return X.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return X.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return X.resolve(this.mutationQueue.length===0?Oh:this.tr-1)}getAllMutationBatches(e){return X.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Lt(t,0),i=new Lt(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(c=>{const f=this.Xr(c.Yr);a.push(f)})),X.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Rt(Oe);return t.forEach((i=>{const a=new Lt(i,0),c=new Lt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,c],(f=>{r=r.add(f.Yr)}))})),X.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;we.isDocumentKey(a)||(a=a.child(""));const c=new Lt(new we(a),0);let f=new Rt(Oe);return this.Zr.forEachWhile((m=>{const p=m.key.path;return!!r.isPrefixOf(p)&&(p.length===i&&(f=f.add(m.Yr)),!0)}),c),X.resolve(this.ti(f))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ze(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return X.forEach(t.mutations,(i=>{const a=new Lt(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Lt(t,0),i=this.Zr.firstAfterOrEqual(r);return X.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,X.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e){this.ri=e,this.docs=(function(){return new ht(we.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,c=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return X.resolve(r?r.document.mutableCopy():Xt.newInvalidDocument(t))}getEntries(e,t){let r=jr();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Xt.newInvalidDocument(i))})),X.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=jr();const c=t.path,f=new we(c.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:p,value:{document:y}}=m.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||QA(YA(y),r)<=0||(i.has(y.key)||Fc(t,y))&&(a=a.insert(y.key,y.mutableCopy()))}return X.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Se(9500)}ii(e,t){return X.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new wk(this)}getSize(e){return X.resolve(this.size)}}class wk extends mk{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),X.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e){this.persistence=e,this.si=new Uo((t=>Gh(t)),Hh),this.lastRemoteSnapshotVersion=xe.min(),this.highestTargetId=0,this.oi=0,this._i=new Yh,this.targetCount=0,this.ai=zs.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),X.resolve()}getLastRemoteSnapshotVersion(e){return X.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return X.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),X.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),X.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new zs(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,X.resolve()}updateTargetData(e,t){return this.Pr(t),X.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,X.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((c,f)=>{f.sequenceNumber<=t&&r.get(f.targetId)===null&&(this.si.delete(c),a.push(this.removeMatchingKeysForTargetId(e,f.targetId)),i++)})),X.waitFor(a).next((()=>i))}getTargetCount(e){return X.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return X.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),X.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((c=>{a.push(i.markPotentiallyOrphaned(e,c))})),X.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),X.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return X.resolve(r)}containsKey(e,t){return X.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(e,t){this.ui={},this.overlays={},this.ci=new Dc(0),this.li=!1,this.li=!0,this.hi=new Tk,this.referenceDelegate=e(this),this.Pi=new Sk(this),this.indexManager=new lk,this.remoteDocumentCache=(function(i){return new Ck(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new sk(t),this.Ii=new vk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _k,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new Ek(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){de("MemoryPersistence","Starting transaction:",e);const i=new Ik(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return X.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class Ik extends ZA{constructor(e){super(),this.currentSequenceNumber=e}}class Qh{constructor(e){this.persistence=e,this.Ri=new Yh,this.Vi=null}static mi(e){return new Qh(e)}get fi(){if(this.Vi)return this.Vi;throw Se(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),X.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),X.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),X.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return X.forEach(this.fi,(r=>{const i=we.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,xe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return X.or([()=>X.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Cc{constructor(e,t){this.persistence=e,this.pi=new Uo((r=>tx(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=pk(this,t)}static mi(e,t){return new Cc(e,t)}Ei(){}di(e){return X.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return X.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?X.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(c=>this.br(e,c,t).next((f=>{f||(r++,a.removeEntry(c,xe.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),X.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),X.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),X.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),X.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Zu(e.data.value)),t}br(e,t,r){return X.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return X.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Be(),i=Be();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Xh(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return mw()?8:jA(jt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((c=>{a.result=c})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((c=>{a.result=c}))})).next((()=>{if(a.result)return;const c=new Ak;return this.Ss(e,t,c).next((f=>{if(a.result=f,this.Vs)return this.bs(e,t,c,f.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(xs()<=Fe.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",ks(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),X.resolve()):(xs()<=Fe.DEBUG&&de("QueryEngine","Query:",ks(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(xs()<=Fe.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",ks(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Er(t))):X.resolve())}ys(e,t){if(ky(t))return X.resolve(null);let r=Er(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=jf(t,null,"F"),r=Er(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const c=Be(...a);return this.ps.getDocuments(e,c).next((f=>this.indexManager.getMinOffset(e,r).next((m=>{const p=this.Ds(t,f);return this.Cs(t,p,c,m.readTime)?this.ys(e,jf(t,null,"F")):this.vs(e,p,t,m)}))))})))))}ws(e,t,r,i){return ky(t)||i.isEqual(xe.min())?X.resolve(null):this.ps.getDocuments(e,r).next((a=>{const c=this.Ds(t,a);return this.Cs(t,c,r,i)?X.resolve(null):(xs()<=Fe.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ks(t)),this.vs(e,c,t,KA(i,sl)).next((f=>f)))}))}Ds(e,t){let r=new Rt(WT(e));return t.forEach(((i,a)=>{Fc(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return xs()<=Fe.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",ks(t)),this.ps.getDocumentsMatchingQuery(e,t,Bi.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((c=>{a=a.insert(c.key,c)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zh="LocalStore",kk=3e8;class Rk{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new ht(Oe),this.xs=new Uo((a=>Gh(a)),Hh),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yk(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Pk(n,e,t,r){return new Rk(n,e,t,r)}async function g0(n,e){const t=Re(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const c=[],f=[];let m=Be();for(const p of i){c.push(p.batchId);for(const y of p.mutations)m=m.add(y.key)}for(const p of a){f.push(p.batchId);for(const y of p.mutations)m=m.add(y.key)}return t.localDocuments.getDocuments(r,m).next((p=>({Ls:p,removedBatchIds:c,addedBatchIds:f})))}))}))}function Nk(n,e){const t=Re(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,m,p,y){const T=p.batch,C=T.keys();let A=X.resolve();return C.forEach((L=>{A=A.next((()=>y.getEntry(m,L))).next((U=>{const O=p.docVersions.get(L);Ze(O!==null,48541),U.version.compareTo(O)<0&&(T.applyToRemoteDocument(U,p),U.isValidDocument()&&(U.setReadTime(p.commitVersion),y.addEntry(U)))}))})),A.next((()=>f.mutationQueue.removeMutationBatch(m,T)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(f){let m=Be();for(let p=0;p<f.mutationResults.length;++p)f.mutationResults[p].transformResults.length>0&&(m=m.add(f.batch.mutations[p].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function y0(n){const e=Re(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Mk(n,e){const t=Re(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const c=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const f=[];e.targetChanges.forEach(((y,T)=>{const C=i.get(T);if(!C)return;f.push(t.Pi.removeMatchingKeys(a,y.removedDocuments,T).next((()=>t.Pi.addMatchingKeys(a,y.addedDocuments,T))));let A=C.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(T)!==null?A=A.withResumeToken(Ht.EMPTY_BYTE_STRING,xe.min()).withLastLimboFreeSnapshotVersion(xe.min()):y.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(y.resumeToken,r)),i=i.insert(T,A),(function(U,O,K){return U.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=kk?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(C,A,y)&&f.push(t.Pi.updateTargetData(a,A))}));let m=jr(),p=Be();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(a,y))})),f.push(Dk(a,c,e.documentUpdates).next((y=>{m=y.ks,p=y.qs}))),!r.isEqual(xe.min())){const y=t.Pi.getLastRemoteSnapshotVersion(a).next((T=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));f.push(y)}return X.waitFor(f).next((()=>c.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,m,p))).next((()=>m))})).then((a=>(t.Ms=i,a)))}function Dk(n,e,t){let r=Be(),i=Be();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let c=jr();return t.forEach(((f,m)=>{const p=a.get(f);m.isFoundDocument()!==p.isFoundDocument()&&(i=i.add(f)),m.isNoDocument()&&m.version.isEqual(xe.min())?(e.removeEntry(f,m.readTime),c=c.insert(f,m)):!p.isValidDocument()||m.version.compareTo(p.version)>0||m.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(m),c=c.insert(f,m)):de(Zh,"Ignoring outdated watch update for ",f,". Current version:",p.version," Watch version:",m.version)})),{ks:c,qs:i}}))}function Vk(n,e){const t=Re(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Oh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Lk(n,e){const t=Re(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,X.resolve(i)):t.Pi.allocateTargetId(r).next((c=>(i=new Mi(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function ih(n,e,t){const r=Re(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(c=>r.persistence.referenceDelegate.removeTarget(c,i)))}catch(c){if(!Zs(c))throw c;de(Zh,`Failed to update sequence numbers for target ${e}: ${c}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function qy(n,e,t){const r=Re(n);let i=xe.min(),a=Be();return r.persistence.runTransaction("Execute query","readwrite",(c=>(function(m,p,y){const T=Re(m),C=T.xs.get(y);return C!==void 0?X.resolve(T.Ms.get(C)):T.Pi.getTargetData(p,y)})(r,c,Er(e)).next((f=>{if(f)return i=f.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(c,f.targetId).next((m=>{a=m}))})).next((()=>r.Fs.getDocumentsMatchingQuery(c,e,t?i:xe.min(),t?a:Be()))).next((f=>(bk(r,Ex(e),f),{documents:f,Qs:a})))))}function bk(n,e,t){let r=n.Os.get(e)||xe.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}class Gy{constructor(){this.activeTargetIds=xx()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Uk{constructor(){this.Mo=new Gy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Gy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="ConnectivityMonitor";class $y{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){de(Hy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){de(Hy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $u=null;function oh(){return $u===null?$u=(function(){return 268435456+Math.round(2147483648*Math.random())})():$u++,"0x"+$u.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf="RestConnection",Ok={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Bk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===mc?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const c=oh(),f=this.zo(e,t.toUriEncodedString());de(Lf,`Sending RPC '${e}' ${c}:`,f,r);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,i,a);const{host:p}=new URL(f),y=Js(p);return this.Jo(e,f,m,r,y).then((T=>(de(Lf,`Received RPC '${e}' ${c}: `,T),T)),(T=>{throw qs(Lf,`RPC '${e}' ${c} failed with error: `,T,"url: ",f,"request:",r),T}))}Ho(e,t,r,i,a,c){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Qs})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=Ok[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class Gk extends Bk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const c=oh();return new Promise(((f,m)=>{const p=new ET;p.setWithCredentials(!0),p.listenOnce(CT.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Xu.NO_ERROR:const T=p.getResponseJson();de(Yt,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(T)),f(T);break;case Xu.TIMEOUT:de(Yt,`RPC '${e}' ${c} timed out`),m(new Te(te.DEADLINE_EXCEEDED,"Request time out"));break;case Xu.HTTP_ERROR:const C=p.getStatus();if(de(Yt,`RPC '${e}' ${c} failed with status:`,C,"response text:",p.getResponseText()),C>0){let A=p.getResponseJson();Array.isArray(A)&&(A=A[0]);const L=A?.error;if(L&&L.status&&L.message){const U=(function(K){const W=K.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(W)>=0?W:te.UNKNOWN})(L.status);m(new Te(U,L.message))}else m(new Te(te.UNKNOWN,"Server responded with status "+p.getStatus()))}else m(new Te(te.UNAVAILABLE,"Connection failed."));break;default:Se(9055,{l_:e,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{de(Yt,`RPC '${e}' ${c} completed.`)}}));const y=JSON.stringify(i);de(Yt,`RPC '${e}' ${c} sending request:`,i),p.send(t,"POST",y,r,15)}))}T_(e,t,r){const i=oh(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=IT(),f=ST(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(m.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,t,r),m.encodeInitMessageHeaders=!0;const y=a.join("");de(Yt,`Creating RPC '${e}' stream ${i}: ${y}`,m);const T=c.createWebChannel(y,m);this.I_(T);let C=!1,A=!1;const L=new qk({Yo:O=>{A?de(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,O):(C||(de(Yt,`Opening RPC '${e}' stream ${i} transport.`),T.open(),C=!0),de(Yt,`RPC '${e}' stream ${i} sending:`,O),T.send(O))},Zo:()=>T.close()}),U=(O,K,W)=>{O.listen(K,(Y=>{try{W(Y)}catch(re){setTimeout((()=>{throw re}),0)}}))};return U(T,$a.EventType.OPEN,(()=>{A||(de(Yt,`RPC '${e}' stream ${i} transport opened.`),L.o_())})),U(T,$a.EventType.CLOSE,(()=>{A||(A=!0,de(Yt,`RPC '${e}' stream ${i} transport closed`),L.a_(),this.E_(T))})),U(T,$a.EventType.ERROR,(O=>{A||(A=!0,qs(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,O.name,"Message:",O.message),L.a_(new Te(te.UNAVAILABLE,"The operation could not be completed")))})),U(T,$a.EventType.MESSAGE,(O=>{if(!A){const K=O.data[0];Ze(!!K,16349);const W=K,Y=W?.error||W[0]?.error;if(Y){de(Yt,`RPC '${e}' stream ${i} received error:`,Y);const re=Y.status;let le=(function(k){const x=wt[k];if(x!==void 0)return i0(x)})(re),Z=Y.message;le===void 0&&(le=te.INTERNAL,Z="Unknown error status: "+re+" with message "+Y.message),A=!0,L.a_(new Te(le,Z)),T.close()}else de(Yt,`RPC '${e}' stream ${i} received:`,K),L.u_(K)}})),U(f,wT.STAT_EVENT,(O=>{O.stat===Jf.PROXY?de(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):O.stat===Jf.NOPROXY&&de(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{L.__()}),0),L}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function bf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(n){return new Wx(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&de("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy="PersistentStream";class _0{constructor(e,t,r,i,a,c,f,m){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new v0(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===te.RESOURCE_EXHAUSTED?(Zr(t.toString()),Zr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Te(te.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return de(zy,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(de(zy,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Hk extends _0{constructor(e,t,r,i,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,c),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Yx(this.serializer,e),r=(function(a){if(!("targetChange"in a))return xe.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?xe.min():c.readTime?Cr(c.readTime):xe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=rh(this.serializer),t.addTarget=(function(a,c){let f;const m=c.target;if(f=Zf(m)?{documents:Zx(a,m)}:{query:jx(a,m).ft},f.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){f.resumeToken=a0(a,c.resumeToken);const p=eh(a,c.expectedCount);p!==null&&(f.expectedCount=p)}else if(c.snapshotVersion.compareTo(xe.min())>0){f.readTime=Ec(a,c.snapshotVersion.toTimestamp());const p=eh(a,c.expectedCount);p!==null&&(f.expectedCount=p)}return f})(this.serializer,e);const r=tk(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=rh(this.serializer),t.removeTarget=e,this.q_(t)}}class $k extends _0{constructor(e,t,r,i,a,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,c),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Xx(e.writeResults,e.commitTime),r=Cr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=rh(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Qx(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{}class Wk extends zk{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Te(te.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Go(e,th(t,r),i,a,c))).catch((a=>{throw a.name==="FirebaseError"?(a.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Te(te.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,f])=>this.connection.Ho(e,th(t,r),i,c,f,a))).catch((c=>{throw c.name==="FirebaseError"?(c.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Te(te.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Jk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zr(t),this.aa=!1):de("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vo="RemoteStore";class Kk{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((c=>{r.enqueueAndForget((async()=>{Oo(this)&&(de(Vo,"Restarting streams for network reachability change."),await(async function(m){const p=Re(m);p.Ea.add(4),await El(p),p.Ra.set("Unknown"),p.Ea.delete(4),await Hc(p)})(this))}))})),this.Ra=new Jk(r,i)}}async function Hc(n){if(Oo(n))for(const e of n.da)await e(!0)}async function El(n){for(const e of n.da)await e(!1)}function T0(n,e){const t=Re(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),np(t)?tp(t):js(t).O_()&&ep(t,e))}function jh(n,e){const t=Re(n),r=js(t);t.Ia.delete(e),r.O_()&&E0(t,e),t.Ia.size===0&&(r.O_()?r.L_():Oo(t)&&t.Ra.set("Unknown"))}function ep(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}js(n).Y_(e)}function E0(n,e){n.Va.Ue(e),js(n).Z_(e)}function tp(n){n.Va=new Gx({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),js(n).start(),n.Ra.ua()}function np(n){return Oo(n)&&!js(n).x_()&&n.Ia.size>0}function Oo(n){return Re(n).Ea.size===0}function C0(n){n.Va=void 0}async function Yk(n){n.Ra.set("Online")}async function Qk(n){n.Ia.forEach(((e,t)=>{ep(n,e)}))}async function Xk(n,e){C0(n),np(n)?(n.Ra.ha(e),tp(n)):n.Ra.set("Unknown")}async function Zk(n,e,t){if(n.Ra.set("Online"),e instanceof s0&&e.state===2&&e.cause)try{await(async function(i,a){const c=a.cause;for(const f of a.targetIds)i.Ia.has(f)&&(await i.remoteSyncer.rejectListen(f,c),i.Ia.delete(f),i.Va.removeTarget(f))})(n,e)}catch(r){de(Vo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await wc(n,r)}else if(e instanceof tc?n.Va.Ze(e):e instanceof o0?n.Va.st(e):n.Va.tt(e),!t.isEqual(xe.min()))try{const r=await y0(n.localStore);t.compareTo(r)>=0&&await(function(a,c){const f=a.Va.Tt(c);return f.targetChanges.forEach(((m,p)=>{if(m.resumeToken.approximateByteSize()>0){const y=a.Ia.get(p);y&&a.Ia.set(p,y.withResumeToken(m.resumeToken,c))}})),f.targetMismatches.forEach(((m,p)=>{const y=a.Ia.get(m);if(!y)return;a.Ia.set(m,y.withResumeToken(Ht.EMPTY_BYTE_STRING,y.snapshotVersion)),E0(a,m);const T=new Mi(y.target,m,p,y.sequenceNumber);ep(a,T)})),a.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(r){de(Vo,"Failed to raise snapshot:",r),await wc(n,r)}}async function wc(n,e,t){if(!Zs(e))throw e;n.Ea.add(1),await El(n),n.Ra.set("Offline"),t||(t=()=>y0(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{de(Vo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Hc(n)}))}function w0(n,e){return e().catch((t=>wc(n,t,e)))}async function $c(n){const e=Re(n),t=$i(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Oh;for(;jk(e);)try{const i=await Vk(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,eR(e,i)}catch(i){await wc(e,i)}S0(e)&&I0(e)}function jk(n){return Oo(n)&&n.Ta.length<10}function eR(n,e){n.Ta.push(e);const t=$i(n);t.O_()&&t.X_&&t.ea(e.mutations)}function S0(n){return Oo(n)&&!$i(n).x_()&&n.Ta.length>0}function I0(n){$i(n).start()}async function tR(n){$i(n).ra()}async function nR(n){const e=$i(n);for(const t of n.Ta)e.ea(t.mutations)}async function rR(n,e,t){const r=n.Ta.shift(),i=Wh.from(r,e,t);await w0(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await $c(n)}async function iR(n,e){e&&$i(n).X_&&await(async function(r,i){if((function(c){return Ox(c)&&c!==te.ABORTED})(i.code)){const a=r.Ta.shift();$i(r).B_(),await w0(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await $c(r)}})(n,e),S0(n)&&I0(n)}async function Wy(n,e){const t=Re(n);t.asyncQueue.verifyOperationInProgress(),de(Vo,"RemoteStore received new credentials");const r=Oo(t);t.Ea.add(3),await El(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Hc(t)}async function oR(n,e){const t=Re(n);e?(t.Ea.delete(2),await Hc(t)):e||(t.Ea.add(2),await El(t),t.Ra.set("Unknown"))}function js(n){return n.ma||(n.ma=(function(t,r,i){const a=Re(t);return a.sa(),new Hk(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:Yk.bind(null,n),t_:Qk.bind(null,n),r_:Xk.bind(null,n),H_:Zk.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),np(n)?tp(n):n.Ra.set("Unknown")):(await n.ma.stop(),C0(n))}))),n.ma}function $i(n){return n.fa||(n.fa=(function(t,r,i){const a=Re(t);return a.sa(),new $k(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:tR.bind(null,n),r_:iR.bind(null,n),ta:nR.bind(null,n),na:rR.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await $c(n)):(await n.fa.stop(),n.Ta.length>0&&(de(Vo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Oi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const c=Date.now()+r,f=new rp(e,t,c,i,a);return f.start(r),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ip(n,e){if(Zr("AsyncQueue",`${e}: ${n}`),Zs(n))return new Te(te.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{static emptySet(e){return new Ls(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||we.comparator(t.key,r.key):(t,r)=>we.comparator(t.key,r.key),this.keyedMap=za(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ls)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Ls;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(){this.ga=new ht(we.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Se(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Ws{constructor(e,t,r,i,a,c,f,m,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,i,a){const c=[];return t.forEach((f=>{c.push({type:0,doc:f})})),new Ws(e,t,Ls.emptySet(t),c,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class aR{constructor(){this.queries=Ky(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Re(t),a=i.queries;i.queries=Ky(),a.forEach(((c,f)=>{for(const m of f.Sa)m.onError(r)}))})(this,new Te(te.ABORTED,"Firestore shutting down"))}}function Ky(){return new Uo((n=>zT(n)),Uc)}async function lR(n,e){const t=Re(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new sR,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(c){const f=ip(c,`Initialization of query '${ks(e.query)}' failed`);return void e.onError(f)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&op(t)}async function uR(n,e){const t=Re(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const c=a.Sa.indexOf(e);c>=0&&(a.Sa.splice(c,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function cR(n,e){const t=Re(n);let r=!1;for(const i of e){const a=i.query,c=t.queries.get(a);if(c){for(const f of c.Sa)f.Fa(i)&&(r=!0);c.wa=i}}r&&op(t)}function dR(n,e,t){const r=Re(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function op(n){n.Ca.forEach((e=>{e.next()}))}var sh,Yy;(Yy=sh||(sh={})).Ma="default",Yy.Cache="cache";class fR{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ws(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ws.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e){this.key=e}}class x0{constructor(e){this.key=e}}class hR{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Be(),this.mutatedKeys=Be(),this.eu=WT(e),this.tu=new Ls(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Jy,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,c=i,f=!1;const m=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,p=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((y,T)=>{const C=i.get(y),A=Fc(this.query,T)?T:null,L=!!C&&this.mutatedKeys.has(C.key),U=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let O=!1;C&&A?C.data.isEqual(A.data)?L!==U&&(r.track({type:3,doc:A}),O=!0):this.su(C,A)||(r.track({type:2,doc:A}),O=!0,(m&&this.eu(A,m)>0||p&&this.eu(A,p)<0)&&(f=!0)):!C&&A?(r.track({type:0,doc:A}),O=!0):C&&!A&&(r.track({type:1,doc:C}),O=!0,(m||p)&&(f=!0)),O&&(A?(c=c.add(A),a=U?a.add(y):a.delete(y)):(c=c.delete(y),a=a.delete(y)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const y=this.query.limitType==="F"?c.last():c.first();c=c.delete(y.key),a=a.delete(y.key),r.track({type:1,doc:y})}return{tu:c,iu:r,Cs:f,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((y,T)=>(function(A,L){const U=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se(20277,{Rt:O})}};return U(A)-U(L)})(y.type,T.type)||this.eu(y.doc,T.doc))),this.ou(r),i=i??!1;const f=t&&!i?this._u():[],m=this.Xa.size===0&&this.current&&!i?1:0,p=m!==this.Za;return this.Za=m,c.length!==0||p?{snapshot:new Ws(this.query,e.tu,a,c,e.mutatedKeys,m===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Jy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Be(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new x0(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new A0(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Be();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ws.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sp="SyncEngine";class pR{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class mR{constructor(e){this.key=e,this.hu=!1}}class gR{constructor(e,t,r,i,a,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Uo((f=>zT(f)),Uc),this.Iu=new Map,this.Eu=new Set,this.du=new ht(we.comparator),this.Au=new Map,this.Ru=new Yh,this.Vu={},this.mu=new Map,this.fu=zs.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function yR(n,e,t=!0){const r=D0(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await k0(r,e,t,!0),i}async function vR(n,e){const t=D0(n);await k0(t,e,!0,!1)}async function k0(n,e,t,r){const i=await Lk(n.localStore,Er(e)),a=i.targetId,c=n.sharedClientState.addLocalQueryTarget(a,t);let f;return r&&(f=await _R(n,e,a,c==="current",i.resumeToken)),n.isPrimaryClient&&t&&T0(n.remoteStore,i),f}async function _R(n,e,t,r,i){n.pu=(T,C,A)=>(async function(U,O,K,W){let Y=O.view.ru(K);Y.Cs&&(Y=await qy(U.localStore,O.query,!1).then((({documents:D})=>O.view.ru(D,Y))));const re=W&&W.targetChanges.get(O.targetId),le=W&&W.targetMismatches.get(O.targetId)!=null,Z=O.view.applyChanges(Y,U.isPrimaryClient,re,le);return Xy(U,O.targetId,Z.au),Z.snapshot})(n,T,C,A);const a=await qy(n.localStore,e,!0),c=new hR(e,a.Qs),f=c.ru(a.documents),m=Tl.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),p=c.applyChanges(f,n.isPrimaryClient,m);Xy(n,t,p.au);const y=new pR(e,t,c);return n.Tu.set(e,y),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function TR(n,e,t){const r=Re(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((c=>!Uc(c,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ih(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&jh(r.remoteStore,i.targetId),ah(r,i.targetId)})).catch(Xs)):(ah(r,i.targetId),await ih(r.localStore,i.targetId,!0))}async function ER(n,e){const t=Re(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),jh(t.remoteStore,r.targetId))}async function CR(n,e,t){const r=RR(n);try{const i=await(function(c,f){const m=Re(c),p=st.now(),y=f.reduce(((A,L)=>A.add(L.key)),Be());let T,C;return m.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let L=jr(),U=Be();return m.Ns.getEntries(A,y).next((O=>{L=O,L.forEach(((K,W)=>{W.isValidDocument()||(U=U.add(K))}))})).next((()=>m.localDocuments.getOverlayedDocuments(A,L))).next((O=>{T=O;const K=[];for(const W of f){const Y=Vx(W,T.get(W.key).overlayedDocument);Y!=null&&K.push(new Fo(W.key,Y,FT(Y.value.mapValue),Yr.exists(!0)))}return m.mutationQueue.addMutationBatch(A,p,K,f)})).next((O=>{C=O;const K=O.applyToLocalDocumentSet(T,U);return m.documentOverlayCache.saveOverlays(A,O.batchId,K)}))})).then((()=>({batchId:C.batchId,changes:KT(T)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(c,f,m){let p=c.Vu[c.currentUser.toKey()];p||(p=new ht(Oe)),p=p.insert(f,m),c.Vu[c.currentUser.toKey()]=p})(r,i.batchId,t),await Cl(r,i.changes),await $c(r.remoteStore)}catch(i){const a=ip(i,"Failed to persist write");t.reject(a)}}async function R0(n,e){const t=Re(n);try{const r=await Mk(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const c=t.Au.get(a);c&&(Ze(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?c.hu=!0:i.modifiedDocuments.size>0?Ze(c.hu,14607):i.removedDocuments.size>0&&(Ze(c.hu,42227),c.hu=!1))})),await Cl(t,r,e)}catch(r){await Xs(r)}}function Qy(n,e,t){const r=Re(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,c)=>{const f=c.view.va(e);f.snapshot&&i.push(f.snapshot)})),(function(c,f){const m=Re(c);m.onlineState=f;let p=!1;m.queries.forEach(((y,T)=>{for(const C of T.Sa)C.va(f)&&(p=!0)})),p&&op(m)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wR(n,e,t){const r=Re(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let c=new ht(we.comparator);c=c.insert(a,Xt.newNoDocument(a,xe.min()));const f=Be().add(a),m=new qc(xe.min(),new Map,new ht(Oe),c,f);await R0(r,m),r.du=r.du.remove(a),r.Au.delete(e),ap(r)}else await ih(r.localStore,e,!1).then((()=>ah(r,e,t))).catch(Xs)}async function SR(n,e){const t=Re(n),r=e.batch.batchId;try{const i=await Nk(t.localStore,e);N0(t,r,null),P0(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Cl(t,i)}catch(i){await Xs(i)}}async function IR(n,e,t){const r=Re(n);try{const i=await(function(c,f){const m=Re(c);return m.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let y;return m.mutationQueue.lookupMutationBatch(p,f).next((T=>(Ze(T!==null,37113),y=T.keys(),m.mutationQueue.removeMutationBatch(p,T)))).next((()=>m.mutationQueue.performConsistencyCheck(p))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(p,y,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,y))).next((()=>m.localDocuments.getDocuments(p,y)))}))})(r.localStore,e);N0(r,e,t),P0(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Cl(r,i)}catch(i){await Xs(i)}}function P0(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function N0(n,e,t){const r=Re(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function ah(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||M0(n,r)}))}function M0(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(jh(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),ap(n))}function Xy(n,e,t){for(const r of t)r instanceof A0?(n.Ru.addReference(r.key,e),AR(n,r)):r instanceof x0?(de(sp,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||M0(n,r.key)):Se(19791,{wu:r})}function AR(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(de(sp,"New document in limbo: "+t),n.Eu.add(r),ap(n))}function ap(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new we(ft.fromString(e)),r=n.fu.next();n.Au.set(r,new mR(t)),n.du=n.du.insert(t,r),T0(n.remoteStore,new Mi(Er($h(t.path)),r,"TargetPurposeLimboResolution",Dc.ce))}}async function Cl(n,e,t){const r=Re(n),i=[],a=[],c=[];r.Tu.isEmpty()||(r.Tu.forEach(((f,m)=>{c.push(r.pu(m,e,t).then((p=>{if((p||t)&&r.isPrimaryClient){const y=p?!p.fromCache:t?.targetChanges.get(m.targetId)?.current;r.sharedClientState.updateQueryState(m.targetId,y?"current":"not-current")}if(p){i.push(p);const y=Xh.As(m.targetId,p);a.push(y)}})))})),await Promise.all(c),r.Pu.H_(i),await(async function(m,p){const y=Re(m);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>X.forEach(p,(C=>X.forEach(C.Es,(A=>y.persistence.referenceDelegate.addReference(T,C.targetId,A))).next((()=>X.forEach(C.ds,(A=>y.persistence.referenceDelegate.removeReference(T,C.targetId,A)))))))))}catch(T){if(!Zs(T))throw T;de(Zh,"Failed to update sequence numbers: "+T)}for(const T of p){const C=T.targetId;if(!T.fromCache){const A=y.Ms.get(C),L=A.snapshotVersion,U=A.withLastLimboFreeSnapshotVersion(L);y.Ms=y.Ms.insert(C,U)}}})(r.localStore,a))}async function xR(n,e){const t=Re(n);if(!t.currentUser.isEqual(e)){de(sp,"User change. New user:",e.toKey());const r=await g0(t.localStore,e);t.currentUser=e,(function(a,c){a.mu.forEach((f=>{f.forEach((m=>{m.reject(new Te(te.CANCELLED,c))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Cl(t,r.Ls)}}function kR(n,e){const t=Re(n),r=t.Au.get(e);if(r&&r.hu)return Be().add(r.key);{let i=Be();const a=t.Iu.get(e);if(!a)return i;for(const c of a){const f=t.Tu.get(c);i=i.unionWith(f.view.nu)}return i}}function D0(n){const e=Re(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=R0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wR.bind(null,e),e.Pu.H_=cR.bind(null,e.eventManager),e.Pu.yu=dR.bind(null,e.eventManager),e}function RR(n){const e=Re(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IR.bind(null,e),e}class Sc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Pk(this.persistence,new xk,e.initialUser,this.serializer)}Cu(e){return new m0(Qh.mi,this.serializer)}Du(e){return new Uk}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sc.provider={build:()=>new Sc};class PR extends Sc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ze(this.persistence.referenceDelegate instanceof Cc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new fk(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new m0((r=>Cc.mi(r,t)),this.serializer)}}class lh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Qy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=xR.bind(null,this.syncEngine),await oR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new aR})()}createDatastore(e){const t=Gc(e.databaseInfo.databaseId),r=(function(a){return new Gk(a)})(e.databaseInfo);return(function(a,c,f,m){return new Wk(a,c,f,m)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,c,f){return new Kk(r,i,a,c,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Qy(this.syncEngine,t,0)),(function(){return $y.v()?new $y:new Fk})())}createSyncEngine(e,t){return(function(i,a,c,f,m,p,y){const T=new gR(i,a,c,f,m,p);return y&&(T.gu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Re(t);de(Vo,"RemoteStore shutting down."),r.Ea.add(5),await El(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}lh.provider={build:()=>new lh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi="FirestoreClient";class MR{constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Qt.UNAUTHENTICATED,this.clientId=Uh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async c=>{de(zi,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,(c=>(de(zi,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Oi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=ip(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Uf(n,e){n.asyncQueue.verifyOperationInProgress(),de(zi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await g0(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Zy(n,e){n.asyncQueue.verifyOperationInProgress();const t=await DR(n);de(zi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>Wy(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>Wy(e.remoteStore,i))),n._onlineComponents=e}async function DR(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){de(zi,"Using user provided OfflineComponentProvider");try{await Uf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===te.FAILED_PRECONDITION||i.code===te.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;qs("Error using user provided cache. Falling back to memory cache: "+t),await Uf(n,new Sc)}}else de(zi,"Using default OfflineComponentProvider"),await Uf(n,new PR(void 0));return n._offlineComponents}async function V0(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(de(zi,"Using user provided OnlineComponentProvider"),await Zy(n,n._uninitializedComponentsProvider._online)):(de(zi,"Using default OnlineComponentProvider"),await Zy(n,new lh))),n._onlineComponents}function VR(n){return V0(n).then((e=>e.syncEngine))}async function LR(n){const e=await V0(n),t=e.eventManager;return t.onListen=yR.bind(null,e.syncEngine),t.onUnlisten=TR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=vR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ER.bind(null,e.syncEngine),t}function bR(n,e,t={}){const r=new Oi;return n.asyncQueue.enqueueAndForget((async()=>(function(a,c,f,m,p){const y=new NR({next:C=>{y.Nu(),c.enqueueAndForget((()=>uR(a,T)));const A=C.docs.has(f);!A&&C.fromCache?p.reject(new Te(te.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&C.fromCache&&m&&m.source==="server"?p.reject(new Te(te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(C)},error:C=>p.reject(C)}),T=new fR($h(f.path),y,{includeMetadataChanges:!0,qa:!0});return lR(a,T)})(await LR(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0="firestore.googleapis.com",ev=!0;class tv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=b0,this.ssl=ev}else this.host=e.host,this.ssl=e.ssl??ev;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=p0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ck)throw new Te(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=L0(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Te(te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Te(te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Te(te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lp{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new bA;switch(r.type){case"firstParty":return new BA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Te(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=jy.get(t);r&&(de("ComponentProvider","Removing Datastore"),jy.delete(t),r.terminate())})(this),Promise.resolve()}}function UR(n,e,t,r={}){n=ol(n,lp);const i=Js(e),a=n._getSettings(),c={...a,emulatorOptions:n._getEmulatorOptions()},f=`${e}:${t}`;i&&(b_(`https://${f}`),U_("Firestore",!0)),a.host!==b0&&a.host!==f&&qs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...a,host:f,ssl:i,emulatorOptions:r};if(!Po(m,c)&&(n._setSettings(m),r.mockUserToken)){let p,y;if(typeof r.mockUserToken=="string")p=r.mockUserToken,y=Qt.MOCK_USER;else{p=sw(r.mockUserToken,n._app?.options.projectId);const T=r.mockUserToken.sub||r.mockUserToken.user_id;if(!T)throw new Te(te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Qt(T)}n._authCredentials=new UA(new xT(p,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new up(this.firestore,e,this._query)}}class bt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bt(this.firestore,e,this._key)}toJSON(){return{type:bt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(vl(t,bt._jsonSchema))return new bt(e,r||null,new we(ft.fromString(t.referencePath)))}}bt._jsonSchemaVersion="firestore/documentReference/1.0",bt._jsonSchema={type:St("string",bt._jsonSchemaVersion),referencePath:St("string")};class fl extends up{constructor(e,t,r){super(e,t,$h(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bt(this.firestore,null,new we(e))}withConverter(e){return new fl(this.firestore,e,this._path)}}function U0(n,e,...t){if(n=Ln(n),arguments.length===1&&(e=Uh.newId()),WA("doc","path",e),n instanceof lp){const r=ft.fromString(e,...t);return my(r),new bt(n,null,new we(r))}{if(!(n instanceof bt||n instanceof fl))throw new Te(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ft.fromString(e,...t));return my(r),new bt(n.firestore,n instanceof fl?n.converter:null,new we(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nv="AsyncQueue";class rv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new v0(this,"async_queue_retry"),this._c=()=>{const r=bf();r&&de(nv,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=bf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=bf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Oi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Zs(e))throw e;de(nv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Zr("INTERNAL UNHANDLED ERROR: ",iv(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=rp.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Se(47125,{Pc:iv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function iv(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class cp extends lp{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new rv,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rv(e),this._firestoreClient=void 0,await e}}}function FR(n,e){const t=typeof n=="object"?n:q_(),r=typeof n=="string"?n:mc,i=Ih(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=iw("firestore");a&&UR(i,...a)}return i}function F0(n){if(n._terminated)throw new Te(te.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||OR(n),n._firestoreClient}function OR(n){const e=n._freezeSettings(),t=(function(i,a,c,f){return new ix(i,a,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,L0(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new MR(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dn(Ht.fromBase64String(e))}catch(t){throw new Te(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Dn(Ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Dn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vl(e,Dn._jsonSchema))return Dn.fromBase64String(e.bytes)}}Dn._jsonSchemaVersion="firestore/bytes/1.0",Dn._jsonSchema={type:St("string",Dn._jsonSchemaVersion),bytes:St("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Te(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Oe(this._lat,e._lat)||Oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:wr._jsonSchemaVersion}}static fromJSON(e){if(vl(e,wr._jsonSchema))return new wr(e.latitude,e.longitude)}}wr._jsonSchemaVersion="firestore/geoPoint/1.0",wr._jsonSchema={type:St("string",wr._jsonSchemaVersion),latitude:St("number"),longitude:St("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Sr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vl(e,Sr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Sr(e.vectorValues);throw new Te(te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Sr._jsonSchemaVersion="firestore/vectorValue/1.0",Sr._jsonSchema={type:St("string",Sr._jsonSchemaVersion),vectorValues:St("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR=/^__.*__$/;class qR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Fo(e,this.data,this.fieldMask,t,this.fieldTransforms):new _l(e,this.data,t,this.fieldTransforms)}}function B0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se(40011,{Ac:n})}}class fp{constructor(e,t,r,i,a,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new fp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ic(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(B0(this.Ac)&&BR.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class GR{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Gc(e)}Cc(e,t,r,i=!1){return new fp({Ac:e,methodName:t,Dc:r,path:Gt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function HR(n){const e=n._freezeSettings(),t=Gc(n._databaseId);return new GR(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $R(n,e,t,r,i,a={}){const c=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);$0("Data must be an object, but it was:",c,r);const f=G0(r,c);let m,p;if(a.merge)m=new nr(c.fieldMask),p=c.fieldTransforms;else if(a.mergeFields){const y=[];for(const T of a.mergeFields){const C=zR(e,T,t);if(!c.contains(C))throw new Te(te.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);JR(y,C)||y.push(C)}m=new nr(y),p=c.fieldTransforms.filter((T=>m.covers(T.field)))}else m=null,p=c.fieldTransforms;return new qR(new Mn(f),m,p)}function q0(n,e){if(H0(n=Ln(n)))return $0("Unsupported field value:",e,n),G0(n,e);if(n instanceof O0)return(function(r,i){if(!B0(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let c=0;for(const f of r){let m=q0(f,i.wc(c));m==null&&(m={nullValue:"NULL_VALUE"}),a.push(m),c++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=Ln(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kx(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=st.fromDate(r);return{timestampValue:Ec(i.serializer,a)}}if(r instanceof st){const a=new st(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ec(i.serializer,a)}}if(r instanceof wr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Dn)return{bytesValue:a0(i.serializer,r._byteString)};if(r instanceof bt){const a=i.databaseId,c=r.firestore._databaseId;if(!c.isEqual(a))throw i.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Kh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Sr)return(function(c,f){return{mapValue:{fields:{[bT]:{stringValue:UT},[gc]:{arrayValue:{values:c.toArray().map((p=>{if(typeof p!="number")throw f.Sc("VectorValues must only contain numeric values.");return zh(f.serializer,p)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Fh(r)}`)})(n,e)}function G0(n,e){const t={};return PT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bo(n,((r,i)=>{const a=q0(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function H0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof st||n instanceof wr||n instanceof Dn||n instanceof bt||n instanceof O0||n instanceof Sr)}function $0(n,e,t){if(!H0(t)||!kT(t)){const r=Fh(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function zR(n,e,t){if((e=Ln(e))instanceof dp)return e._internalPath;if(typeof e=="string")return z0(n,e);throw Ic("Field path arguments must be of type string or ",n,!1,void 0,t)}const WR=new RegExp("[~\\*/\\[\\]]");function z0(n,e,t){if(e.search(WR)>=0)throw Ic(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new dp(...e.split("."))._internalPath}catch{throw Ic(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ic(n,e,t,r,i){const a=r&&!r.isEmpty(),c=i!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(a||c)&&(m+=" (found",a&&(m+=` in field ${r}`),c&&(m+=` in document ${i}`),m+=")"),new Te(te.INVALID_ARGUMENT,f+n+m)}function JR(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new KR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(J0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class KR extends W0{data(){return super.data()}}function J0(n,e){return typeof e=="string"?z0(n,e):e instanceof dp?e._internalPath:e._delegate._internalPath}class YR{convertValue(e,t="none"){switch(Hi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Se(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return bo(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[gc].arrayValue?.values?.map((r=>_t(r.doubleValue)));return new Sr(t)}convertGeoPoint(e){return new wr(_t(e.latitude),_t(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Lc(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(al(e));default:return null}}convertTimestamp(e){const t=qi(e);return new st(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ft.fromString(e);Ze(h0(r),9688,{name:e});const i=new ll(r.get(1),r.get(3)),a=new we(r.popFirst(5));return i.isEqual(t)||Zr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class Ja{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ro extends W0{constructor(e,t,r,i,a,c){super(e,t,r,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new nc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(J0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ro._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ro._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ro._jsonSchema={type:St("string",Ro._jsonSchemaVersion),bundleSource:St("string","DocumentSnapshot"),bundleName:St("string"),bundle:St("string")};class nc extends Ro{data(e={}){return super.data(e)}}class el{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ja(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new nc(this._firestore,this._userDataWriter,r.key,r,new Ja(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let c=0;return i._snapshot.docChanges.map((f=>{const m=new nc(i._firestore,i._userDataWriter,f.doc.key,f.doc,new Ja(i._snapshot.mutatedKeys.has(f.doc.key),i._snapshot.fromCache),i.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:c++}}))}{let c=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((f=>a||f.type!==3)).map((f=>{const m=new nc(i._firestore,i._userDataWriter,f.doc.key,f.doc,new Ja(i._snapshot.mutatedKeys.has(f.doc.key),i._snapshot.fromCache),i.query.converter);let p=-1,y=-1;return f.type!==0&&(p=c.indexOf(f.doc.key),c=c.delete(f.doc.key)),f.type!==1&&(c=c.add(f.doc),y=c.indexOf(f.doc.key)),{type:XR(f.type),doc:m,oldIndex:p,newIndex:y}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=el._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Uh.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function XR(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(n){n=ol(n,bt);const e=ol(n.firestore,cp);return bR(F0(e),n._key).then((t=>nP(e,n,t)))}el._jsonSchemaVersion="firestore/querySnapshot/1.0",el._jsonSchema={type:St("string",el._jsonSchemaVersion),bundleSource:St("string","QuerySnapshot"),bundleName:St("string"),bundle:St("string")};class jR extends YR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bt(this.firestore,null,t)}}function eP(n,e,t){n=ol(n,bt);const r=ol(n.firestore,cp),i=QR(n.converter,e);return tP(r,[$R(HR(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Yr.none())])}function tP(n,e){return(function(r,i){const a=new Oi;return r.asyncQueue.enqueueAndForget((async()=>CR(await VR(r),i,a))),a.promise})(F0(n),e)}function nP(n,e,t){const r=t.docs.get(e._key),i=new jR(n);return new Ro(n,i,e._key,r,new Ja(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Qs=i})(Ks),Os(new No("firestore",((r,{instanceIdentifier:i,options:a})=>{const c=r.getProvider("app").getImmediate(),f=new cp(new FA(r.getProvider("auth-internal")),new qA(c,r.getProvider("app-check-internal")),(function(p,y){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Te(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ll(p.options.projectId,y)})(c,i),c);return a={useFetchStreams:t,...a},f._setSettings(a),f}),"PUBLIC").setMultipleInstances(!0)),Ui(dy,fy,e),Ui(dy,fy,"esm2020")})();const uh={apiKey:"AIzaSyBQPhgF-vn3-4_zcjfVPo5igOzX8NkKKt8",authDomain:"tablit-b6e78.firebaseapp.com",projectId:"tablit-b6e78",storageBucket:"tablit-b6e78.appspot.com",messagingSenderId:"993416386108",appId:"1:993416386108:web:1e6d42be34beb6a8efd539",measurementId:"G-YJP77FD8GZ"},K0=B_(uh),hp=VA(K0),Y0=FR(K0),Q0=new Wr;Q0.setCustomParameters({prompt:"select_account"});const X0=n=>({uid:n.uid,displayName:n.displayName,photoURL:n.photoURL}),rP=n=>{const e={};return Array.isArray(n)&&n.forEach((t,r)=>{Array.isArray(t)&&t.forEach((i,a)=>{i&&i.length>0&&(e[`${r}-${a}`]=i)})}),e},iP=(n,e)=>{const r=e.periods||7,i=Array(7).fill(0).map(()=>Array(r).fill(0).map(()=>[]));if(!n)return i;for(const a in n){const[c,f]=a.split("-").map(Number);c<7&&f<r&&(i[c][f]=n[a])}return i},Z0=(n,e)=>{throw console.error(`Firestore ${e} Error:`,n),n instanceof ir&&(n.code==="permission-denied"?alert(`Firestore アクセス権限エラー (permission-denied)

データベースへのアクセスが拒否されました。
これは、Firestoreのセキュリティルールが原因で、ログイン中のユーザーにデータの読み書きが許可されていないことを意味します。

--- 解決手順：セキュリティルールの更新 ---

✅ 1. Firebaseコンソールを開きます: https://console.firebase.google.com/
✅ 2. あなたのプロジェクト (${uh.projectId}) を選択 > 左側のメニューから「Firestore Database」をクリックします。
✅ 3. 上部にある「ルール」タブを選択します。
✅ 4. エディタに表示されている既存のルールをすべて削除し、以下のルールに置き換えてください:

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      // ログインしているユーザーは、自分のデータのみ読み書きできます。
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}

✅ 5. 「公開」ボタンをクリックして、新しいルールを保存します。

このルールは、「ログインしているユーザーは、自分自身のデータ（ドキュメント）のみを読み書きできる」というもので、安全なデータアクセスの基本です。

ルールを更新後、アプリケーションをリロードしてください。`):(n.code==="unavailable"||n.message.includes("offline")||n.message.includes("Failed to get document"))&&alert(`Firestore 接続エラー

データベースとの通信に失敗しました。
これは多くの場合、FirebaseプロジェクトでFirestoreデータベースが有効になっていないことが原因です。

--- 設定確認チェックリスト ---

✅ 1. Firestore データベースを作成しましたか？
   - Firebaseコンソールを開きます: https://console.firebase.google.com/
   - あなたのプロジェクト (${uh.projectId}) を選択 > 左側のメニューから「Firestore Database」をクリックします。
   - 「データベースの作成」ボタンが表示される場合、クリックしてデータベースを初期化してください。
   - モード選択では「テストモードで開始する」を選ぶと開発がスムーズです。
   - リージョン（ロケーション）を選択します（例: asia-northeast1）。一度選択すると変更できないためご注意ください。

✅ 2. APIが有効になっていますか？
   - 通常、データベースを作成すると自動で有効になります。
   - 確認ページ: https://console.cloud.google.com/apis/library/firestore.googleapis.com
   - 対象のプロジェクトで「Cloud Firestore API」が有効になっていることを確認してください。

上記を確認後、アプリケーションをリロードして再度お試しください。`)),n},oP=async()=>{try{const n=await HI(hp,Q0);return X0(n.user)}catch(n){throw n instanceof ir?(console.error("Firebase Auth Error:",{code:n.code,message:n.message}),n.code==="auth/popup-blocked"?alert("ログイン用のポップアップがブラウザにブロックされました。ポップアップを許可してから、もう一度お試しください。"):n.code==="auth/popup-closed-by-user"?console.log("Login popup was closed by the user."):n.code==="auth/configuration-not-found"?alert(`Googleログイン設定エラー (auth/configuration-not-found)

Firebaseプロジェクトの認証設定が完了していないようです。
コードの修正は不要です。以下の手順でFirebaseコンソールの設定を確認してください。

--- 設定確認チェックリスト ---

✅ 1. Google サインインの有効化
   - Firebaseコンソールを開きます: https://console.firebase.google.com/
   - プロジェクトを選択 > 「Authentication」 > 「Sign-in method」タブ
   - プロバイダーリストから「Google」を選択し、「有効にする」スイッチがオンになっていることを確認してください。

✅ 2. 承認済みドメインの確認
   - 「Authentication」 > 「Settings」タブ
   - 「承認済みドメイン」セクションに、アプリを実行しているドメイン（例: localhost）がリストに含まれていることを確認してください。なければ追加します。

✅ 3. Firebase構成キーの確認
   - プロジェクト設定（歯車アイコン） > 「全般」タブ
   - 「マイアプリ」セクションでウェブアプリを選択し、表示される 'firebaseConfig' の値が、プロジェクト内の 'firebaseConfig.ts' ファイルの内容と完全に一致しているか確認してください。

上記3点を確認後、再度ログインをお試しください。`):alert("ログイン中にエラーが発生しました。コンソールで詳細を確認してください。")):(console.error("An unexpected error occurred during sign-in:",n),alert("予期せぬエラーが発生しました。")),n}},sP=()=>wI(hp),aP=n=>CI(hp,e=>{n(e?X0(e):null)}),lP=async(n,e)=>{try{const t={...e,timetables:e.timetables.map(i=>({...i,grid:rP(i.grid)}))},r=U0(Y0,"users",n);await eP(r,{timetableData:t})}catch(t){Z0(t,"保存")}},uP=async n=>{try{const e=U0(Y0,"users",n),t=await ZR(e);if(t.exists()){const r=t.data().timetableData;return{...r,timetables:r.timetables.map(a=>({...a,grid:iP(a.grid,a.settings)}))}}else return null}catch(e){return Z0(e,"読み込み"),null}},cP=()=>({id:`timetable-${Date.now()}`,name:"前期の時間割",settings:{days:nl.slice(0,5),periods:7},grid:Array(7).fill(0).map(()=>Array(7).fill(0).map(()=>[]))}),dP=n=>{const[e,t]=ae.useState([]),[r,i]=ae.useState(null),[a,c]=ae.useState("idle"),[f,m]=ae.useState(!0),p=ae.useRef(null);ae.useEffect(()=>{(async()=>{m(!0);try{let x=null,P=null;if(n){const N=await uP(n.uid);N&&(x=N.timetables,P=N.activeTimetableId)}else{const N=localStorage.getItem("timetables"),b=localStorage.getItem("activeTimetableId");N&&(x=JSON.parse(N),P=b)}x&&x.length>0?(t(x),P&&x.some(N=>N.id===P)?i(P):i(x[0].id)):(t([]),i(null))}catch(x){console.error("Failed to load data:",x),t([]),i(null)}finally{m(!1),c("idle")}})()},[n]),ae.useEffect(()=>{if(!(f||e.length===0&&r===null))return c("saving"),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{const k={timetables:e,activeTimetableId:r};try{n?lP(n.uid,k):(localStorage.setItem("timetables",JSON.stringify(e)),r?localStorage.setItem("activeTimetableId",r):localStorage.removeItem("activeTimetableId")),c("saved"),setTimeout(()=>c("idle"),2e3)}catch(x){console.error("Failed to save data:",x),c("idle")}},1e3),()=>{p.current&&clearTimeout(p.current)}},[e,r,n,f]);const y=e.find(k=>k.id===r),T=ae.useCallback(k=>{t(x=>x.map(P=>P.id===r?k:P))},[r]),C=k=>{const x={...cP(),name:k,id:`timetable-${Date.now()}`};t(P=>[...P,x]),i(x.id)},A=ae.useCallback(k=>{try{const x=JSON.parse(k);if(typeof x.name!="string"||typeof x.settings!="object"||!Array.isArray(x.grid))throw new Error("Invalid timetable format.");const P={...x,id:`timetable-${Date.now()}`};return t(N=>[...N,P]),i(P.id),!0}catch(x){return console.error("Failed to import timetable:",x),!1}},[]),L=k=>{t(x=>{const P=x.filter(N=>N.id!==k);return r===k&&i(P.length>0?P[0].id:null),P})},U=ae.useCallback(k=>{if(!y)return;const x=Array(nl.length).fill(0).map((P,N)=>Array(k.periods).fill(0).map((b,M)=>{const Pe=nl[N];return y.settings.days.includes(Pe)&&N<y.settings.days.length&&M<y.settings.periods?y.grid[N]?.[M]||[]:[]}));T({...y,settings:k,grid:x})},[y,T]),O=ae.useCallback((k,x,P)=>{if(!y)return;const N=y.grid.map(Pe=>Pe.map(De=>[...De])),b=N[x][P],M=b.findIndex(Pe=>Pe.id===k.id);if(M>-1){const Pe=b[M].tasks;b[M]={...k,tasks:Pe}}else b.push(k);T({...y,grid:N})},[y,T]),K=ae.useCallback((k,x,P)=>{if(!y)return;const N=y.grid.map(b=>b.map(M=>[...M]));N[x][P]=N[x][P].filter(b=>b.id!==k),T({...y,grid:N})},[y,T]),W=ae.useCallback((k,x,P)=>{if(!y)return;const N=y.grid.map(b=>b.map(M=>[...M]));N[x.dayIndex][x.periodIndex]=N[x.dayIndex][x.periodIndex].filter(b=>b.id!==k.id),N[P.dayIndex][P.periodIndex].push(k),T({...y,grid:N})},[y,T]),Y=ae.useCallback((k,x,P)=>{t(N=>{const b=N.findIndex(Le=>Le.id===P);if(b===-1)return N;const M=[...N],Pe={...M[b]};let De=!1;const Ne=Pe.grid.map(Le=>Le.map(oe=>oe.map(ye=>{if(ye.id===x){const ue=ye.tasks.findIndex(q=>q.id===k);if(ue>-1){De=!0;const q=[...ye.tasks];return q[ue]={...q[ue],completed:!q[ue].completed},{...ye,tasks:q}}}return ye})));return De?(M[b]={...Pe,grid:Ne},M):N})},[]),re=ae.useCallback((k,x,P)=>{t(N=>N.map(b=>{if(b.id!==P)return b;const M=b.grid.map(Pe=>Pe.map(De=>De.map(Ne=>Ne.id===x?{...Ne,tasks:[...Ne.tasks,k]}:Ne)));return{...b,grid:M}}))},[]),le=ae.useCallback((k,x,P)=>{t(N=>N.map(b=>{if(b.id!==P)return b;const M=b.grid.map(Pe=>Pe.map(De=>De.map(Ne=>{if(Ne.id===x){const Le=Ne.tasks.map(oe=>oe.id===k.id?k:oe);return{...Ne,tasks:Le}}return Ne})));return{...b,grid:M}}))},[]),Z=ae.useCallback((k,x,P)=>{t(N=>N.map(b=>{if(b.id!==P)return b;const M=b.grid.map(Pe=>Pe.map(De=>De.map(Ne=>{if(Ne.id===x){const Le=Ne.tasks.filter(oe=>oe.id!==k);return{...Ne,tasks:Le}}return Ne})));return{...b,grid:M}}))},[]),D=y?[...new Set(y.grid.flat(2).map(k=>k.id))].map(k=>y.grid.flat(2).find(x=>x.id===k)).reduce((k,x)=>k+(x?.credits||0),0):0;return{timetables:e,activeTimetable:y,activeTimetableId:r,setActiveTimetableId:i,addTimetable:C,importTimetable:A,deleteTimetable:L,updateTimetableSettings:U,saveSubject:O,deleteSubject:K,moveSubject:W,toggleTaskCompletion:Y,addTask:re,updateTask:le,deleteTask:Z,totalCredits:D,saveStatus:a,isLoading:f}},pp=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),mp=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),j0=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})}),kr=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),eE=({className:n})=>S.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),fP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),hP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),pP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),ch=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),mP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),gP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),yP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"})}),vP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),_P=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),TP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:n,children:S.jsx("path",{d:"M3.105 2.289a.75.75 0 00-.826.95l1.414 4.949a.75.75 0 00.95.826L11.25 8.25l-5.607-1.402a.75.75 0 00-.95.826l1.414 4.949a.75.75 0 00.95.826L11.25 11.75l-5.607-1.402a.75.75 0 00-.95.826l1.414 4.949a.75.75 0 00.95.826L16.25 12l-12.2-9.148a.75.75 0 00-.945-.563z"})}),EP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12z"})}),gp=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"})}),CP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z"})}),wP=({className:n})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.25 5.25m.47-5.512a.75.75 0 111.06 1.06M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),SP=({onImport:n,onExport:e,onOpenAppInfo:t,onOpenInstallPwa:r})=>{const[i,a]=ae.useState(!1),c=ae.useRef(null);return ae.useEffect(()=>{const f=m=>{c.current&&!c.current.contains(m.target)&&a(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),S.jsxs("div",{ref:c,className:"relative",children:[S.jsx("button",{onClick:()=>a(!i),className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"その他",children:S.jsx(CP,{className:"w-6 h-6"})}),i&&S.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-gray-100/90 dark:bg-gray-800/90 backdrop-blur-md rounded-lg shadow-2xl border border-black/10 dark:border-white/10 p-1.5 z-40 fade-in",children:S.jsxs("ul",{className:"space-y-1",children:[S.jsx("li",{children:S.jsxs("button",{onClick:()=>{r(),a(!1)},className:"w-full text-left px-3 py-1.5 text-sm rounded-md flex items-center gap-3 hover:bg-sky-500 hover:text-white transition-colors",children:[S.jsx(ch,{className:"w-5 h-5"}),S.jsx("span",{children:"アプリをインストール"})]})}),S.jsxs("li",{children:[S.jsxs("label",{htmlFor:"import-file",className:"w-full text-left px-3 py-1.5 text-sm rounded-md flex items-center gap-3 hover:bg-sky-500 hover:text-white transition-colors cursor-pointer",children:[S.jsx(mP,{className:"w-5 h-5"}),S.jsx("span",{children:"インポート"})]}),S.jsx("input",{id:"import-file",type:"file",accept:".tmx",className:"hidden",onChange:n})]}),S.jsx("li",{children:S.jsxs("button",{onClick:()=>{e(),a(!1)},className:"w-full text-left px-3 py-1.5 text-sm rounded-md flex items-center gap-3 hover:bg-sky-500 hover:text-white transition-colors",children:[S.jsx(ch,{className:"w-5 h-5"}),S.jsx("span",{children:"エクスポート"})]})}),S.jsx("li",{children:S.jsxs("button",{onClick:()=>{t(),a(!1)},className:"w-full text-left px-3 py-1.5 text-sm rounded-md flex items-center gap-3 hover:bg-sky-500 hover:text-white transition-colors",children:[S.jsx(wP,{className:"w-5 h-5"}),S.jsx("span",{children:"アプリ情報"})]})})]})})]})},IP=({timetables:n,activeTimetableId:e,setActiveTimetableId:t,onAddTimetable:r,onDeleteTimetable:i,onOpenSettings:a,onOpenTaskList:c,totalCredits:f,theme:m,toggleTheme:p,onExport:y,onImport:T,onOpenAppInfo:C,onOpenInstallPwa:A,user:L,onLogin:U,onLogout:O})=>S.jsxs("header",{className:"sticky top-0 z-30 p-4 bg-gray-100/80 dark:bg-gray-900/70 backdrop-blur-lg shadow-md border-b border-black/10 dark:border-white/10 flex flex-wrap justify-between items-center gap-4",children:[S.jsx("div",{className:"flex items-center gap-2 md:gap-4 flex-wrap",children:n.length===0?S.jsx("h1",{className:"text-xl font-bold",children:"Tablit"}):S.jsxs(S.Fragment,{children:[S.jsx("select",{value:e||"",onChange:K=>t(K.target.value),className:"bg-gray-200/50 dark:bg-gray-700/50 border border-black/10 dark:border-white/10 rounded-lg py-2 px-3 focus:outline-none focus:ring-2 focus:ring-sky-500 transition-colors",children:n.map(K=>S.jsx("option",{value:K.id,className:"bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-white",children:K.name},K.id))}),S.jsxs("div",{className:"flex items-center gap-1",children:[S.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"新しい時間割を追加",children:S.jsx(pp,{className:"w-5 h-5"})}),S.jsx("button",{onClick:i,className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors text-red-500 hover:text-red-600",title:"現在の時間割を削除",children:S.jsx(mp,{className:"w-5 h-5"})})]}),S.jsxs("div",{className:"block md:hidden bg-sky-500/20 text-sky-800 dark:text-sky-200 text-sm font-bold px-3 py-1.5 rounded-full",children:["単位: ",f]}),S.jsxs("div",{className:"hidden md:block bg-sky-500/20 text-sky-800 dark:text-sky-200 text-sm font-bold px-3 py-1.5 rounded-full",children:["合計単位数: ",f]})]})}),S.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[n.length>0&&S.jsxs(S.Fragment,{children:[S.jsx("button",{onClick:c,className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"課題一覧",children:S.jsx(EP,{className:"w-6 h-6"})}),S.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"設定",children:S.jsx(eE,{className:"w-6 h-6"})})]}),S.jsx("button",{onClick:p,className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"テーマを切り替え",children:m==="light"?S.jsx(pP,{className:"w-6 h-6"}):S.jsx(hP,{className:"w-6 h-6"})}),S.jsx(SP,{onImport:T,onExport:y,onOpenAppInfo:C,onOpenInstallPwa:A}),S.jsx("div",{className:"border-l border-gray-300 dark:border-gray-600 pl-2 ml-1",children:L?S.jsxs("div",{className:"flex items-center gap-2",children:[L.photoURL?S.jsx("img",{src:L.photoURL,alt:"profile",className:"w-8 h-8 rounded-full border-2 border-gray-300 dark:border-gray-500"}):S.jsx(gP,{className:"w-8 h-8 text-gray-500 dark:text-gray-400"}),S.jsx("button",{onClick:O,className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"ログアウト",children:S.jsx(yP,{className:"w-6 h-6"})})]}):S.jsx("button",{onClick:U,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm py-2 px-4 rounded-lg transition-colors",children:"Googleでログイン"})})]})]}),AP=({subject:n,onClick:e,dayIndex:t,periodIndex:r,onContextMenu:i})=>{const a=ae.useRef(null),c=ae.useRef(!1),f=O=>{const K={subject:n,from:{dayIndex:t,periodIndex:r}};O.dataTransfer.setData("application/json",JSON.stringify(K)),O.currentTarget.style.opacity="0.5",O.currentTarget.style.transform="scale(0.95)"},m=O=>{O.currentTarget.style.opacity="1",O.currentTarget.style.transform="scale(1)"},p=n.tasks.filter(O=>!O.completed).length,y=O=>{c.current=!1,a.current=setTimeout(()=>{const K=O.touches[0],W={...O,clientX:K.clientX,clientY:K.clientY,preventDefault:()=>O.preventDefault(),stopPropagation:()=>O.stopPropagation()};i(W),c.current=!0},500)},T=()=>{a.current&&clearTimeout(a.current)},C=()=>{a.current&&clearTimeout(a.current)},A=()=>{c.current||e()},L=O=>{O.stopPropagation()},U=Vi.find(O=>O.name===n.color)||Vi[0];return S.jsxs("div",{draggable:!0,onDragStart:f,onDragEnd:m,onClick:A,onContextMenu:i,onTouchStart:y,onTouchEnd:T,onTouchMove:C,className:`${U.bg} ${U.text} rounded-lg p-1.5 text-xs cursor-pointer transition-all duration-200 shadow-lg hover:shadow-xl hover:-translate-y-0.5 flex flex-col justify-between h-full relative`,children:[S.jsxs("div",{className:"flex-grow",children:[S.jsx("p",{className:"font-bold text-sm leading-tight break-words",children:n.name}),S.jsx("p",{className:"opacity-80 break-words",children:n.room})]}),S.jsxs("div",{className:"flex items-center justify-between mt-1",children:[S.jsx("div",{children:n.url&&S.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",onClick:L,className:"inline-block p-1 rounded-full bg-black/10 dark:bg-white/20 hover:bg-black/20 dark:hover:bg-white/40 transition-colors",title:"授業ページを開く",children:S.jsx(gp,{className:"w-3 h-3"})})}),p>0&&S.jsx("div",{className:"self-end",children:S.jsx("span",{className:"text-xs bg-black/20 dark:bg-white/30 rounded-full px-1.5 py-0.5 font-bold",children:p})})]})]})},xP=({x:n,y:e,items:t,onClose:r})=>{const i=ae.useRef(null),[a,c]=ae.useState({top:e,left:n}),[f,m]=ae.useState(!1);return ae.useEffect(()=>{const p=y=>{i.current&&!i.current.contains(y.target)&&r()};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[r]),ae.useEffect(()=>{if(i.current){const p=i.current.getBoundingClientRect(),{innerWidth:y,innerHeight:T}=window;let C=n;n+p.width>y&&(C=n-p.width),C<0&&(C=5);let A=e;e+p.height>T&&(A=e-p.height),A<0&&(A=5),c({top:A,left:C}),m(!0)}},[]),S.jsx("div",{ref:i,className:`fixed z-50 bg-gray-100/70 dark:bg-gray-800/70 backdrop-blur-md rounded-lg shadow-2xl border border-black/10 dark:border-white/10 p-1.5 min-w-[150px] fade-in transition-opacity ${f?"opacity-100":"opacity-0"}`,style:a,onContextMenu:p=>p.preventDefault(),children:S.jsx("ul",{className:"space-y-1",children:t.map((p,y)=>S.jsx("li",{children:S.jsx("button",{onClick:p.onClick,disabled:p.disabled,className:"w-full text-left px-3 py-1.5 text-sm rounded-md flex items-center gap-2 hover:bg-sky-500 hover:text-white disabled:opacity-50 disabled:hover:bg-transparent disabled:text-gray-500 dark:disabled:text-gray-400 transition-colors",children:p.label})},y))})})},kP=({timetable:n,onAddSubject:e,onEditSubject:t,onMoveSubject:r,onDeleteSubject:i,onCopySubject:a,onPasteSubject:c,copiedSubject:f})=>{const{settings:m,grid:p}=n,[y,T]=ae.useState(null),C=ae.useRef(null),A=ae.useRef(null);ae.useEffect(()=>{const Z=()=>T(null);return window.addEventListener("click",Z),()=>window.removeEventListener("click",Z)},[]),ae.useEffect(()=>{const Z=A.current;if(!Z||!window.matchMedia("(max-width: 768px)").matches)return;const x=["日","月","火","水","木","金","土"][new Date().getDay()],P=m.days.indexOf(x);if(P===-1)return;const N=Z.firstElementChild;if(!N)return;const b=N.querySelector(`[data-day-header-index="${P}"]`);b&&(Z.scrollLeft=b.offsetLeft)},[m.days]);const L=Z=>{Z.preventDefault(),Z.currentTarget.classList.add("bg-sky-400/30")},U=Z=>{Z.currentTarget.classList.remove("bg-sky-400/30")},O=(Z,D,k)=>{Z.preventDefault(),Z.currentTarget.classList.remove("bg-sky-400/30");const x=Z.dataTransfer.getData("application/json");if(x){const{subject:P,from:N}=JSON.parse(x);r(P,N,{dayIndex:D,periodIndex:k})}},K=(Z,D,k,x)=>{Z.preventDefault(),Z.stopPropagation(),T({x:Z.clientX,y:Z.clientY,items:[{label:"コピー",onClick:()=>{a(D),T(null)}},{label:"削除",onClick:()=>{i(D.id,k,x),T(null)}}]})},W=(Z,D,k)=>{Z.preventDefault(),T({x:Z.clientX,y:Z.clientY,items:[{label:"貼り付け",onClick:()=>{c(D,k),T(null)},disabled:!f}]})},Y=Z=>{const D=Z.currentTarget,k=parseInt(D.dataset.dayindex,10),x=parseInt(D.dataset.periodindex,10);isNaN(k)||isNaN(x)||(C.current=setTimeout(()=>{const P=Z.touches[0],N={...Z,clientX:P.clientX,clientY:P.clientY,preventDefault:()=>Z.preventDefault(),stopPropagation:()=>Z.stopPropagation()};W(N,k,x)},500))},re=()=>{C.current&&clearTimeout(C.current)},le=()=>{C.current&&clearTimeout(C.current)};return S.jsxs("div",{ref:A,className:"p-2 md:p-8 flex-grow fade-in overflow-auto md:overflow-x-auto h-[calc(100vh-120px)] md:h-auto",children:[S.jsxs("div",{className:"grid gap-0.5 md:gap-1 bg-gray-500/10 backdrop-blur-md rounded-2xl p-1 md:p-2 border border-black/10 dark:border-white/10 min-w-[768px]",style:{gridTemplateColumns:`auto repeat(${m.days.length}, 1fr)`},children:[S.jsx("div",{className:"sticky top-0 left-0 z-20 p-2 bg-gray-100 dark:bg-gray-900 md:static"}),m.days.map((Z,D)=>S.jsx("div",{"data-day-header-index":D,className:"sticky top-0 z-10 text-center font-bold py-3 text-xs md:text-base text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-900 md:static",children:Z},D)),Array.from({length:m.periods}).map((Z,D)=>S.jsxs(R_.Fragment,{children:[S.jsx("div",{className:"sticky left-0 z-10 text-center font-bold px-1 md:px-2 py-4 text-xs md:text-base text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-900 md:static",children:D+1}),m.days.map((k,x)=>{const P=RP.indexOf(k),N=p[P]?.[D]||[];return S.jsxs("div",{className:"min-h-[90px] md:min-h-[110px] bg-black/5 dark:bg-white/5 border border-black/10 dark:border-white/10 rounded-lg p-1 flex flex-col gap-1 transition-colors duration-300",onDragOver:L,onDragLeave:U,onDrop:b=>O(b,P,D),onContextMenu:b=>W(b,P,D),onTouchStart:Y,onTouchEnd:re,onTouchMove:le,"data-dayindex":P,"data-periodindex":D,children:[N.map(b=>S.jsx(AP,{subject:b,onClick:()=>t(b,P,D),dayIndex:P,periodIndex:D,onContextMenu:M=>K(M,b,P,D)},b.id)),S.jsx("button",{onClick:()=>e(P,D),className:"mt-auto w-full flex-grow flex items-center justify-center text-gray-400/50 hover:bg-black/5 dark:hover:bg-white/5 rounded-md transition-colors",children:S.jsx(pp,{className:"w-5 h-5"})})]},`${x}-${D}`)})]},D))]}),y&&S.jsx(xP,{...y,onClose:()=>T(null)})]})},RP=["月","火","水","木","金","土","日"],ov={name:"",room:"",credits:0,memo:"",color:Vi[0].name,url:""},PP=({isOpen:n,onClose:e,onSave:t,onDelete:r,subjectData:i,taskHandlers:a})=>{const[c,f]=ae.useState(ov);ae.useEffect(()=>{if(n)if(i.subject)f({name:i.subject.name,room:i.subject.room,credits:i.subject.credits,memo:i.subject.memo,color:i.subject.color,url:i.subject.url||""});else{const A=Vi[Math.floor(Math.random()*Vi.length)];f({...ov,color:A.name})}},[n,i.subject?.id]);const m=A=>{const{name:L,value:U}=A.target;f(O=>({...O,[L]:L==="credits"?parseInt(U)||0:U}))},p=A=>{f(L=>({...L,color:A}))},y=()=>{const L={...i.subject||{id:`subject-${Date.now()}`,tasks:[]},...c};t(L,i.dayIndex,i.periodIndex),e()},T=()=>{r&&i.subject&&(r(i.subject.id,i.dayIndex,i.periodIndex),e())},C=i.subject?.tasks||[];return S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-lg max-h-[90vh] flex flex-col shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10 flex-shrink-0",children:[S.jsx("h2",{className:"text-xl font-bold",children:i.subject?"授業の編集":"授業の追加"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[S.jsx("input",{name:"name",value:c.name,onChange:m,placeholder:"授業名",className:"md:col-span-2 bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500"}),S.jsx("input",{name:"room",value:c.room,onChange:m,placeholder:"教室",className:"bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500"}),S.jsx("input",{name:"credits",type:"number",value:c.credits,onChange:m,placeholder:"単位数",className:"bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500"})]}),S.jsx("input",{name:"url",value:c.url,onChange:m,placeholder:"授業ページのURL",className:"w-full bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500"}),S.jsx("textarea",{name:"memo",value:c.memo,onChange:m,placeholder:"授業メモ",className:"w-full bg-black/5 dark:bg-white/5 p-2 rounded-md h-24 resize-none focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500"}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-lg font-semibold mb-3",children:"カラー"}),S.jsx("div",{className:"flex flex-wrap gap-2",children:Vi.map(A=>S.jsx("button",{onClick:()=>p(A.name),className:`w-8 h-8 rounded-full ${A.bg} transition-transform hover:scale-110 ${c.color===A.name?"ring-2 ring-offset-2 ring-offset-gray-100 dark:ring-offset-gray-900 ring-sky-500":""}`},A.name))})]}),i.subject&&S.jsxs("div",{children:[S.jsxs("div",{className:"flex justify-between items-center mb-3",children:[S.jsx("h3",{className:"text-lg font-semibold",children:"課題リスト"}),S.jsxs("button",{onClick:a.onOpenAddTaskModal,className:"flex items-center gap-2 bg-sky-600/20 hover:bg-sky-600/30 text-sky-700 dark:text-sky-300 font-bold py-1.5 px-3 rounded-lg text-sm transition-colors",children:[S.jsx(pp,{className:"w-4 h-4"}),S.jsx("span",{children:"追加"})]})]}),S.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-1",children:C.length>0?C.map(A=>S.jsxs("div",{className:"bg-black/5 dark:bg-white/5 p-2 rounded-md flex items-center gap-2",children:[S.jsx("input",{type:"checkbox",checked:A.completed,onChange:()=>a.onToggleTask(A.id),className:"form-checkbox h-4 w-4 rounded bg-gray-300 dark:bg-gray-600 border-gray-400 dark:border-gray-500 text-sky-600 focus:ring-sky-500 flex-shrink-0"}),S.jsxs("div",{className:"flex-grow",children:[S.jsx("p",{className:`text-sm ${A.completed?"line-through text-gray-500":""}`,children:A.content}),A.dueDate&&S.jsx("p",{className:"text-xs text-gray-500",children:A.dueDate})]}),A.url&&S.jsx("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"p-1 rounded-full text-gray-500 hover:bg-black/10 dark:hover:bg-white/10",title:"課題ページを開く",children:S.jsx(gp,{className:"w-4 h-4"})}),S.jsx("button",{onClick:()=>a.onOpenEditTaskModal(A),className:"p-1 rounded-full text-gray-500 hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(j0,{className:"w-4 h-4"})}),S.jsx("button",{onClick:()=>a.onDeleteTask(A.id),className:"p-1 rounded-full text-gray-500 hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(mp,{className:"w-4 h-4"})})]},A.id)):S.jsx("p",{className:"text-sm text-center text-gray-500 py-4",children:"この授業の課題はありません。"})})]})]}),S.jsxs("div",{className:"p-4 flex justify-between items-center border-t border-black/10 dark:border-white/10 mt-auto flex-shrink-0",children:[S.jsx("div",{children:i.subject&&r&&S.jsx("button",{onClick:T,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"削除"})}),S.jsx("button",{onClick:y,className:"bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"保存"})]})]})})},NP=({isOpen:n,onClose:e,onSave:t,currentSettings:r})=>{const[i,a]=ae.useState(r);if(ae.useEffect(()=>{n&&a(r)},[n,r]),!n)return null;const c=p=>{const y=i.days.includes(p)?i.days.filter(C=>C!==p):[...i.days,p],T=nl.filter(C=>y.includes(C));a(C=>({...C,days:T}))},f=p=>{const y=Math.max(1,Math.min(10,parseInt(p.target.value)||1));a(T=>({...T,periods:y}))},m=()=>{t(i),e()};return S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-md shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:"表示設定"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsxs("div",{className:"p-6 space-y-6",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"text-lg font-semibold mb-3",children:"表示する曜日"}),S.jsx("div",{className:"flex flex-wrap gap-2",children:nl.map(p=>S.jsxs("button",{onClick:()=>c(p),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i.days.includes(p)?"bg-sky-600 text-white":"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:[p,"曜日"]},p))})]}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-lg font-semibold mb-2",children:"時限数"}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("input",{type:"range",min:"1",max:"10",value:i.periods,onChange:f,className:"w-full h-2 bg-gray-300 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-sky-600"}),S.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 rounded-md px-3 py-1 font-bold",children:i.periods})]})]})]}),S.jsx("div",{className:"p-4 flex justify-end items-center border-t border-black/10 dark:border-white/10",children:S.jsx("button",{onClick:m,className:"bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"保存"})})]})})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let MP,DP;function VP(){return{geminiUrl:MP,vertexUrl:DP}}function LP(n,e,t,r){var i,a;if(!n?.baseUrl){const c=VP();return e?(i=c.vertexUrl)!==null&&i!==void 0?i:t:(a=c.geminiUrl)!==null&&a!==void 0?a:r}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bo{}function me(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const a=e[i];return a!=null?String(a):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function u(n,e,t){for(let a=0;a<e.length-1;a++){const c=e[a];if(c.endsWith("[]")){const f=c.slice(0,-2);if(!(f in n))if(Array.isArray(t))n[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(n[f])){const m=n[f];if(Array.isArray(t))for(let p=0;p<m.length;p++){const y=m[p];u(y,e.slice(a+1),t[p])}else for(const p of m)u(p,e.slice(a+1),t)}return}else if(c.endsWith("[0]")){const f=c.slice(0,-3);f in n||(n[f]=[{}]);const m=n[f];u(m[0],e.slice(a+1),t);return}(!n[c]||typeof n[c]!="object")&&(n[c]={}),n=n[c]}const r=e[e.length-1],i=n[r];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else n[r]=t}function l(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const r=e[t];if(r.endsWith("[]")){const i=r.slice(0,-2);if(i in n){const a=n[i];return Array.isArray(a)?a.map(c=>l(c,e.slice(t+1))):void 0}else return}else n=n[r]}return n}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dh(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var sv;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(sv||(sv={}));var av;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(av||(av={}));var Di;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Di||(Di={}));var lv;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(lv||(lv={}));var uv;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(uv||(uv={}));var cv;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(cv||(cv={}));var dv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(dv||(dv={}));var fv;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(fv||(fv={}));var hv;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(hv||(hv={}));var pv;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(pv||(pv={}));var mv;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(mv||(mv={}));var gv;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(gv||(gv={}));var yv;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(yv||(yv={}));var vv;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(vv||(vv={}));var _v;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(_v||(_v={}));var Ac;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Ac||(Ac={}));var Tv;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Tv||(Tv={}));var fh;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(fh||(fh={}));var Ev;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Ev||(Ev={}));var Cv;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Cv||(Cv={}));var wv;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(wv||(wv={}));var Sv;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(Sv||(Sv={}));var Iv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Iv||(Iv={}));var Av;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Av||(Av={}));var xv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(xv||(xv={}));var kv;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(kv||(kv={}));var Rv;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Rv||(Rv={}));var Pv;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(Pv||(Pv={}));var Nv;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Nv||(Nv={}));var Mv;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Mv||(Mv={}));var Dv;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Dv||(Dv={}));var Vv;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Vv||(Vv={}));var Lv;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(Lv||(Lv={}));var bv;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(bv||(bv={}));var Uv;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(Uv||(Uv={}));var Fv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(Fv||(Fv={}));var Ov;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(Ov||(Ov={}));var Bv;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(Bv||(Bv={}));var qv;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(qv||(qv={}));var Gv;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Gv||(Gv={}));var Hv;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(Hv||(Hv={}));var $v;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})($v||($v={}));var zv;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(zv||(zv={}));var Wv;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Wv||(Wv={}));var Jv;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Jv||(Jv={}));var Ns;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Ns||(Ns={}));class hh{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ha{get text(){var e,t,r,i,a,c,f,m;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",y=!1;const T=[];for(const C of(m=(f=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||f===void 0?void 0:f.parts)!==null&&m!==void 0?m:[]){for(const[A,L]of Object.entries(C))A!=="text"&&A!=="thought"&&(L!==null||L!==void 0)&&T.push(A);if(typeof C.text=="string"){if(typeof C.thought=="boolean"&&C.thought)continue;y=!0,p+=C.text}}return T.length>0&&console.warn(`there are non-text parts ${T} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),y?p:void 0}get data(){var e,t,r,i,a,c,f,m;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const y=[];for(const T of(m=(f=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||f===void 0?void 0:f.parts)!==null&&m!==void 0?m:[]){for(const[C,A]of Object.entries(T))C!=="inlineData"&&(A!==null||A!==void 0)&&y.push(C);T.inlineData&&typeof T.inlineData.data=="string"&&(p+=atob(T.inlineData.data))}return y.length>0&&console.warn(`there are non-data parts ${y} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,r,i,a,c,f,m;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(m=(f=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||f===void 0?void 0:f.parts)===null||m===void 0?void 0:m.filter(y=>y.functionCall).map(y=>y.functionCall).filter(y=>y!==void 0);if(p?.length!==0)return p}get executableCode(){var e,t,r,i,a,c,f,m,p;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const y=(m=(f=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||f===void 0?void 0:f.parts)===null||m===void 0?void 0:m.filter(T=>T.executableCode).map(T=>T.executableCode).filter(T=>T!==void 0);if(y?.length!==0)return(p=y?.[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,r,i,a,c,f,m,p;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const y=(m=(f=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||f===void 0?void 0:f.parts)===null||m===void 0?void 0:m.filter(T=>T.codeExecutionResult).map(T=>T.codeExecutionResult).filter(T=>T!==void 0);if(y?.length!==0)return(p=y?.[0])===null||p===void 0?void 0:p.output}}class Kv{}class Yv{}class bP{}class UP{}class FP{}class OP{}class Qv{}class Xv{}class Zv{}class BP{}class jv{}class xc{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const r=new xc;if(r.name=e.name,r.metadata=e.metadata,r.done=e.done,r.error=e.error,t){const i=e.response;if(i){const a=new jv,c=i.videos;a.generatedVideos=c?.map(f=>({video:{uri:f.gcsUri,videoBytes:f.bytesBase64Encoded?dh(f.bytesBase64Encoded):void 0,mimeType:f.mimeType}})),a.raiMediaFilteredCount=i.raiMediaFilteredCount,a.raiMediaFilteredReasons=i.raiMediaFilteredReasons,r.response=a}}else{const i=e.response;if(i){const a=new jv,c=i.generateVideoResponse,f=c?.generatedSamples;a.generatedVideos=f?.map(m=>{const p=m.video;return{video:{uri:p?.uri,videoBytes:p?.encodedVideo?dh(p?.encodedVideo):void 0,mimeType:m.encoding}}}),a.raiMediaFilteredCount=c?.raiMediaFilteredCount,a.raiMediaFilteredReasons=c?.raiMediaFilteredReasons,r.response=a}}return r}}class e_{}class t_{}class n_{}class qP{}class GP{}class HP{}class r_{}class $P{get text(){var e,t,r;let i="",a=!1;const c=[];for(const f of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[m,p]of Object.entries(f))m!=="text"&&m!=="thought"&&p!==null&&c.push(m);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;a=!0,i+=f.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?i:void 0}get data(){var e,t,r;let i="";const a=[];for(const c of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,m]of Object.entries(c))f!=="inlineData"&&m!==null&&a.push(f);c.inlineData&&typeof c.inlineData.data=="string"&&(i+=atob(c.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class zP{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xe(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function tE(n,e){const t=Xe(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function nE(n){return Array.isArray(n)?n.map(e=>kc(e)):[kc(n)]}function kc(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function rE(n){const e=kc(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function iE(n){const e=kc(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function i_(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function oE(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>i_(e)):[i_(n)]}function ph(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function o_(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function s_(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Zt(n){if(n==null)throw new Error("ContentUnion is required");return ph(n)?n:{role:"user",parts:oE(n)}}function sE(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Zt(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Zt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Zt(t)):[Zt(e)]}function Vn(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(o_(n)||s_(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Zt(n)]}const e=[],t=[],r=ph(n[0]);for(const i of n){const a=ph(i);if(a!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(i);else{if(o_(i)||s_(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return r||e.push({role:"user",parts:oE(t)}),e}function WP(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.values(Di).includes(t[0].toUpperCase())?t[0].toUpperCase():Di.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.values(Di).includes(r.toUpperCase())?r.toUpperCase():Di.TYPE_UNSPECIFIED})}}function bs(n){const e={},t=["items"],r=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&WP(n.type,e);for(const[c,f]of Object.entries(n))if(f!=null)if(c=="type"){if(f==="null")throw new Error("type: null can not be the only possible type for the field.");if(f instanceof Array)continue;e.type=Object.values(Di).includes(f.toUpperCase())?f.toUpperCase():Di.TYPE_UNSPECIFIED}else if(t.includes(c))e[c]=bs(f);else if(r.includes(c)){const m=[];for(const p of f){if(p.type=="null"){e.nullable=!0;continue}m.push(bs(p))}e[c]=m}else if(i.includes(c)){const m={};for(const[p,y]of Object.entries(f))m[p]=bs(y);e[c]=m}else{if(c==="additionalProperties")continue;e[c]=f}return e}function yp(n){return bs(n)}function vp(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function _p(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function ea(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=bs(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=bs(e.response));return n}function ta(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function JP(n,e,t,r=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function ei(n,e){if(typeof e!="string")throw new Error("name must be a string");return JP(n,e,"cachedContents")}function aE(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function qo(n){return dh(n)}function KP(n){return n!=null&&typeof n=="object"&&"name"in n}function YP(n){return n!=null&&typeof n=="object"&&"video"in n}function QP(n){return n!=null&&typeof n=="object"&&"uri"in n}function lE(n){var e;let t;if(KP(n)&&(t=n.name),!(QP(n)&&(t=n.uri,t===void 0))&&!(YP(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function uE(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function cE(n){for(const e of["models","tunedModels","publisherModels"])if(XP(n,e))return n[e];return[]}function XP(n,e){return n!==null&&typeof n=="object"&&e in n}function ZP(n,e={}){const t=n,r={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(r.responseJsonSchema=t.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function jP(n,e={}){const t=[],r=new Set;for(const i of n){const a=i.name;if(r.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);r.add(a);const c=ZP(i,e);c.functionDeclarations&&t.push(...c.functionDeclarations)}return{functionDeclarations:t}}function dE(n,e){if(typeof e!="string"&&!Array.isArray(e)){if(n&&n.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function e1(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function na(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function fE(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function t1(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function n1(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function r1(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["fileUri"]);t!=null&&u(e,["fileUri"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function i1(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],t1(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],n1(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],r1(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function hE(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>i1(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function o1(n){const e={},t=l(n,["anyOf"]);t!=null&&u(e,["anyOf"],t);const r=l(n,["default"]);r!=null&&u(e,["default"],r);const i=l(n,["description"]);i!=null&&u(e,["description"],i);const a=l(n,["enum"]);a!=null&&u(e,["enum"],a);const c=l(n,["example"]);c!=null&&u(e,["example"],c);const f=l(n,["format"]);f!=null&&u(e,["format"],f);const m=l(n,["items"]);m!=null&&u(e,["items"],m);const p=l(n,["maxItems"]);p!=null&&u(e,["maxItems"],p);const y=l(n,["maxLength"]);y!=null&&u(e,["maxLength"],y);const T=l(n,["maxProperties"]);T!=null&&u(e,["maxProperties"],T);const C=l(n,["maximum"]);C!=null&&u(e,["maximum"],C);const A=l(n,["minItems"]);A!=null&&u(e,["minItems"],A);const L=l(n,["minLength"]);L!=null&&u(e,["minLength"],L);const U=l(n,["minProperties"]);U!=null&&u(e,["minProperties"],U);const O=l(n,["minimum"]);O!=null&&u(e,["minimum"],O);const K=l(n,["nullable"]);K!=null&&u(e,["nullable"],K);const W=l(n,["pattern"]);W!=null&&u(e,["pattern"],W);const Y=l(n,["properties"]);Y!=null&&u(e,["properties"],Y);const re=l(n,["propertyOrdering"]);re!=null&&u(e,["propertyOrdering"],re);const le=l(n,["required"]);le!=null&&u(e,["required"],le);const Z=l(n,["title"]);Z!=null&&u(e,["title"],Z);const D=l(n,["type"]);return D!=null&&u(e,["type"],D),e}function s1(n){const e={};if(l(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=l(n,["category"]);t!=null&&u(e,["category"],t);const r=l(n,["threshold"]);return r!=null&&u(e,["threshold"],r),e}function a1(n){const e={},t=l(n,["behavior"]);t!=null&&u(e,["behavior"],t);const r=l(n,["description"]);r!=null&&u(e,["description"],r);const i=l(n,["name"]);i!=null&&u(e,["name"],i);const a=l(n,["parameters"]);a!=null&&u(e,["parameters"],a);const c=l(n,["parametersJsonSchema"]);c!=null&&u(e,["parametersJsonSchema"],c);const f=l(n,["response"]);f!=null&&u(e,["response"],f);const m=l(n,["responseJsonSchema"]);return m!=null&&u(e,["responseJsonSchema"],m),e}function l1(n){const e={},t=l(n,["startTime"]);t!=null&&u(e,["startTime"],t);const r=l(n,["endTime"]);return r!=null&&u(e,["endTime"],r),e}function u1(n){const e={},t=l(n,["timeRangeFilter"]);if(t!=null&&u(e,["timeRangeFilter"],l1(t)),l(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function c1(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["dynamicThreshold"]);return r!=null&&u(e,["dynamicThreshold"],r),e}function d1(n){const e={},t=l(n,["dynamicRetrievalConfig"]);return t!=null&&u(e,["dynamicRetrievalConfig"],c1(t)),e}function f1(){return{}}function h1(n){const e={},t=l(n,["environment"]);return t!=null&&u(e,["environment"],t),e}function p1(n){const e={},t=l(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>a1(p))),u(e,["functionDeclarations"],m)}if(l(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(n,["googleSearch"]);r!=null&&u(e,["googleSearch"],u1(r));const i=l(n,["googleSearchRetrieval"]);if(i!=null&&u(e,["googleSearchRetrieval"],d1(i)),l(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(n,["urlContext"])!=null&&u(e,["urlContext"],f1());const c=l(n,["computerUse"]);c!=null&&u(e,["computerUse"],h1(c));const f=l(n,["codeExecution"]);return f!=null&&u(e,["codeExecution"],f),e}function m1(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["allowedFunctionNames"]);return r!=null&&u(e,["allowedFunctionNames"],r),e}function g1(n){const e={},t=l(n,["latitude"]);t!=null&&u(e,["latitude"],t);const r=l(n,["longitude"]);return r!=null&&u(e,["longitude"],r),e}function y1(n){const e={},t=l(n,["latLng"]);t!=null&&u(e,["latLng"],g1(t));const r=l(n,["languageCode"]);return r!=null&&u(e,["languageCode"],r),e}function v1(n){const e={},t=l(n,["functionCallingConfig"]);t!=null&&u(e,["functionCallingConfig"],m1(t));const r=l(n,["retrievalConfig"]);return r!=null&&u(e,["retrievalConfig"],y1(r)),e}function _1(n){const e={},t=l(n,["voiceName"]);return t!=null&&u(e,["voiceName"],t),e}function pE(n){const e={},t=l(n,["prebuiltVoiceConfig"]);return t!=null&&u(e,["prebuiltVoiceConfig"],_1(t)),e}function T1(n){const e={},t=l(n,["speaker"]);t!=null&&u(e,["speaker"],t);const r=l(n,["voiceConfig"]);return r!=null&&u(e,["voiceConfig"],pE(r)),e}function E1(n){const e={},t=l(n,["speakerVoiceConfigs"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>T1(i))),u(e,["speakerVoiceConfigs"],r)}return e}function C1(n){const e={},t=l(n,["voiceConfig"]);t!=null&&u(e,["voiceConfig"],pE(t));const r=l(n,["multiSpeakerVoiceConfig"]);r!=null&&u(e,["multiSpeakerVoiceConfig"],E1(r));const i=l(n,["languageCode"]);return i!=null&&u(e,["languageCode"],i),e}function w1(n){const e={},t=l(n,["includeThoughts"]);t!=null&&u(e,["includeThoughts"],t);const r=l(n,["thinkingBudget"]);return r!=null&&u(e,["thinkingBudget"],r),e}function S1(n,e,t){const r={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&u(t,["systemInstruction"],hE(Zt(i)));const a=l(e,["temperature"]);a!=null&&u(r,["temperature"],a);const c=l(e,["topP"]);c!=null&&u(r,["topP"],c);const f=l(e,["topK"]);f!=null&&u(r,["topK"],f);const m=l(e,["candidateCount"]);m!=null&&u(r,["candidateCount"],m);const p=l(e,["maxOutputTokens"]);p!=null&&u(r,["maxOutputTokens"],p);const y=l(e,["stopSequences"]);y!=null&&u(r,["stopSequences"],y);const T=l(e,["responseLogprobs"]);T!=null&&u(r,["responseLogprobs"],T);const C=l(e,["logprobs"]);C!=null&&u(r,["logprobs"],C);const A=l(e,["presencePenalty"]);A!=null&&u(r,["presencePenalty"],A);const L=l(e,["frequencyPenalty"]);L!=null&&u(r,["frequencyPenalty"],L);const U=l(e,["seed"]);U!=null&&u(r,["seed"],U);const O=l(e,["responseMimeType"]);O!=null&&u(r,["responseMimeType"],O);const K=l(e,["responseSchema"]);K!=null&&u(r,["responseSchema"],o1(yp(K)));const W=l(e,["responseJsonSchema"]);if(W!=null&&u(r,["responseJsonSchema"],W),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Y=l(e,["safetySettings"]);if(t!==void 0&&Y!=null){let N=Y;Array.isArray(N)&&(N=N.map(b=>s1(b))),u(t,["safetySettings"],N)}const re=l(e,["tools"]);if(t!==void 0&&re!=null){let N=ta(re);Array.isArray(N)&&(N=N.map(b=>p1(ea(b)))),u(t,["tools"],N)}const le=l(e,["toolConfig"]);if(t!==void 0&&le!=null&&u(t,["toolConfig"],v1(le)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Z=l(e,["cachedContent"]);t!==void 0&&Z!=null&&u(t,["cachedContent"],ei(n,Z));const D=l(e,["responseModalities"]);D!=null&&u(r,["responseModalities"],D);const k=l(e,["mediaResolution"]);k!=null&&u(r,["mediaResolution"],k);const x=l(e,["speechConfig"]);if(x!=null&&u(r,["speechConfig"],C1(vp(x))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=l(e,["thinkingConfig"]);return P!=null&&u(r,["thinkingConfig"],w1(P)),r}function I1(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["request","model"],Xe(n,r));const i=l(e,["contents"]);if(i!=null){let c=Vn(i);Array.isArray(c)&&(c=c.map(f=>hE(f))),u(t,["request","contents"],c)}const a=l(e,["config"]);return a!=null&&u(t,["request","generationConfig"],S1(n,a,t)),t}function A1(n,e){const t={};if(l(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=l(e,["fileName"]);r!=null&&u(t,["fileName"],r);const i=l(e,["inlinedRequests"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>I1(n,c))),u(t,["requests","requests"],a)}return t}function x1(n,e){const t={},r=l(n,["displayName"]);if(e!==void 0&&r!=null&&u(e,["batch","displayName"],r),l(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function a_(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["src"]);i!=null&&u(t,["batch","inputConfig"],A1(n,dE(n,i)));const a=l(e,["config"]);return a!=null&&u(t,["config"],x1(a,t)),t}function k1(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],na(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function R1(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],na(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function P1(n,e){const t={},r=l(n,["pageSize"]);e!==void 0&&r!=null&&u(e,["_query","pageSize"],r);const i=l(n,["pageToken"]);if(e!==void 0&&i!=null&&u(e,["_query","pageToken"],i),l(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function N1(n){const e={},t=l(n,["config"]);return t!=null&&u(e,["config"],P1(t,e)),e}function M1(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],na(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function D1(n){const e={},t=l(n,["format"]);t!=null&&u(e,["instancesFormat"],t);const r=l(n,["gcsUri"]);r!=null&&u(e,["gcsSource","uris"],r);const i=l(n,["bigqueryUri"]);if(i!=null&&u(e,["bigquerySource","inputUri"],i),l(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function V1(n){const e={},t=l(n,["format"]);t!=null&&u(e,["predictionsFormat"],t);const r=l(n,["gcsUri"]);r!=null&&u(e,["gcsDestination","outputUriPrefix"],r);const i=l(n,["bigqueryUri"]);if(i!=null&&u(e,["bigqueryDestination","outputUri"],i),l(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function L1(n,e){const t={},r=l(n,["displayName"]);e!==void 0&&r!=null&&u(e,["displayName"],r);const i=l(n,["dest"]);return e!==void 0&&i!=null&&u(e,["outputConfig"],V1(e1(i))),t}function b1(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["model"],Xe(n,r));const i=l(e,["src"]);i!=null&&u(t,["inputConfig"],D1(dE(n,i)));const a=l(e,["config"]);return a!=null&&u(t,["config"],L1(a,t)),t}function U1(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],na(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function F1(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],na(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function O1(n,e){const t={},r=l(n,["pageSize"]);e!==void 0&&r!=null&&u(e,["_query","pageSize"],r);const i=l(n,["pageToken"]);e!==void 0&&i!=null&&u(e,["_query","pageToken"],i);const a=l(n,["filter"]);return e!==void 0&&a!=null&&u(e,["_query","filter"],a),t}function B1(n){const e={},t=l(n,["config"]);return t!=null&&u(e,["config"],O1(t,e)),e}function q1(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],na(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function G1(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function H1(n){const e={},t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function $1(n){const e={},t=l(n,["fileUri"]);t!=null&&u(e,["fileUri"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function z1(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],G1(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],H1(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],$1(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function W1(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>z1(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function J1(n){const e={},t=l(n,["citationSources"]);return t!=null&&u(e,["citations"],t),e}function K1(n){const e={},t=l(n,["retrievedUrl"]);t!=null&&u(e,["retrievedUrl"],t);const r=l(n,["urlRetrievalStatus"]);return r!=null&&u(e,["urlRetrievalStatus"],r),e}function Y1(n){const e={},t=l(n,["urlMetadata"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>K1(i))),u(e,["urlMetadata"],r)}return e}function Q1(n){const e={},t=l(n,["content"]);t!=null&&u(e,["content"],W1(t));const r=l(n,["citationMetadata"]);r!=null&&u(e,["citationMetadata"],J1(r));const i=l(n,["tokenCount"]);i!=null&&u(e,["tokenCount"],i);const a=l(n,["finishReason"]);a!=null&&u(e,["finishReason"],a);const c=l(n,["urlContextMetadata"]);c!=null&&u(e,["urlContextMetadata"],Y1(c));const f=l(n,["avgLogprobs"]);f!=null&&u(e,["avgLogprobs"],f);const m=l(n,["groundingMetadata"]);m!=null&&u(e,["groundingMetadata"],m);const p=l(n,["index"]);p!=null&&u(e,["index"],p);const y=l(n,["logprobsResult"]);y!=null&&u(e,["logprobsResult"],y);const T=l(n,["safetyRatings"]);return T!=null&&u(e,["safetyRatings"],T),e}function X1(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["candidates"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(p=>Q1(p))),u(e,["candidates"],m)}const i=l(n,["modelVersion"]);i!=null&&u(e,["modelVersion"],i);const a=l(n,["promptFeedback"]);a!=null&&u(e,["promptFeedback"],a);const c=l(n,["responseId"]);c!=null&&u(e,["responseId"],c);const f=l(n,["usageMetadata"]);return f!=null&&u(e,["usageMetadata"],f),e}function mE(n){const e={},t=l(n,["details"]);t!=null&&u(e,["details"],t);const r=l(n,["code"]);r!=null&&u(e,["code"],r);const i=l(n,["message"]);return i!=null&&u(e,["message"],i),e}function Z1(n){const e={},t=l(n,["response"]);t!=null&&u(e,["response"],X1(t));const r=l(n,["error"]);return r!=null&&u(e,["error"],mE(r)),e}function j1(n){const e={},t=l(n,["responsesFile"]);t!=null&&u(e,["fileName"],t);const r=l(n,["inlinedResponses","inlinedResponses"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(a=>Z1(a))),u(e,["inlinedResponses"],i)}return e}function rc(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["metadata","displayName"]);r!=null&&u(e,["displayName"],r);const i=l(n,["metadata","state"]);i!=null&&u(e,["state"],fE(i));const a=l(n,["metadata","createTime"]);a!=null&&u(e,["createTime"],a);const c=l(n,["metadata","endTime"]);c!=null&&u(e,["endTime"],c);const f=l(n,["metadata","updateTime"]);f!=null&&u(e,["updateTime"],f);const m=l(n,["metadata","model"]);m!=null&&u(e,["model"],m);const p=l(n,["metadata","output"]);return p!=null&&u(e,["dest"],j1(p)),e}function eN(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["operations"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>rc(c))),u(e,["batchJobs"],a)}return e}function tN(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["name"]);r!=null&&u(e,["name"],r);const i=l(n,["done"]);i!=null&&u(e,["done"],i);const a=l(n,["error"]);return a!=null&&u(e,["error"],mE(a)),e}function gE(n){const e={},t=l(n,["details"]);t!=null&&u(e,["details"],t);const r=l(n,["code"]);r!=null&&u(e,["code"],r);const i=l(n,["message"]);return i!=null&&u(e,["message"],i),e}function nN(n){const e={},t=l(n,["instancesFormat"]);t!=null&&u(e,["format"],t);const r=l(n,["gcsSource","uris"]);r!=null&&u(e,["gcsUri"],r);const i=l(n,["bigquerySource","inputUri"]);return i!=null&&u(e,["bigqueryUri"],i),e}function rN(n){const e={},t=l(n,["predictionsFormat"]);t!=null&&u(e,["format"],t);const r=l(n,["gcsDestination","outputUriPrefix"]);r!=null&&u(e,["gcsUri"],r);const i=l(n,["bigqueryDestination","outputUri"]);return i!=null&&u(e,["bigqueryUri"],i),e}function mh(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["displayName"]);r!=null&&u(e,["displayName"],r);const i=l(n,["state"]);i!=null&&u(e,["state"],fE(i));const a=l(n,["error"]);a!=null&&u(e,["error"],gE(a));const c=l(n,["createTime"]);c!=null&&u(e,["createTime"],c);const f=l(n,["startTime"]);f!=null&&u(e,["startTime"],f);const m=l(n,["endTime"]);m!=null&&u(e,["endTime"],m);const p=l(n,["updateTime"]);p!=null&&u(e,["updateTime"],p);const y=l(n,["model"]);y!=null&&u(e,["model"],y);const T=l(n,["inputConfig"]);T!=null&&u(e,["src"],nN(T));const C=l(n,["outputConfig"]);return C!=null&&u(e,["dest"],rN(C)),e}function iN(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["batchPredictionJobs"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>mh(c))),u(e,["batchJobs"],a)}return e}function oN(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["name"]);r!=null&&u(e,["name"],r);const i=l(n,["done"]);i!=null&&u(e,["done"],i);const a=l(n,["error"]);return a!=null&&u(e,["error"],gE(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Lo;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Lo||(Lo={}));class wl{constructor(e,t,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,i)}init(e,t,r){var i,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!r||Object.keys(r).length===0?c={config:{}}:typeof r=="object"?c=Object.assign({},r):c=r,c.config&&(c.config.pageToken=t.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(a=(i=c.config)===null||i===void 0?void 0:i.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sN extends Bo{constructor(e){super(),this.apiClient=e,this.create=async t=>{var r,i;if(this.apiClient.isVertexAI()){const c=Date.now().toString();if(Array.isArray(t.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(t.config=t.config||{},t.config.displayName===void 0&&(t.config.displayName="genaiBatchJob_${timestampStr}"),t.config.dest===void 0&&typeof t.src=="string")if(t.src.startsWith("gs://")&&t.src.endsWith(".jsonl"))t.config.dest=`${t.src.slice(0,-6)}/dest`;else if(t.src.startsWith("bq://"))t.config.dest=`${t.src}_dest_${c}`;else throw new Error("Unsupported source:"+t.src)}else if(Array.isArray(t.src)||typeof t.src!="string"&&t.src.inlinedRequests){let a="",c={};const f=a_(this.apiClient,t);a=me("{model}:batchGenerateContent",f._url),c=f._query;const y=f.batch.inputConfig.requests,T=y.requests,C=[];for(const L of T){const U=L;if(U.systemInstruction){const O=U.systemInstruction;delete U.systemInstruction;const K=U.request;K.systemInstruction=O,U.request=K}C.push(U)}return y.requests=C,delete f.config,delete f._url,delete f._query,this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(L=>L.json()).then(L=>rc(L))}return await this.createInternal(t)},this.list=async(t={})=>new wl(Lo.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(t),t)}async createInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=b1(this.apiClient,e);return f=me("batchPredictionJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c.then(y=>mh(y))}else{const p=a_(this.apiClient,e);return f=me("{model}:batchGenerateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>rc(y))}}async get(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=U1(this.apiClient,e);return f=me("batchPredictionJobs/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c.then(y=>mh(y))}else{const p=k1(this.apiClient,e);return f=me("batches/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>rc(y))}}async cancel(e){var t,r,i,a;let c="",f={};if(this.apiClient.isVertexAI()){const m=F1(this.apiClient,e);c=me("batchPredictionJobs/{name}:cancel",m._url),f=m._query,delete m.config,delete m._url,delete m._query,await this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const m=R1(this.apiClient,e);c=me("batches/{name}:cancel",m._url),f=m._query,delete m.config,delete m._url,delete m._query,await this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=B1(e);return f=me("batchPredictionJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=iN(y),C=new r_;return Object.assign(C,T),C})}else{const p=N1(e);return f=me("batches",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=eN(y),C=new r_;return Object.assign(C,T),C})}}async delete(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=q1(this.apiClient,e);return f=me("batchPredictionJobs/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>oN(y))}else{const p=M1(this.apiClient,e);return f=me("batches/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>tN(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aN(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function lN(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function uN(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["fileUri"]);t!=null&&u(e,["fileUri"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function cN(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],aN(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],lN(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],uN(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function l_(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>cN(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function dN(n){const e={},t=l(n,["behavior"]);t!=null&&u(e,["behavior"],t);const r=l(n,["description"]);r!=null&&u(e,["description"],r);const i=l(n,["name"]);i!=null&&u(e,["name"],i);const a=l(n,["parameters"]);a!=null&&u(e,["parameters"],a);const c=l(n,["parametersJsonSchema"]);c!=null&&u(e,["parametersJsonSchema"],c);const f=l(n,["response"]);f!=null&&u(e,["response"],f);const m=l(n,["responseJsonSchema"]);return m!=null&&u(e,["responseJsonSchema"],m),e}function fN(n){const e={},t=l(n,["startTime"]);t!=null&&u(e,["startTime"],t);const r=l(n,["endTime"]);return r!=null&&u(e,["endTime"],r),e}function hN(n){const e={},t=l(n,["timeRangeFilter"]);if(t!=null&&u(e,["timeRangeFilter"],fN(t)),l(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function pN(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["dynamicThreshold"]);return r!=null&&u(e,["dynamicThreshold"],r),e}function mN(n){const e={},t=l(n,["dynamicRetrievalConfig"]);return t!=null&&u(e,["dynamicRetrievalConfig"],pN(t)),e}function gN(){return{}}function yN(n){const e={},t=l(n,["environment"]);return t!=null&&u(e,["environment"],t),e}function vN(n){const e={},t=l(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>dN(p))),u(e,["functionDeclarations"],m)}if(l(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(n,["googleSearch"]);r!=null&&u(e,["googleSearch"],hN(r));const i=l(n,["googleSearchRetrieval"]);if(i!=null&&u(e,["googleSearchRetrieval"],mN(i)),l(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(n,["urlContext"])!=null&&u(e,["urlContext"],gN());const c=l(n,["computerUse"]);c!=null&&u(e,["computerUse"],yN(c));const f=l(n,["codeExecution"]);return f!=null&&u(e,["codeExecution"],f),e}function _N(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["allowedFunctionNames"]);return r!=null&&u(e,["allowedFunctionNames"],r),e}function TN(n){const e={},t=l(n,["latitude"]);t!=null&&u(e,["latitude"],t);const r=l(n,["longitude"]);return r!=null&&u(e,["longitude"],r),e}function EN(n){const e={},t=l(n,["latLng"]);t!=null&&u(e,["latLng"],TN(t));const r=l(n,["languageCode"]);return r!=null&&u(e,["languageCode"],r),e}function CN(n){const e={},t=l(n,["functionCallingConfig"]);t!=null&&u(e,["functionCallingConfig"],_N(t));const r=l(n,["retrievalConfig"]);return r!=null&&u(e,["retrievalConfig"],EN(r)),e}function wN(n,e){const t={},r=l(n,["ttl"]);e!==void 0&&r!=null&&u(e,["ttl"],r);const i=l(n,["expireTime"]);e!==void 0&&i!=null&&u(e,["expireTime"],i);const a=l(n,["displayName"]);e!==void 0&&a!=null&&u(e,["displayName"],a);const c=l(n,["contents"]);if(e!==void 0&&c!=null){let y=Vn(c);Array.isArray(y)&&(y=y.map(T=>l_(T))),u(e,["contents"],y)}const f=l(n,["systemInstruction"]);e!==void 0&&f!=null&&u(e,["systemInstruction"],l_(Zt(f)));const m=l(n,["tools"]);if(e!==void 0&&m!=null){let y=m;Array.isArray(y)&&(y=y.map(T=>vN(T))),u(e,["tools"],y)}const p=l(n,["toolConfig"]);if(e!==void 0&&p!=null&&u(e,["toolConfig"],CN(p)),l(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function SN(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["model"],tE(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],wN(i,t)),t}function IN(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],ei(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function AN(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],ei(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function xN(n,e){const t={},r=l(n,["ttl"]);e!==void 0&&r!=null&&u(e,["ttl"],r);const i=l(n,["expireTime"]);return e!==void 0&&i!=null&&u(e,["expireTime"],i),t}function kN(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],ei(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],xN(i,t)),t}function RN(n,e){const t={},r=l(n,["pageSize"]);e!==void 0&&r!=null&&u(e,["_query","pageSize"],r);const i=l(n,["pageToken"]);return e!==void 0&&i!=null&&u(e,["_query","pageToken"],i),t}function PN(n){const e={},t=l(n,["config"]);return t!=null&&u(e,["config"],RN(t,e)),e}function NN(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function MN(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["data"]);r!=null&&u(e,["data"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function DN(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["fileUri"]);r!=null&&u(e,["fileUri"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function VN(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],NN(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],MN(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],DN(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function u_(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>VN(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function LN(n){const e={};if(l(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=l(n,["description"]);t!=null&&u(e,["description"],t);const r=l(n,["name"]);r!=null&&u(e,["name"],r);const i=l(n,["parameters"]);i!=null&&u(e,["parameters"],i);const a=l(n,["parametersJsonSchema"]);a!=null&&u(e,["parametersJsonSchema"],a);const c=l(n,["response"]);c!=null&&u(e,["response"],c);const f=l(n,["responseJsonSchema"]);return f!=null&&u(e,["responseJsonSchema"],f),e}function bN(n){const e={},t=l(n,["startTime"]);t!=null&&u(e,["startTime"],t);const r=l(n,["endTime"]);return r!=null&&u(e,["endTime"],r),e}function UN(n){const e={},t=l(n,["timeRangeFilter"]);t!=null&&u(e,["timeRangeFilter"],bN(t));const r=l(n,["excludeDomains"]);return r!=null&&u(e,["excludeDomains"],r),e}function FN(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["dynamicThreshold"]);return r!=null&&u(e,["dynamicThreshold"],r),e}function ON(n){const e={},t=l(n,["dynamicRetrievalConfig"]);return t!=null&&u(e,["dynamicRetrievalConfig"],FN(t)),e}function BN(n){const e={},t=l(n,["excludeDomains"]);return t!=null&&u(e,["excludeDomains"],t),e}function qN(n){const e={},t=l(n,["apiKeyString"]);return t!=null&&u(e,["apiKeyString"],t),e}function GN(n){const e={},t=l(n,["apiKeyConfig"]);t!=null&&u(e,["apiKeyConfig"],qN(t));const r=l(n,["authType"]);r!=null&&u(e,["authType"],r);const i=l(n,["googleServiceAccountConfig"]);i!=null&&u(e,["googleServiceAccountConfig"],i);const a=l(n,["httpBasicAuthConfig"]);a!=null&&u(e,["httpBasicAuthConfig"],a);const c=l(n,["oauthConfig"]);c!=null&&u(e,["oauthConfig"],c);const f=l(n,["oidcConfig"]);return f!=null&&u(e,["oidcConfig"],f),e}function HN(n){const e={},t=l(n,["authConfig"]);return t!=null&&u(e,["authConfig"],GN(t)),e}function $N(){return{}}function zN(n){const e={},t=l(n,["environment"]);return t!=null&&u(e,["environment"],t),e}function WN(n){const e={},t=l(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(C=>LN(C))),u(e,["functionDeclarations"],T)}const r=l(n,["retrieval"]);r!=null&&u(e,["retrieval"],r);const i=l(n,["googleSearch"]);i!=null&&u(e,["googleSearch"],UN(i));const a=l(n,["googleSearchRetrieval"]);a!=null&&u(e,["googleSearchRetrieval"],ON(a));const c=l(n,["enterpriseWebSearch"]);c!=null&&u(e,["enterpriseWebSearch"],BN(c));const f=l(n,["googleMaps"]);f!=null&&u(e,["googleMaps"],HN(f)),l(n,["urlContext"])!=null&&u(e,["urlContext"],$N());const p=l(n,["computerUse"]);p!=null&&u(e,["computerUse"],zN(p));const y=l(n,["codeExecution"]);return y!=null&&u(e,["codeExecution"],y),e}function JN(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["allowedFunctionNames"]);return r!=null&&u(e,["allowedFunctionNames"],r),e}function KN(n){const e={},t=l(n,["latitude"]);t!=null&&u(e,["latitude"],t);const r=l(n,["longitude"]);return r!=null&&u(e,["longitude"],r),e}function YN(n){const e={},t=l(n,["latLng"]);t!=null&&u(e,["latLng"],KN(t));const r=l(n,["languageCode"]);return r!=null&&u(e,["languageCode"],r),e}function QN(n){const e={},t=l(n,["functionCallingConfig"]);t!=null&&u(e,["functionCallingConfig"],JN(t));const r=l(n,["retrievalConfig"]);return r!=null&&u(e,["retrievalConfig"],YN(r)),e}function XN(n,e){const t={},r=l(n,["ttl"]);e!==void 0&&r!=null&&u(e,["ttl"],r);const i=l(n,["expireTime"]);e!==void 0&&i!=null&&u(e,["expireTime"],i);const a=l(n,["displayName"]);e!==void 0&&a!=null&&u(e,["displayName"],a);const c=l(n,["contents"]);if(e!==void 0&&c!=null){let T=Vn(c);Array.isArray(T)&&(T=T.map(C=>u_(C))),u(e,["contents"],T)}const f=l(n,["systemInstruction"]);e!==void 0&&f!=null&&u(e,["systemInstruction"],u_(Zt(f)));const m=l(n,["tools"]);if(e!==void 0&&m!=null){let T=m;Array.isArray(T)&&(T=T.map(C=>WN(C))),u(e,["tools"],T)}const p=l(n,["toolConfig"]);e!==void 0&&p!=null&&u(e,["toolConfig"],QN(p));const y=l(n,["kmsKeyName"]);return e!==void 0&&y!=null&&u(e,["encryption_spec","kmsKeyName"],y),t}function ZN(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["model"],tE(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],XN(i,t)),t}function jN(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],ei(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function eM(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],ei(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function tM(n,e){const t={},r=l(n,["ttl"]);e!==void 0&&r!=null&&u(e,["ttl"],r);const i=l(n,["expireTime"]);return e!==void 0&&i!=null&&u(e,["expireTime"],i),t}function nM(n,e){const t={},r=l(e,["name"]);r!=null&&u(t,["_url","name"],ei(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],tM(i,t)),t}function rM(n,e){const t={},r=l(n,["pageSize"]);e!==void 0&&r!=null&&u(e,["_query","pageSize"],r);const i=l(n,["pageToken"]);return e!==void 0&&i!=null&&u(e,["_query","pageToken"],i),t}function iM(n){const e={},t=l(n,["config"]);return t!=null&&u(e,["config"],rM(t,e)),e}function ic(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["displayName"]);r!=null&&u(e,["displayName"],r);const i=l(n,["model"]);i!=null&&u(e,["model"],i);const a=l(n,["createTime"]);a!=null&&u(e,["createTime"],a);const c=l(n,["updateTime"]);c!=null&&u(e,["updateTime"],c);const f=l(n,["expireTime"]);f!=null&&u(e,["expireTime"],f);const m=l(n,["usageMetadata"]);return m!=null&&u(e,["usageMetadata"],m),e}function oM(n){const e={},t=l(n,["sdkHttpResponse"]);return t!=null&&u(e,["sdkHttpResponse"],t),e}function sM(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>ic(c))),u(e,["cachedContents"],a)}return e}function oc(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["displayName"]);r!=null&&u(e,["displayName"],r);const i=l(n,["model"]);i!=null&&u(e,["model"],i);const a=l(n,["createTime"]);a!=null&&u(e,["createTime"],a);const c=l(n,["updateTime"]);c!=null&&u(e,["updateTime"],c);const f=l(n,["expireTime"]);f!=null&&u(e,["expireTime"],f);const m=l(n,["usageMetadata"]);return m!=null&&u(e,["usageMetadata"],m),e}function aM(n){const e={},t=l(n,["sdkHttpResponse"]);return t!=null&&u(e,["sdkHttpResponse"],t),e}function lM(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>oc(c))),u(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uM extends Bo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new wl(Lo.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=ZN(this.apiClient,e);return f=me("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c.then(y=>oc(y))}else{const p=SN(this.apiClient,e);return f=me("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>ic(y))}}async get(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=jN(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c.then(y=>oc(y))}else{const p=IN(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>ic(y))}}async delete(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=eM(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=aM(y),C=new t_;return Object.assign(C,T),C})}else{const p=AN(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=oM(y),C=new t_;return Object.assign(C,T),C})}}async update(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=nM(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c.then(y=>oc(y))}else{const p=kN(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>ic(y))}}async listInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=iM(e);return f=me("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=lM(y),C=new n_;return Object.assign(C,T),C})}else{const p=PN(e);return f=me("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=sM(y),C=new n_;return Object.assign(C,T),C})}}}function c_(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ot(n){return this instanceof ot?(this.v=n,this):new ot(n)}function Us(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",c),i[Symbol.asyncIterator]=function(){return this},i;function c(A){return function(L){return Promise.resolve(L).then(A,T)}}function f(A,L){r[A]&&(i[A]=function(U){return new Promise(function(O,K){a.push([A,U,O,K])>1||m(A,U)})},L&&(i[A]=L(i[A])))}function m(A,L){try{p(r[A](L))}catch(U){C(a[0][3],U)}}function p(A){A.value instanceof ot?Promise.resolve(A.value.v).then(y,T):C(a[0][2],A)}function y(A){m("next",A)}function T(A){m("throw",A)}function C(A,L){A(L),a.shift(),a.length&&m(a[0][0],a[0][1])}}function tl(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof c_=="function"?c_(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(c){return new Promise(function(f,m){c=n[a](c),i(f,m,c.done,c.value)})}}function i(a,c,f,m){Promise.resolve(m).then(function(p){a({value:p,done:f})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cM(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:yE(t)}function yE(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function dM(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function d_(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const i=[];let a=!0;for(;r<t&&n[r].role==="model";)i.push(n[r]),a&&!yE(n[r])&&(a=!1),r++;a?e.push(...i):e.pop()}return e}class fM{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new hM(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class hM{constructor(e,t,r,i={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=i,this.history=a,this.sendPromise=Promise.resolve(),dM(a)}async sendMessage(e){var t;await this.sendPromise;const r=Zt(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,c,f;const m=await i,p=(c=(a=m.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content,y=m.automaticFunctionCallingHistory,T=this.getHistory(!0).length;let C=[];y!=null&&(C=(f=y.slice(T))!==null&&f!==void 0?f:[]);const A=p?[p]:[];this.recordHistory(r,A,C)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const r=Zt(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const a=await i;return this.processStreamResponse(a,r)}getHistory(e=!1){const t=e?d_(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,i;return Us(this,arguments,function*(){var c,f,m,p;const y=[];try{for(var T=!0,C=tl(e),A;A=yield ot(C.next()),c=A.done,!c;T=!0){p=A.value,T=!1;const L=p;if(cM(L)){const U=(i=(r=L.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;U!==void 0&&y.push(U)}yield yield ot(L)}}catch(L){f={error:L}}finally{try{!T&&!c&&(m=C.return)&&(yield ot(m.call(C)))}finally{if(f)throw f.error}}this.recordHistory(t,y)})}recordHistory(e,t,r){let i=[];t.length>0&&t.every(a=>a.role!==void 0)?i=t:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...d_(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zc extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,zc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pM(n,e){const t={},r=l(n,["pageSize"]);e!==void 0&&r!=null&&u(e,["_query","pageSize"],r);const i=l(n,["pageToken"]);return e!==void 0&&i!=null&&u(e,["_query","pageToken"],i),t}function mM(n){const e={},t=l(n,["config"]);return t!=null&&u(e,["config"],pM(t,e)),e}function gM(n){const e={},t=l(n,["details"]);t!=null&&u(e,["details"],t);const r=l(n,["message"]);r!=null&&u(e,["message"],r);const i=l(n,["code"]);return i!=null&&u(e,["code"],i),e}function yM(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["displayName"]);r!=null&&u(e,["displayName"],r);const i=l(n,["mimeType"]);i!=null&&u(e,["mimeType"],i);const a=l(n,["sizeBytes"]);a!=null&&u(e,["sizeBytes"],a);const c=l(n,["createTime"]);c!=null&&u(e,["createTime"],c);const f=l(n,["expirationTime"]);f!=null&&u(e,["expirationTime"],f);const m=l(n,["updateTime"]);m!=null&&u(e,["updateTime"],m);const p=l(n,["sha256Hash"]);p!=null&&u(e,["sha256Hash"],p);const y=l(n,["uri"]);y!=null&&u(e,["uri"],y);const T=l(n,["downloadUri"]);T!=null&&u(e,["downloadUri"],T);const C=l(n,["state"]);C!=null&&u(e,["state"],C);const A=l(n,["source"]);A!=null&&u(e,["source"],A);const L=l(n,["videoMetadata"]);L!=null&&u(e,["videoMetadata"],L);const U=l(n,["error"]);return U!=null&&u(e,["error"],gM(U)),e}function vM(n){const e={},t=l(n,["file"]);t!=null&&u(e,["file"],yM(t));const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}function _M(n){const e={},t=l(n,["name"]);t!=null&&u(e,["_url","file"],lE(t));const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}function TM(n){const e={},t=l(n,["name"]);t!=null&&u(e,["_url","file"],lE(t));const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}function EM(n){const e={},t=l(n,["details"]);t!=null&&u(e,["details"],t);const r=l(n,["message"]);r!=null&&u(e,["message"],r);const i=l(n,["code"]);return i!=null&&u(e,["code"],i),e}function gh(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["displayName"]);r!=null&&u(e,["displayName"],r);const i=l(n,["mimeType"]);i!=null&&u(e,["mimeType"],i);const a=l(n,["sizeBytes"]);a!=null&&u(e,["sizeBytes"],a);const c=l(n,["createTime"]);c!=null&&u(e,["createTime"],c);const f=l(n,["expirationTime"]);f!=null&&u(e,["expirationTime"],f);const m=l(n,["updateTime"]);m!=null&&u(e,["updateTime"],m);const p=l(n,["sha256Hash"]);p!=null&&u(e,["sha256Hash"],p);const y=l(n,["uri"]);y!=null&&u(e,["uri"],y);const T=l(n,["downloadUri"]);T!=null&&u(e,["downloadUri"],T);const C=l(n,["state"]);C!=null&&u(e,["state"],C);const A=l(n,["source"]);A!=null&&u(e,["source"],A);const L=l(n,["videoMetadata"]);L!=null&&u(e,["videoMetadata"],L);const U=l(n,["error"]);return U!=null&&u(e,["error"],EM(U)),e}function CM(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["files"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>gh(c))),u(e,["files"],a)}return e}function wM(n){const e={},t=l(n,["sdkHttpResponse"]);return t!=null&&u(e,["sdkHttpResponse"],t),e}function SM(n){const e={},t=l(n,["sdkHttpResponse"]);return t!=null&&u(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM extends Bo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new wl(Lo.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>gh(t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=mM(e);return a=me("files",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),i.then(m=>{const p=CM(m),y=new qP;return Object.assign(y,p),y})}}async createInternal(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=vM(e);return a=me("upload/v1beta/files",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),i.then(m=>{const p=wM(m),y=new GP;return Object.assign(y,p),y})}}async get(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=_M(e);return a=me("files/{file}",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),i.then(m=>gh(m))}}async delete(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=TM(e);return a=me("files/{file}",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),i.then(m=>{const p=SM(m),y=new HP;return Object.assign(y,p),y})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AM(n){const e={},t=l(n,["voiceName"]);return t!=null&&u(e,["voiceName"],t),e}function vE(n){const e={},t=l(n,["prebuiltVoiceConfig"]);return t!=null&&u(e,["prebuiltVoiceConfig"],AM(t)),e}function xM(n){const e={},t=l(n,["speaker"]);t!=null&&u(e,["speaker"],t);const r=l(n,["voiceConfig"]);return r!=null&&u(e,["voiceConfig"],vE(r)),e}function kM(n){const e={},t=l(n,["speakerVoiceConfigs"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>xM(i))),u(e,["speakerVoiceConfigs"],r)}return e}function RM(n){const e={},t=l(n,["voiceConfig"]);t!=null&&u(e,["voiceConfig"],vE(t));const r=l(n,["multiSpeakerVoiceConfig"]);r!=null&&u(e,["multiSpeakerVoiceConfig"],kM(r));const i=l(n,["languageCode"]);return i!=null&&u(e,["languageCode"],i),e}function PM(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function NM(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function MM(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["fileUri"]);t!=null&&u(e,["fileUri"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function DM(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],PM(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],NM(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],MM(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function VM(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>DM(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function LM(n){const e={},t=l(n,["behavior"]);t!=null&&u(e,["behavior"],t);const r=l(n,["description"]);r!=null&&u(e,["description"],r);const i=l(n,["name"]);i!=null&&u(e,["name"],i);const a=l(n,["parameters"]);a!=null&&u(e,["parameters"],a);const c=l(n,["parametersJsonSchema"]);c!=null&&u(e,["parametersJsonSchema"],c);const f=l(n,["response"]);f!=null&&u(e,["response"],f);const m=l(n,["responseJsonSchema"]);return m!=null&&u(e,["responseJsonSchema"],m),e}function bM(n){const e={},t=l(n,["startTime"]);t!=null&&u(e,["startTime"],t);const r=l(n,["endTime"]);return r!=null&&u(e,["endTime"],r),e}function UM(n){const e={},t=l(n,["timeRangeFilter"]);if(t!=null&&u(e,["timeRangeFilter"],bM(t)),l(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function FM(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["dynamicThreshold"]);return r!=null&&u(e,["dynamicThreshold"],r),e}function OM(n){const e={},t=l(n,["dynamicRetrievalConfig"]);return t!=null&&u(e,["dynamicRetrievalConfig"],FM(t)),e}function BM(){return{}}function qM(n){const e={},t=l(n,["environment"]);return t!=null&&u(e,["environment"],t),e}function GM(n){const e={},t=l(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>LM(p))),u(e,["functionDeclarations"],m)}if(l(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(n,["googleSearch"]);r!=null&&u(e,["googleSearch"],UM(r));const i=l(n,["googleSearchRetrieval"]);if(i!=null&&u(e,["googleSearchRetrieval"],OM(i)),l(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(n,["urlContext"])!=null&&u(e,["urlContext"],BM());const c=l(n,["computerUse"]);c!=null&&u(e,["computerUse"],qM(c));const f=l(n,["codeExecution"]);return f!=null&&u(e,["codeExecution"],f),e}function HM(n){const e={},t=l(n,["handle"]);if(t!=null&&u(e,["handle"],t),l(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function f_(){return{}}function $M(n){const e={},t=l(n,["disabled"]);t!=null&&u(e,["disabled"],t);const r=l(n,["startOfSpeechSensitivity"]);r!=null&&u(e,["startOfSpeechSensitivity"],r);const i=l(n,["endOfSpeechSensitivity"]);i!=null&&u(e,["endOfSpeechSensitivity"],i);const a=l(n,["prefixPaddingMs"]);a!=null&&u(e,["prefixPaddingMs"],a);const c=l(n,["silenceDurationMs"]);return c!=null&&u(e,["silenceDurationMs"],c),e}function zM(n){const e={},t=l(n,["automaticActivityDetection"]);t!=null&&u(e,["automaticActivityDetection"],$M(t));const r=l(n,["activityHandling"]);r!=null&&u(e,["activityHandling"],r);const i=l(n,["turnCoverage"]);return i!=null&&u(e,["turnCoverage"],i),e}function WM(n){const e={},t=l(n,["targetTokens"]);return t!=null&&u(e,["targetTokens"],t),e}function JM(n){const e={},t=l(n,["triggerTokens"]);t!=null&&u(e,["triggerTokens"],t);const r=l(n,["slidingWindow"]);return r!=null&&u(e,["slidingWindow"],WM(r)),e}function KM(n){const e={},t=l(n,["proactiveAudio"]);return t!=null&&u(e,["proactiveAudio"],t),e}function YM(n,e){const t={},r=l(n,["generationConfig"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig"],r);const i=l(n,["responseModalities"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig","responseModalities"],i);const a=l(n,["temperature"]);e!==void 0&&a!=null&&u(e,["setup","generationConfig","temperature"],a);const c=l(n,["topP"]);e!==void 0&&c!=null&&u(e,["setup","generationConfig","topP"],c);const f=l(n,["topK"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","topK"],f);const m=l(n,["maxOutputTokens"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","maxOutputTokens"],m);const p=l(n,["mediaResolution"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","mediaResolution"],p);const y=l(n,["seed"]);e!==void 0&&y!=null&&u(e,["setup","generationConfig","seed"],y);const T=l(n,["speechConfig"]);e!==void 0&&T!=null&&u(e,["setup","generationConfig","speechConfig"],RM(_p(T)));const C=l(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],C);const A=l(n,["systemInstruction"]);e!==void 0&&A!=null&&u(e,["setup","systemInstruction"],VM(Zt(A)));const L=l(n,["tools"]);if(e!==void 0&&L!=null){let le=ta(L);Array.isArray(le)&&(le=le.map(Z=>GM(ea(Z)))),u(e,["setup","tools"],le)}const U=l(n,["sessionResumption"]);e!==void 0&&U!=null&&u(e,["setup","sessionResumption"],HM(U));const O=l(n,["inputAudioTranscription"]);e!==void 0&&O!=null&&u(e,["setup","inputAudioTranscription"],f_());const K=l(n,["outputAudioTranscription"]);e!==void 0&&K!=null&&u(e,["setup","outputAudioTranscription"],f_());const W=l(n,["realtimeInputConfig"]);e!==void 0&&W!=null&&u(e,["setup","realtimeInputConfig"],zM(W));const Y=l(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&u(e,["setup","contextWindowCompression"],JM(Y));const re=l(n,["proactivity"]);return e!==void 0&&re!=null&&u(e,["setup","proactivity"],KM(re)),t}function QM(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["setup","model"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],YM(i,t)),t}function XM(){return{}}function ZM(){return{}}function jM(n){const e={},t=l(n,["media"]);t!=null&&u(e,["mediaChunks"],nE(t));const r=l(n,["audio"]);r!=null&&u(e,["audio"],iE(r));const i=l(n,["audioStreamEnd"]);i!=null&&u(e,["audioStreamEnd"],i);const a=l(n,["video"]);a!=null&&u(e,["video"],rE(a));const c=l(n,["text"]);return c!=null&&u(e,["text"],c),l(n,["activityStart"])!=null&&u(e,["activityStart"],XM()),l(n,["activityEnd"])!=null&&u(e,["activityEnd"],ZM()),e}function _E(n){const e={},t=l(n,["text"]);t!=null&&u(e,["text"],t);const r=l(n,["weight"]);return r!=null&&u(e,["weight"],r),e}function eD(n){const e={},t=l(n,["weightedPrompts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>_E(i))),u(e,["weightedPrompts"],r)}return e}function TE(n){const e={},t=l(n,["temperature"]);t!=null&&u(e,["temperature"],t);const r=l(n,["topK"]);r!=null&&u(e,["topK"],r);const i=l(n,["seed"]);i!=null&&u(e,["seed"],i);const a=l(n,["guidance"]);a!=null&&u(e,["guidance"],a);const c=l(n,["bpm"]);c!=null&&u(e,["bpm"],c);const f=l(n,["density"]);f!=null&&u(e,["density"],f);const m=l(n,["brightness"]);m!=null&&u(e,["brightness"],m);const p=l(n,["scale"]);p!=null&&u(e,["scale"],p);const y=l(n,["muteBass"]);y!=null&&u(e,["muteBass"],y);const T=l(n,["muteDrums"]);T!=null&&u(e,["muteDrums"],T);const C=l(n,["onlyBassAndDrums"]);C!=null&&u(e,["onlyBassAndDrums"],C);const A=l(n,["musicGenerationMode"]);return A!=null&&u(e,["musicGenerationMode"],A),e}function tD(n){const e={},t=l(n,["musicGenerationConfig"]);return t!=null&&u(e,["musicGenerationConfig"],TE(t)),e}function EE(n){const e={},t=l(n,["model"]);return t!=null&&u(e,["model"],t),e}function CE(n){const e={},t=l(n,["weightedPrompts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>_E(i))),u(e,["weightedPrompts"],r)}return e}function yh(n){const e={},t=l(n,["setup"]);t!=null&&u(e,["setup"],EE(t));const r=l(n,["clientContent"]);r!=null&&u(e,["clientContent"],CE(r));const i=l(n,["musicGenerationConfig"]);i!=null&&u(e,["musicGenerationConfig"],TE(i));const a=l(n,["playbackControl"]);return a!=null&&u(e,["playbackControl"],a),e}function nD(n){const e={},t=l(n,["voiceName"]);return t!=null&&u(e,["voiceName"],t),e}function rD(n){const e={},t=l(n,["prebuiltVoiceConfig"]);return t!=null&&u(e,["prebuiltVoiceConfig"],nD(t)),e}function iD(n){const e={},t=l(n,["voiceConfig"]);if(t!=null&&u(e,["voiceConfig"],rD(t)),l(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=l(n,["languageCode"]);return r!=null&&u(e,["languageCode"],r),e}function oD(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function sD(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["data"]);r!=null&&u(e,["data"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function aD(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["fileUri"]);r!=null&&u(e,["fileUri"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function lD(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],oD(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],sD(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],aD(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function uD(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>lD(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function cD(n){const e={};if(l(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=l(n,["description"]);t!=null&&u(e,["description"],t);const r=l(n,["name"]);r!=null&&u(e,["name"],r);const i=l(n,["parameters"]);i!=null&&u(e,["parameters"],i);const a=l(n,["parametersJsonSchema"]);a!=null&&u(e,["parametersJsonSchema"],a);const c=l(n,["response"]);c!=null&&u(e,["response"],c);const f=l(n,["responseJsonSchema"]);return f!=null&&u(e,["responseJsonSchema"],f),e}function dD(n){const e={},t=l(n,["startTime"]);t!=null&&u(e,["startTime"],t);const r=l(n,["endTime"]);return r!=null&&u(e,["endTime"],r),e}function fD(n){const e={},t=l(n,["timeRangeFilter"]);t!=null&&u(e,["timeRangeFilter"],dD(t));const r=l(n,["excludeDomains"]);return r!=null&&u(e,["excludeDomains"],r),e}function hD(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["dynamicThreshold"]);return r!=null&&u(e,["dynamicThreshold"],r),e}function pD(n){const e={},t=l(n,["dynamicRetrievalConfig"]);return t!=null&&u(e,["dynamicRetrievalConfig"],hD(t)),e}function mD(n){const e={},t=l(n,["excludeDomains"]);return t!=null&&u(e,["excludeDomains"],t),e}function gD(n){const e={},t=l(n,["apiKeyString"]);return t!=null&&u(e,["apiKeyString"],t),e}function yD(n){const e={},t=l(n,["apiKeyConfig"]);t!=null&&u(e,["apiKeyConfig"],gD(t));const r=l(n,["authType"]);r!=null&&u(e,["authType"],r);const i=l(n,["googleServiceAccountConfig"]);i!=null&&u(e,["googleServiceAccountConfig"],i);const a=l(n,["httpBasicAuthConfig"]);a!=null&&u(e,["httpBasicAuthConfig"],a);const c=l(n,["oauthConfig"]);c!=null&&u(e,["oauthConfig"],c);const f=l(n,["oidcConfig"]);return f!=null&&u(e,["oidcConfig"],f),e}function vD(n){const e={},t=l(n,["authConfig"]);return t!=null&&u(e,["authConfig"],yD(t)),e}function _D(){return{}}function TD(n){const e={},t=l(n,["environment"]);return t!=null&&u(e,["environment"],t),e}function ED(n){const e={},t=l(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(C=>cD(C))),u(e,["functionDeclarations"],T)}const r=l(n,["retrieval"]);r!=null&&u(e,["retrieval"],r);const i=l(n,["googleSearch"]);i!=null&&u(e,["googleSearch"],fD(i));const a=l(n,["googleSearchRetrieval"]);a!=null&&u(e,["googleSearchRetrieval"],pD(a));const c=l(n,["enterpriseWebSearch"]);c!=null&&u(e,["enterpriseWebSearch"],mD(c));const f=l(n,["googleMaps"]);f!=null&&u(e,["googleMaps"],vD(f)),l(n,["urlContext"])!=null&&u(e,["urlContext"],_D());const p=l(n,["computerUse"]);p!=null&&u(e,["computerUse"],TD(p));const y=l(n,["codeExecution"]);return y!=null&&u(e,["codeExecution"],y),e}function CD(n){const e={},t=l(n,["handle"]);t!=null&&u(e,["handle"],t);const r=l(n,["transparent"]);return r!=null&&u(e,["transparent"],r),e}function h_(){return{}}function wD(n){const e={},t=l(n,["disabled"]);t!=null&&u(e,["disabled"],t);const r=l(n,["startOfSpeechSensitivity"]);r!=null&&u(e,["startOfSpeechSensitivity"],r);const i=l(n,["endOfSpeechSensitivity"]);i!=null&&u(e,["endOfSpeechSensitivity"],i);const a=l(n,["prefixPaddingMs"]);a!=null&&u(e,["prefixPaddingMs"],a);const c=l(n,["silenceDurationMs"]);return c!=null&&u(e,["silenceDurationMs"],c),e}function SD(n){const e={},t=l(n,["automaticActivityDetection"]);t!=null&&u(e,["automaticActivityDetection"],wD(t));const r=l(n,["activityHandling"]);r!=null&&u(e,["activityHandling"],r);const i=l(n,["turnCoverage"]);return i!=null&&u(e,["turnCoverage"],i),e}function ID(n){const e={},t=l(n,["targetTokens"]);return t!=null&&u(e,["targetTokens"],t),e}function AD(n){const e={},t=l(n,["triggerTokens"]);t!=null&&u(e,["triggerTokens"],t);const r=l(n,["slidingWindow"]);return r!=null&&u(e,["slidingWindow"],ID(r)),e}function xD(n){const e={},t=l(n,["proactiveAudio"]);return t!=null&&u(e,["proactiveAudio"],t),e}function kD(n,e){const t={},r=l(n,["generationConfig"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig"],r);const i=l(n,["responseModalities"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig","responseModalities"],i);const a=l(n,["temperature"]);e!==void 0&&a!=null&&u(e,["setup","generationConfig","temperature"],a);const c=l(n,["topP"]);e!==void 0&&c!=null&&u(e,["setup","generationConfig","topP"],c);const f=l(n,["topK"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","topK"],f);const m=l(n,["maxOutputTokens"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","maxOutputTokens"],m);const p=l(n,["mediaResolution"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","mediaResolution"],p);const y=l(n,["seed"]);e!==void 0&&y!=null&&u(e,["setup","generationConfig","seed"],y);const T=l(n,["speechConfig"]);e!==void 0&&T!=null&&u(e,["setup","generationConfig","speechConfig"],iD(_p(T)));const C=l(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],C);const A=l(n,["systemInstruction"]);e!==void 0&&A!=null&&u(e,["setup","systemInstruction"],uD(Zt(A)));const L=l(n,["tools"]);if(e!==void 0&&L!=null){let le=ta(L);Array.isArray(le)&&(le=le.map(Z=>ED(ea(Z)))),u(e,["setup","tools"],le)}const U=l(n,["sessionResumption"]);e!==void 0&&U!=null&&u(e,["setup","sessionResumption"],CD(U));const O=l(n,["inputAudioTranscription"]);e!==void 0&&O!=null&&u(e,["setup","inputAudioTranscription"],h_());const K=l(n,["outputAudioTranscription"]);e!==void 0&&K!=null&&u(e,["setup","outputAudioTranscription"],h_());const W=l(n,["realtimeInputConfig"]);e!==void 0&&W!=null&&u(e,["setup","realtimeInputConfig"],SD(W));const Y=l(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&u(e,["setup","contextWindowCompression"],AD(Y));const re=l(n,["proactivity"]);return e!==void 0&&re!=null&&u(e,["setup","proactivity"],xD(re)),t}function RD(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["setup","model"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],kD(i,t)),t}function PD(){return{}}function ND(){return{}}function MD(n){const e={},t=l(n,["media"]);t!=null&&u(e,["mediaChunks"],nE(t));const r=l(n,["audio"]);r!=null&&u(e,["audio"],iE(r));const i=l(n,["audioStreamEnd"]);i!=null&&u(e,["audioStreamEnd"],i);const a=l(n,["video"]);a!=null&&u(e,["video"],rE(a));const c=l(n,["text"]);return c!=null&&u(e,["text"],c),l(n,["activityStart"])!=null&&u(e,["activityStart"],PD()),l(n,["activityEnd"])!=null&&u(e,["activityEnd"],ND()),e}function DD(){return{}}function VD(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function LD(n){const e={},t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function bD(n){const e={},t=l(n,["fileUri"]);t!=null&&u(e,["fileUri"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function UD(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],VD(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],LD(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],bD(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function FD(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>UD(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function p_(n){const e={},t=l(n,["text"]);t!=null&&u(e,["text"],t);const r=l(n,["finished"]);return r!=null&&u(e,["finished"],r),e}function OD(n){const e={},t=l(n,["retrievedUrl"]);t!=null&&u(e,["retrievedUrl"],t);const r=l(n,["urlRetrievalStatus"]);return r!=null&&u(e,["urlRetrievalStatus"],r),e}function BD(n){const e={},t=l(n,["urlMetadata"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>OD(i))),u(e,["urlMetadata"],r)}return e}function qD(n){const e={},t=l(n,["modelTurn"]);t!=null&&u(e,["modelTurn"],FD(t));const r=l(n,["turnComplete"]);r!=null&&u(e,["turnComplete"],r);const i=l(n,["interrupted"]);i!=null&&u(e,["interrupted"],i);const a=l(n,["groundingMetadata"]);a!=null&&u(e,["groundingMetadata"],a);const c=l(n,["generationComplete"]);c!=null&&u(e,["generationComplete"],c);const f=l(n,["inputTranscription"]);f!=null&&u(e,["inputTranscription"],p_(f));const m=l(n,["outputTranscription"]);m!=null&&u(e,["outputTranscription"],p_(m));const p=l(n,["urlContextMetadata"]);return p!=null&&u(e,["urlContextMetadata"],BD(p)),e}function GD(n){const e={},t=l(n,["id"]);t!=null&&u(e,["id"],t);const r=l(n,["args"]);r!=null&&u(e,["args"],r);const i=l(n,["name"]);return i!=null&&u(e,["name"],i),e}function HD(n){const e={},t=l(n,["functionCalls"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>GD(i))),u(e,["functionCalls"],r)}return e}function $D(n){const e={},t=l(n,["ids"]);return t!=null&&u(e,["ids"],t),e}function zu(n){const e={},t=l(n,["modality"]);t!=null&&u(e,["modality"],t);const r=l(n,["tokenCount"]);return r!=null&&u(e,["tokenCount"],r),e}function zD(n){const e={},t=l(n,["promptTokenCount"]);t!=null&&u(e,["promptTokenCount"],t);const r=l(n,["cachedContentTokenCount"]);r!=null&&u(e,["cachedContentTokenCount"],r);const i=l(n,["responseTokenCount"]);i!=null&&u(e,["responseTokenCount"],i);const a=l(n,["toolUsePromptTokenCount"]);a!=null&&u(e,["toolUsePromptTokenCount"],a);const c=l(n,["thoughtsTokenCount"]);c!=null&&u(e,["thoughtsTokenCount"],c);const f=l(n,["totalTokenCount"]);f!=null&&u(e,["totalTokenCount"],f);const m=l(n,["promptTokensDetails"]);if(m!=null){let C=m;Array.isArray(C)&&(C=C.map(A=>zu(A))),u(e,["promptTokensDetails"],C)}const p=l(n,["cacheTokensDetails"]);if(p!=null){let C=p;Array.isArray(C)&&(C=C.map(A=>zu(A))),u(e,["cacheTokensDetails"],C)}const y=l(n,["responseTokensDetails"]);if(y!=null){let C=y;Array.isArray(C)&&(C=C.map(A=>zu(A))),u(e,["responseTokensDetails"],C)}const T=l(n,["toolUsePromptTokensDetails"]);if(T!=null){let C=T;Array.isArray(C)&&(C=C.map(A=>zu(A))),u(e,["toolUsePromptTokensDetails"],C)}return e}function WD(n){const e={},t=l(n,["timeLeft"]);return t!=null&&u(e,["timeLeft"],t),e}function JD(n){const e={},t=l(n,["newHandle"]);t!=null&&u(e,["newHandle"],t);const r=l(n,["resumable"]);r!=null&&u(e,["resumable"],r);const i=l(n,["lastConsumedClientMessageIndex"]);return i!=null&&u(e,["lastConsumedClientMessageIndex"],i),e}function KD(n){const e={};l(n,["setupComplete"])!=null&&u(e,["setupComplete"],DD());const r=l(n,["serverContent"]);r!=null&&u(e,["serverContent"],qD(r));const i=l(n,["toolCall"]);i!=null&&u(e,["toolCall"],HD(i));const a=l(n,["toolCallCancellation"]);a!=null&&u(e,["toolCallCancellation"],$D(a));const c=l(n,["usageMetadata"]);c!=null&&u(e,["usageMetadata"],zD(c));const f=l(n,["goAway"]);f!=null&&u(e,["goAway"],WD(f));const m=l(n,["sessionResumptionUpdate"]);return m!=null&&u(e,["sessionResumptionUpdate"],JD(m)),e}function YD(){return{}}function QD(n){const e={},t=l(n,["text"]);t!=null&&u(e,["text"],t);const r=l(n,["weight"]);return r!=null&&u(e,["weight"],r),e}function XD(n){const e={},t=l(n,["weightedPrompts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>QD(i))),u(e,["weightedPrompts"],r)}return e}function ZD(n){const e={},t=l(n,["temperature"]);t!=null&&u(e,["temperature"],t);const r=l(n,["topK"]);r!=null&&u(e,["topK"],r);const i=l(n,["seed"]);i!=null&&u(e,["seed"],i);const a=l(n,["guidance"]);a!=null&&u(e,["guidance"],a);const c=l(n,["bpm"]);c!=null&&u(e,["bpm"],c);const f=l(n,["density"]);f!=null&&u(e,["density"],f);const m=l(n,["brightness"]);m!=null&&u(e,["brightness"],m);const p=l(n,["scale"]);p!=null&&u(e,["scale"],p);const y=l(n,["muteBass"]);y!=null&&u(e,["muteBass"],y);const T=l(n,["muteDrums"]);T!=null&&u(e,["muteDrums"],T);const C=l(n,["onlyBassAndDrums"]);C!=null&&u(e,["onlyBassAndDrums"],C);const A=l(n,["musicGenerationMode"]);return A!=null&&u(e,["musicGenerationMode"],A),e}function jD(n){const e={},t=l(n,["clientContent"]);t!=null&&u(e,["clientContent"],XD(t));const r=l(n,["musicGenerationConfig"]);return r!=null&&u(e,["musicGenerationConfig"],ZD(r)),e}function e2(n){const e={},t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);r!=null&&u(e,["mimeType"],r);const i=l(n,["sourceMetadata"]);return i!=null&&u(e,["sourceMetadata"],jD(i)),e}function t2(n){const e={},t=l(n,["audioChunks"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>e2(i))),u(e,["audioChunks"],r)}return e}function n2(n){const e={},t=l(n,["text"]);t!=null&&u(e,["text"],t);const r=l(n,["filteredReason"]);return r!=null&&u(e,["filteredReason"],r),e}function r2(n){const e={};l(n,["setupComplete"])!=null&&u(e,["setupComplete"],YD());const r=l(n,["serverContent"]);r!=null&&u(e,["serverContent"],t2(r));const i=l(n,["filteredPrompt"]);return i!=null&&u(e,["filteredPrompt"],n2(i)),e}function i2(n){const e={},t=l(n,["sessionId"]);return t!=null&&u(e,["sessionId"],t),e}function o2(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function s2(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["data"]);r!=null&&u(e,["data"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function a2(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["fileUri"]);r!=null&&u(e,["fileUri"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function l2(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],o2(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],s2(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],a2(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function u2(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>l2(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function m_(n){const e={},t=l(n,["text"]);t!=null&&u(e,["text"],t);const r=l(n,["finished"]);return r!=null&&u(e,["finished"],r),e}function c2(n){const e={},t=l(n,["modelTurn"]);t!=null&&u(e,["modelTurn"],u2(t));const r=l(n,["turnComplete"]);r!=null&&u(e,["turnComplete"],r);const i=l(n,["interrupted"]);i!=null&&u(e,["interrupted"],i);const a=l(n,["groundingMetadata"]);a!=null&&u(e,["groundingMetadata"],a);const c=l(n,["generationComplete"]);c!=null&&u(e,["generationComplete"],c);const f=l(n,["inputTranscription"]);f!=null&&u(e,["inputTranscription"],m_(f));const m=l(n,["outputTranscription"]);return m!=null&&u(e,["outputTranscription"],m_(m)),e}function d2(n){const e={},t=l(n,["args"]);t!=null&&u(e,["args"],t);const r=l(n,["name"]);return r!=null&&u(e,["name"],r),e}function f2(n){const e={},t=l(n,["functionCalls"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>d2(i))),u(e,["functionCalls"],r)}return e}function h2(n){const e={},t=l(n,["ids"]);return t!=null&&u(e,["ids"],t),e}function Wu(n){const e={},t=l(n,["modality"]);t!=null&&u(e,["modality"],t);const r=l(n,["tokenCount"]);return r!=null&&u(e,["tokenCount"],r),e}function p2(n){const e={},t=l(n,["promptTokenCount"]);t!=null&&u(e,["promptTokenCount"],t);const r=l(n,["cachedContentTokenCount"]);r!=null&&u(e,["cachedContentTokenCount"],r);const i=l(n,["candidatesTokenCount"]);i!=null&&u(e,["responseTokenCount"],i);const a=l(n,["toolUsePromptTokenCount"]);a!=null&&u(e,["toolUsePromptTokenCount"],a);const c=l(n,["thoughtsTokenCount"]);c!=null&&u(e,["thoughtsTokenCount"],c);const f=l(n,["totalTokenCount"]);f!=null&&u(e,["totalTokenCount"],f);const m=l(n,["promptTokensDetails"]);if(m!=null){let A=m;Array.isArray(A)&&(A=A.map(L=>Wu(L))),u(e,["promptTokensDetails"],A)}const p=l(n,["cacheTokensDetails"]);if(p!=null){let A=p;Array.isArray(A)&&(A=A.map(L=>Wu(L))),u(e,["cacheTokensDetails"],A)}const y=l(n,["candidatesTokensDetails"]);if(y!=null){let A=y;Array.isArray(A)&&(A=A.map(L=>Wu(L))),u(e,["responseTokensDetails"],A)}const T=l(n,["toolUsePromptTokensDetails"]);if(T!=null){let A=T;Array.isArray(A)&&(A=A.map(L=>Wu(L))),u(e,["toolUsePromptTokensDetails"],A)}const C=l(n,["trafficType"]);return C!=null&&u(e,["trafficType"],C),e}function m2(n){const e={},t=l(n,["timeLeft"]);return t!=null&&u(e,["timeLeft"],t),e}function g2(n){const e={},t=l(n,["newHandle"]);t!=null&&u(e,["newHandle"],t);const r=l(n,["resumable"]);r!=null&&u(e,["resumable"],r);const i=l(n,["lastConsumedClientMessageIndex"]);return i!=null&&u(e,["lastConsumedClientMessageIndex"],i),e}function y2(n){const e={},t=l(n,["setupComplete"]);t!=null&&u(e,["setupComplete"],i2(t));const r=l(n,["serverContent"]);r!=null&&u(e,["serverContent"],c2(r));const i=l(n,["toolCall"]);i!=null&&u(e,["toolCall"],f2(i));const a=l(n,["toolCallCancellation"]);a!=null&&u(e,["toolCallCancellation"],h2(a));const c=l(n,["usageMetadata"]);c!=null&&u(e,["usageMetadata"],p2(c));const f=l(n,["goAway"]);f!=null&&u(e,["goAway"],m2(f));const m=l(n,["sessionResumptionUpdate"]);return m!=null&&u(e,["sessionResumptionUpdate"],g2(m)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function v2(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function _2(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function T2(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["fileUri"]);t!=null&&u(e,["fileUri"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function E2(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],v2(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],_2(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],T2(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function Wc(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>E2(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function C2(n){const e={},t=l(n,["anyOf"]);t!=null&&u(e,["anyOf"],t);const r=l(n,["default"]);r!=null&&u(e,["default"],r);const i=l(n,["description"]);i!=null&&u(e,["description"],i);const a=l(n,["enum"]);a!=null&&u(e,["enum"],a);const c=l(n,["example"]);c!=null&&u(e,["example"],c);const f=l(n,["format"]);f!=null&&u(e,["format"],f);const m=l(n,["items"]);m!=null&&u(e,["items"],m);const p=l(n,["maxItems"]);p!=null&&u(e,["maxItems"],p);const y=l(n,["maxLength"]);y!=null&&u(e,["maxLength"],y);const T=l(n,["maxProperties"]);T!=null&&u(e,["maxProperties"],T);const C=l(n,["maximum"]);C!=null&&u(e,["maximum"],C);const A=l(n,["minItems"]);A!=null&&u(e,["minItems"],A);const L=l(n,["minLength"]);L!=null&&u(e,["minLength"],L);const U=l(n,["minProperties"]);U!=null&&u(e,["minProperties"],U);const O=l(n,["minimum"]);O!=null&&u(e,["minimum"],O);const K=l(n,["nullable"]);K!=null&&u(e,["nullable"],K);const W=l(n,["pattern"]);W!=null&&u(e,["pattern"],W);const Y=l(n,["properties"]);Y!=null&&u(e,["properties"],Y);const re=l(n,["propertyOrdering"]);re!=null&&u(e,["propertyOrdering"],re);const le=l(n,["required"]);le!=null&&u(e,["required"],le);const Z=l(n,["title"]);Z!=null&&u(e,["title"],Z);const D=l(n,["type"]);return D!=null&&u(e,["type"],D),e}function w2(n){const e={};if(l(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=l(n,["category"]);t!=null&&u(e,["category"],t);const r=l(n,["threshold"]);return r!=null&&u(e,["threshold"],r),e}function S2(n){const e={},t=l(n,["behavior"]);t!=null&&u(e,["behavior"],t);const r=l(n,["description"]);r!=null&&u(e,["description"],r);const i=l(n,["name"]);i!=null&&u(e,["name"],i);const a=l(n,["parameters"]);a!=null&&u(e,["parameters"],a);const c=l(n,["parametersJsonSchema"]);c!=null&&u(e,["parametersJsonSchema"],c);const f=l(n,["response"]);f!=null&&u(e,["response"],f);const m=l(n,["responseJsonSchema"]);return m!=null&&u(e,["responseJsonSchema"],m),e}function I2(n){const e={},t=l(n,["startTime"]);t!=null&&u(e,["startTime"],t);const r=l(n,["endTime"]);return r!=null&&u(e,["endTime"],r),e}function A2(n){const e={},t=l(n,["timeRangeFilter"]);if(t!=null&&u(e,["timeRangeFilter"],I2(t)),l(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function x2(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["dynamicThreshold"]);return r!=null&&u(e,["dynamicThreshold"],r),e}function k2(n){const e={},t=l(n,["dynamicRetrievalConfig"]);return t!=null&&u(e,["dynamicRetrievalConfig"],x2(t)),e}function R2(){return{}}function P2(n){const e={},t=l(n,["environment"]);return t!=null&&u(e,["environment"],t),e}function N2(n){const e={},t=l(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>S2(p))),u(e,["functionDeclarations"],m)}if(l(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(n,["googleSearch"]);r!=null&&u(e,["googleSearch"],A2(r));const i=l(n,["googleSearchRetrieval"]);if(i!=null&&u(e,["googleSearchRetrieval"],k2(i)),l(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(n,["urlContext"])!=null&&u(e,["urlContext"],R2());const c=l(n,["computerUse"]);c!=null&&u(e,["computerUse"],P2(c));const f=l(n,["codeExecution"]);return f!=null&&u(e,["codeExecution"],f),e}function M2(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["allowedFunctionNames"]);return r!=null&&u(e,["allowedFunctionNames"],r),e}function D2(n){const e={},t=l(n,["latitude"]);t!=null&&u(e,["latitude"],t);const r=l(n,["longitude"]);return r!=null&&u(e,["longitude"],r),e}function V2(n){const e={},t=l(n,["latLng"]);t!=null&&u(e,["latLng"],D2(t));const r=l(n,["languageCode"]);return r!=null&&u(e,["languageCode"],r),e}function L2(n){const e={},t=l(n,["functionCallingConfig"]);t!=null&&u(e,["functionCallingConfig"],M2(t));const r=l(n,["retrievalConfig"]);return r!=null&&u(e,["retrievalConfig"],V2(r)),e}function b2(n){const e={},t=l(n,["voiceName"]);return t!=null&&u(e,["voiceName"],t),e}function wE(n){const e={},t=l(n,["prebuiltVoiceConfig"]);return t!=null&&u(e,["prebuiltVoiceConfig"],b2(t)),e}function U2(n){const e={},t=l(n,["speaker"]);t!=null&&u(e,["speaker"],t);const r=l(n,["voiceConfig"]);return r!=null&&u(e,["voiceConfig"],wE(r)),e}function F2(n){const e={},t=l(n,["speakerVoiceConfigs"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>U2(i))),u(e,["speakerVoiceConfigs"],r)}return e}function O2(n){const e={},t=l(n,["voiceConfig"]);t!=null&&u(e,["voiceConfig"],wE(t));const r=l(n,["multiSpeakerVoiceConfig"]);r!=null&&u(e,["multiSpeakerVoiceConfig"],F2(r));const i=l(n,["languageCode"]);return i!=null&&u(e,["languageCode"],i),e}function B2(n){const e={},t=l(n,["includeThoughts"]);t!=null&&u(e,["includeThoughts"],t);const r=l(n,["thinkingBudget"]);return r!=null&&u(e,["thinkingBudget"],r),e}function q2(n,e,t){const r={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&u(t,["systemInstruction"],Wc(Zt(i)));const a=l(e,["temperature"]);a!=null&&u(r,["temperature"],a);const c=l(e,["topP"]);c!=null&&u(r,["topP"],c);const f=l(e,["topK"]);f!=null&&u(r,["topK"],f);const m=l(e,["candidateCount"]);m!=null&&u(r,["candidateCount"],m);const p=l(e,["maxOutputTokens"]);p!=null&&u(r,["maxOutputTokens"],p);const y=l(e,["stopSequences"]);y!=null&&u(r,["stopSequences"],y);const T=l(e,["responseLogprobs"]);T!=null&&u(r,["responseLogprobs"],T);const C=l(e,["logprobs"]);C!=null&&u(r,["logprobs"],C);const A=l(e,["presencePenalty"]);A!=null&&u(r,["presencePenalty"],A);const L=l(e,["frequencyPenalty"]);L!=null&&u(r,["frequencyPenalty"],L);const U=l(e,["seed"]);U!=null&&u(r,["seed"],U);const O=l(e,["responseMimeType"]);O!=null&&u(r,["responseMimeType"],O);const K=l(e,["responseSchema"]);K!=null&&u(r,["responseSchema"],C2(yp(K)));const W=l(e,["responseJsonSchema"]);if(W!=null&&u(r,["responseJsonSchema"],W),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Y=l(e,["safetySettings"]);if(t!==void 0&&Y!=null){let N=Y;Array.isArray(N)&&(N=N.map(b=>w2(b))),u(t,["safetySettings"],N)}const re=l(e,["tools"]);if(t!==void 0&&re!=null){let N=ta(re);Array.isArray(N)&&(N=N.map(b=>N2(ea(b)))),u(t,["tools"],N)}const le=l(e,["toolConfig"]);if(t!==void 0&&le!=null&&u(t,["toolConfig"],L2(le)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Z=l(e,["cachedContent"]);t!==void 0&&Z!=null&&u(t,["cachedContent"],ei(n,Z));const D=l(e,["responseModalities"]);D!=null&&u(r,["responseModalities"],D);const k=l(e,["mediaResolution"]);k!=null&&u(r,["mediaResolution"],k);const x=l(e,["speechConfig"]);if(x!=null&&u(r,["speechConfig"],O2(vp(x))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=l(e,["thinkingConfig"]);return P!=null&&u(r,["thinkingConfig"],B2(P)),r}function g_(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["contents"]);if(i!=null){let c=Vn(i);Array.isArray(c)&&(c=c.map(f=>Wc(f))),u(t,["contents"],c)}const a=l(e,["config"]);return a!=null&&u(t,["generationConfig"],q2(n,a,t)),t}function G2(n,e){const t={},r=l(n,["taskType"]);e!==void 0&&r!=null&&u(e,["requests[]","taskType"],r);const i=l(n,["title"]);e!==void 0&&i!=null&&u(e,["requests[]","title"],i);const a=l(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&u(e,["requests[]","outputDimensionality"],a),l(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function H2(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["contents"]);i!=null&&u(t,["requests[]","content"],sE(n,i));const a=l(e,["config"]);a!=null&&u(t,["config"],G2(a,t));const c=l(e,["model"]);return c!==void 0&&u(t,["requests[]","model"],Xe(n,c)),t}function $2(n,e){const t={};if(l(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=l(n,["numberOfImages"]);e!==void 0&&r!=null&&u(e,["parameters","sampleCount"],r);const i=l(n,["aspectRatio"]);e!==void 0&&i!=null&&u(e,["parameters","aspectRatio"],i);const a=l(n,["guidanceScale"]);if(e!==void 0&&a!=null&&u(e,["parameters","guidanceScale"],a),l(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=l(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&u(e,["parameters","safetySetting"],c);const f=l(n,["personGeneration"]);e!==void 0&&f!=null&&u(e,["parameters","personGeneration"],f);const m=l(n,["includeSafetyAttributes"]);e!==void 0&&m!=null&&u(e,["parameters","includeSafetyAttributes"],m);const p=l(n,["includeRaiReason"]);e!==void 0&&p!=null&&u(e,["parameters","includeRaiReason"],p);const y=l(n,["language"]);e!==void 0&&y!=null&&u(e,["parameters","language"],y);const T=l(n,["outputMimeType"]);e!==void 0&&T!=null&&u(e,["parameters","outputOptions","mimeType"],T);const C=l(n,["outputCompressionQuality"]);if(e!==void 0&&C!=null&&u(e,["parameters","outputOptions","compressionQuality"],C),l(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const A=l(n,["imageSize"]);if(e!==void 0&&A!=null&&u(e,["parameters","sampleImageSize"],A),l(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function z2(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["prompt"]);i!=null&&u(t,["instances[0]","prompt"],i);const a=l(e,["config"]);return a!=null&&u(t,["config"],$2(a,t)),t}function W2(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","name"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function J2(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&u(t,["_query","pageSize"],i);const a=l(e,["pageToken"]);t!==void 0&&a!=null&&u(t,["_query","pageToken"],a);const c=l(e,["filter"]);t!==void 0&&c!=null&&u(t,["_query","filter"],c);const f=l(e,["queryBase"]);return t!==void 0&&f!=null&&u(t,["_url","models_url"],uE(n,f)),r}function K2(n,e){const t={},r=l(e,["config"]);return r!=null&&u(t,["config"],J2(n,r,t)),t}function Y2(n,e){const t={},r=l(n,["displayName"]);e!==void 0&&r!=null&&u(e,["displayName"],r);const i=l(n,["description"]);e!==void 0&&i!=null&&u(e,["description"],i);const a=l(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&u(e,["defaultCheckpointId"],a),t}function Q2(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","name"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],Y2(i,t)),t}function X2(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","name"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function Z2(n){const e={};if(l(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function j2(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["contents"]);if(i!=null){let c=Vn(i);Array.isArray(c)&&(c=c.map(f=>Wc(f))),u(t,["contents"],c)}const a=l(e,["config"]);return a!=null&&u(t,["config"],Z2(a)),t}function SE(n){const e={};if(l(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=l(n,["imageBytes"]);t!=null&&u(e,["bytesBase64Encoded"],qo(t));const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function eV(n,e){const t={},r=l(n,["prompt"]);e!==void 0&&r!=null&&u(e,["instances[0]","prompt"],r);const i=l(n,["image"]);if(e!==void 0&&i!=null&&u(e,["instances[0]","image"],SE(i)),l(n,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");return t}function tV(n,e){const t={},r=l(n,["numberOfVideos"]);if(e!==void 0&&r!=null&&u(e,["parameters","sampleCount"],r),l(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=l(n,["durationSeconds"]);if(e!==void 0&&i!=null&&u(e,["parameters","durationSeconds"],i),l(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=l(n,["aspectRatio"]);if(e!==void 0&&a!=null&&u(e,["parameters","aspectRatio"],a),l(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const c=l(n,["personGeneration"]);if(e!==void 0&&c!=null&&u(e,["parameters","personGeneration"],c),l(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=l(n,["negativePrompt"]);e!==void 0&&f!=null&&u(e,["parameters","negativePrompt"],f);const m=l(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&u(e,["parameters","enhancePrompt"],m),l(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(l(n,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(l(n,["referenceImages"])!==void 0)throw new Error("referenceImages parameter is not supported in Gemini API.");if(l(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function nV(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["prompt"]);i!=null&&u(t,["instances[0]","prompt"],i);const a=l(e,["image"]);if(a!=null&&u(t,["instances[0]","image"],SE(a)),l(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const c=l(e,["source"]);c!=null&&u(t,["config"],eV(c,t));const f=l(e,["config"]);return f!=null&&u(t,["config"],tV(f,t)),t}function rV(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function iV(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["data"]);r!=null&&u(e,["data"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function oV(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["fileUri"]);r!=null&&u(e,["fileUri"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function sV(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],rV(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],iV(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],oV(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function ra(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>sV(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function aV(n){const e={},t=l(n,["anyOf"]);t!=null&&u(e,["anyOf"],t);const r=l(n,["default"]);r!=null&&u(e,["default"],r);const i=l(n,["description"]);i!=null&&u(e,["description"],i);const a=l(n,["enum"]);a!=null&&u(e,["enum"],a);const c=l(n,["example"]);c!=null&&u(e,["example"],c);const f=l(n,["format"]);f!=null&&u(e,["format"],f);const m=l(n,["items"]);m!=null&&u(e,["items"],m);const p=l(n,["maxItems"]);p!=null&&u(e,["maxItems"],p);const y=l(n,["maxLength"]);y!=null&&u(e,["maxLength"],y);const T=l(n,["maxProperties"]);T!=null&&u(e,["maxProperties"],T);const C=l(n,["maximum"]);C!=null&&u(e,["maximum"],C);const A=l(n,["minItems"]);A!=null&&u(e,["minItems"],A);const L=l(n,["minLength"]);L!=null&&u(e,["minLength"],L);const U=l(n,["minProperties"]);U!=null&&u(e,["minProperties"],U);const O=l(n,["minimum"]);O!=null&&u(e,["minimum"],O);const K=l(n,["nullable"]);K!=null&&u(e,["nullable"],K);const W=l(n,["pattern"]);W!=null&&u(e,["pattern"],W);const Y=l(n,["properties"]);Y!=null&&u(e,["properties"],Y);const re=l(n,["propertyOrdering"]);re!=null&&u(e,["propertyOrdering"],re);const le=l(n,["required"]);le!=null&&u(e,["required"],le);const Z=l(n,["title"]);Z!=null&&u(e,["title"],Z);const D=l(n,["type"]);return D!=null&&u(e,["type"],D),e}function lV(n){const e={},t=l(n,["featureSelectionPreference"]);return t!=null&&u(e,["featureSelectionPreference"],t),e}function uV(n){const e={},t=l(n,["method"]);t!=null&&u(e,["method"],t);const r=l(n,["category"]);r!=null&&u(e,["category"],r);const i=l(n,["threshold"]);return i!=null&&u(e,["threshold"],i),e}function cV(n){const e={};if(l(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=l(n,["description"]);t!=null&&u(e,["description"],t);const r=l(n,["name"]);r!=null&&u(e,["name"],r);const i=l(n,["parameters"]);i!=null&&u(e,["parameters"],i);const a=l(n,["parametersJsonSchema"]);a!=null&&u(e,["parametersJsonSchema"],a);const c=l(n,["response"]);c!=null&&u(e,["response"],c);const f=l(n,["responseJsonSchema"]);return f!=null&&u(e,["responseJsonSchema"],f),e}function dV(n){const e={},t=l(n,["startTime"]);t!=null&&u(e,["startTime"],t);const r=l(n,["endTime"]);return r!=null&&u(e,["endTime"],r),e}function fV(n){const e={},t=l(n,["timeRangeFilter"]);t!=null&&u(e,["timeRangeFilter"],dV(t));const r=l(n,["excludeDomains"]);return r!=null&&u(e,["excludeDomains"],r),e}function hV(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["dynamicThreshold"]);return r!=null&&u(e,["dynamicThreshold"],r),e}function pV(n){const e={},t=l(n,["dynamicRetrievalConfig"]);return t!=null&&u(e,["dynamicRetrievalConfig"],hV(t)),e}function mV(n){const e={},t=l(n,["excludeDomains"]);return t!=null&&u(e,["excludeDomains"],t),e}function gV(n){const e={},t=l(n,["apiKeyString"]);return t!=null&&u(e,["apiKeyString"],t),e}function yV(n){const e={},t=l(n,["apiKeyConfig"]);t!=null&&u(e,["apiKeyConfig"],gV(t));const r=l(n,["authType"]);r!=null&&u(e,["authType"],r);const i=l(n,["googleServiceAccountConfig"]);i!=null&&u(e,["googleServiceAccountConfig"],i);const a=l(n,["httpBasicAuthConfig"]);a!=null&&u(e,["httpBasicAuthConfig"],a);const c=l(n,["oauthConfig"]);c!=null&&u(e,["oauthConfig"],c);const f=l(n,["oidcConfig"]);return f!=null&&u(e,["oidcConfig"],f),e}function vV(n){const e={},t=l(n,["authConfig"]);return t!=null&&u(e,["authConfig"],yV(t)),e}function _V(){return{}}function TV(n){const e={},t=l(n,["environment"]);return t!=null&&u(e,["environment"],t),e}function IE(n){const e={},t=l(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(C=>cV(C))),u(e,["functionDeclarations"],T)}const r=l(n,["retrieval"]);r!=null&&u(e,["retrieval"],r);const i=l(n,["googleSearch"]);i!=null&&u(e,["googleSearch"],fV(i));const a=l(n,["googleSearchRetrieval"]);a!=null&&u(e,["googleSearchRetrieval"],pV(a));const c=l(n,["enterpriseWebSearch"]);c!=null&&u(e,["enterpriseWebSearch"],mV(c));const f=l(n,["googleMaps"]);f!=null&&u(e,["googleMaps"],vV(f)),l(n,["urlContext"])!=null&&u(e,["urlContext"],_V());const p=l(n,["computerUse"]);p!=null&&u(e,["computerUse"],TV(p));const y=l(n,["codeExecution"]);return y!=null&&u(e,["codeExecution"],y),e}function EV(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["allowedFunctionNames"]);return r!=null&&u(e,["allowedFunctionNames"],r),e}function CV(n){const e={},t=l(n,["latitude"]);t!=null&&u(e,["latitude"],t);const r=l(n,["longitude"]);return r!=null&&u(e,["longitude"],r),e}function wV(n){const e={},t=l(n,["latLng"]);t!=null&&u(e,["latLng"],CV(t));const r=l(n,["languageCode"]);return r!=null&&u(e,["languageCode"],r),e}function SV(n){const e={},t=l(n,["functionCallingConfig"]);t!=null&&u(e,["functionCallingConfig"],EV(t));const r=l(n,["retrievalConfig"]);return r!=null&&u(e,["retrievalConfig"],wV(r)),e}function IV(n){const e={},t=l(n,["voiceName"]);return t!=null&&u(e,["voiceName"],t),e}function AV(n){const e={},t=l(n,["prebuiltVoiceConfig"]);return t!=null&&u(e,["prebuiltVoiceConfig"],IV(t)),e}function xV(n){const e={},t=l(n,["voiceConfig"]);if(t!=null&&u(e,["voiceConfig"],AV(t)),l(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=l(n,["languageCode"]);return r!=null&&u(e,["languageCode"],r),e}function kV(n){const e={},t=l(n,["includeThoughts"]);t!=null&&u(e,["includeThoughts"],t);const r=l(n,["thinkingBudget"]);return r!=null&&u(e,["thinkingBudget"],r),e}function RV(n,e,t){const r={},i=l(e,["systemInstruction"]);t!==void 0&&i!=null&&u(t,["systemInstruction"],ra(Zt(i)));const a=l(e,["temperature"]);a!=null&&u(r,["temperature"],a);const c=l(e,["topP"]);c!=null&&u(r,["topP"],c);const f=l(e,["topK"]);f!=null&&u(r,["topK"],f);const m=l(e,["candidateCount"]);m!=null&&u(r,["candidateCount"],m);const p=l(e,["maxOutputTokens"]);p!=null&&u(r,["maxOutputTokens"],p);const y=l(e,["stopSequences"]);y!=null&&u(r,["stopSequences"],y);const T=l(e,["responseLogprobs"]);T!=null&&u(r,["responseLogprobs"],T);const C=l(e,["logprobs"]);C!=null&&u(r,["logprobs"],C);const A=l(e,["presencePenalty"]);A!=null&&u(r,["presencePenalty"],A);const L=l(e,["frequencyPenalty"]);L!=null&&u(r,["frequencyPenalty"],L);const U=l(e,["seed"]);U!=null&&u(r,["seed"],U);const O=l(e,["responseMimeType"]);O!=null&&u(r,["responseMimeType"],O);const K=l(e,["responseSchema"]);K!=null&&u(r,["responseSchema"],aV(yp(K)));const W=l(e,["responseJsonSchema"]);W!=null&&u(r,["responseJsonSchema"],W);const Y=l(e,["routingConfig"]);Y!=null&&u(r,["routingConfig"],Y);const re=l(e,["modelSelectionConfig"]);re!=null&&u(r,["modelConfig"],lV(re));const le=l(e,["safetySettings"]);if(t!==void 0&&le!=null){let De=le;Array.isArray(De)&&(De=De.map(Ne=>uV(Ne))),u(t,["safetySettings"],De)}const Z=l(e,["tools"]);if(t!==void 0&&Z!=null){let De=ta(Z);Array.isArray(De)&&(De=De.map(Ne=>IE(ea(Ne)))),u(t,["tools"],De)}const D=l(e,["toolConfig"]);t!==void 0&&D!=null&&u(t,["toolConfig"],SV(D));const k=l(e,["labels"]);t!==void 0&&k!=null&&u(t,["labels"],k);const x=l(e,["cachedContent"]);t!==void 0&&x!=null&&u(t,["cachedContent"],ei(n,x));const P=l(e,["responseModalities"]);P!=null&&u(r,["responseModalities"],P);const N=l(e,["mediaResolution"]);N!=null&&u(r,["mediaResolution"],N);const b=l(e,["speechConfig"]);b!=null&&u(r,["speechConfig"],xV(vp(b)));const M=l(e,["audioTimestamp"]);M!=null&&u(r,["audioTimestamp"],M);const Pe=l(e,["thinkingConfig"]);return Pe!=null&&u(r,["thinkingConfig"],kV(Pe)),r}function y_(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["contents"]);if(i!=null){let c=Vn(i);Array.isArray(c)&&(c=c.map(f=>ra(f))),u(t,["contents"],c)}const a=l(e,["config"]);return a!=null&&u(t,["generationConfig"],RV(n,a,t)),t}function PV(n,e){const t={},r=l(n,["taskType"]);e!==void 0&&r!=null&&u(e,["instances[]","task_type"],r);const i=l(n,["title"]);e!==void 0&&i!=null&&u(e,["instances[]","title"],i);const a=l(n,["outputDimensionality"]);e!==void 0&&a!=null&&u(e,["parameters","outputDimensionality"],a);const c=l(n,["mimeType"]);e!==void 0&&c!=null&&u(e,["instances[]","mimeType"],c);const f=l(n,["autoTruncate"]);return e!==void 0&&f!=null&&u(e,["parameters","autoTruncate"],f),t}function NV(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["contents"]);i!=null&&u(t,["instances[]","content"],sE(n,i));const a=l(e,["config"]);return a!=null&&u(t,["config"],PV(a,t)),t}function MV(n,e){const t={},r=l(n,["outputGcsUri"]);e!==void 0&&r!=null&&u(e,["parameters","storageUri"],r);const i=l(n,["negativePrompt"]);e!==void 0&&i!=null&&u(e,["parameters","negativePrompt"],i);const a=l(n,["numberOfImages"]);e!==void 0&&a!=null&&u(e,["parameters","sampleCount"],a);const c=l(n,["aspectRatio"]);e!==void 0&&c!=null&&u(e,["parameters","aspectRatio"],c);const f=l(n,["guidanceScale"]);e!==void 0&&f!=null&&u(e,["parameters","guidanceScale"],f);const m=l(n,["seed"]);e!==void 0&&m!=null&&u(e,["parameters","seed"],m);const p=l(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&u(e,["parameters","safetySetting"],p);const y=l(n,["personGeneration"]);e!==void 0&&y!=null&&u(e,["parameters","personGeneration"],y);const T=l(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&u(e,["parameters","includeSafetyAttributes"],T);const C=l(n,["includeRaiReason"]);e!==void 0&&C!=null&&u(e,["parameters","includeRaiReason"],C);const A=l(n,["language"]);e!==void 0&&A!=null&&u(e,["parameters","language"],A);const L=l(n,["outputMimeType"]);e!==void 0&&L!=null&&u(e,["parameters","outputOptions","mimeType"],L);const U=l(n,["outputCompressionQuality"]);e!==void 0&&U!=null&&u(e,["parameters","outputOptions","compressionQuality"],U);const O=l(n,["addWatermark"]);e!==void 0&&O!=null&&u(e,["parameters","addWatermark"],O);const K=l(n,["imageSize"]);e!==void 0&&K!=null&&u(e,["parameters","sampleImageSize"],K);const W=l(n,["enhancePrompt"]);return e!==void 0&&W!=null&&u(e,["parameters","enhancePrompt"],W),t}function DV(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["prompt"]);i!=null&&u(t,["instances[0]","prompt"],i);const a=l(e,["config"]);return a!=null&&u(t,["config"],MV(a,t)),t}function Rr(n){const e={},t=l(n,["gcsUri"]);t!=null&&u(e,["gcsUri"],t);const r=l(n,["imageBytes"]);r!=null&&u(e,["bytesBase64Encoded"],qo(r));const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function VV(n){const e={},t=l(n,["maskMode"]);t!=null&&u(e,["maskMode"],t);const r=l(n,["segmentationClasses"]);r!=null&&u(e,["maskClasses"],r);const i=l(n,["maskDilation"]);return i!=null&&u(e,["dilation"],i),e}function LV(n){const e={},t=l(n,["controlType"]);t!=null&&u(e,["controlType"],t);const r=l(n,["enableControlImageComputation"]);return r!=null&&u(e,["computeControl"],r),e}function bV(n){const e={},t=l(n,["styleDescription"]);return t!=null&&u(e,["styleDescription"],t),e}function UV(n){const e={},t=l(n,["subjectType"]);t!=null&&u(e,["subjectType"],t);const r=l(n,["subjectDescription"]);return r!=null&&u(e,["subjectDescription"],r),e}function FV(n){const e={},t=l(n,["referenceImage"]);t!=null&&u(e,["referenceImage"],Rr(t));const r=l(n,["referenceId"]);r!=null&&u(e,["referenceId"],r);const i=l(n,["referenceType"]);i!=null&&u(e,["referenceType"],i);const a=l(n,["maskImageConfig"]);a!=null&&u(e,["maskImageConfig"],VV(a));const c=l(n,["controlImageConfig"]);c!=null&&u(e,["controlImageConfig"],LV(c));const f=l(n,["styleImageConfig"]);f!=null&&u(e,["styleImageConfig"],bV(f));const m=l(n,["subjectImageConfig"]);return m!=null&&u(e,["subjectImageConfig"],UV(m)),e}function OV(n,e){const t={},r=l(n,["outputGcsUri"]);e!==void 0&&r!=null&&u(e,["parameters","storageUri"],r);const i=l(n,["negativePrompt"]);e!==void 0&&i!=null&&u(e,["parameters","negativePrompt"],i);const a=l(n,["numberOfImages"]);e!==void 0&&a!=null&&u(e,["parameters","sampleCount"],a);const c=l(n,["aspectRatio"]);e!==void 0&&c!=null&&u(e,["parameters","aspectRatio"],c);const f=l(n,["guidanceScale"]);e!==void 0&&f!=null&&u(e,["parameters","guidanceScale"],f);const m=l(n,["seed"]);e!==void 0&&m!=null&&u(e,["parameters","seed"],m);const p=l(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&u(e,["parameters","safetySetting"],p);const y=l(n,["personGeneration"]);e!==void 0&&y!=null&&u(e,["parameters","personGeneration"],y);const T=l(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&u(e,["parameters","includeSafetyAttributes"],T);const C=l(n,["includeRaiReason"]);e!==void 0&&C!=null&&u(e,["parameters","includeRaiReason"],C);const A=l(n,["language"]);e!==void 0&&A!=null&&u(e,["parameters","language"],A);const L=l(n,["outputMimeType"]);e!==void 0&&L!=null&&u(e,["parameters","outputOptions","mimeType"],L);const U=l(n,["outputCompressionQuality"]);e!==void 0&&U!=null&&u(e,["parameters","outputOptions","compressionQuality"],U);const O=l(n,["addWatermark"]);e!==void 0&&O!=null&&u(e,["parameters","addWatermark"],O);const K=l(n,["editMode"]);e!==void 0&&K!=null&&u(e,["parameters","editMode"],K);const W=l(n,["baseSteps"]);return e!==void 0&&W!=null&&u(e,["parameters","editConfig","baseSteps"],W),t}function BV(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["prompt"]);i!=null&&u(t,["instances[0]","prompt"],i);const a=l(e,["referenceImages"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>FV(m))),u(t,["instances[0]","referenceImages"],f)}const c=l(e,["config"]);return c!=null&&u(t,["config"],OV(c,t)),t}function qV(n,e){const t={},r=l(n,["outputGcsUri"]);e!==void 0&&r!=null&&u(e,["parameters","storageUri"],r);const i=l(n,["includeRaiReason"]);e!==void 0&&i!=null&&u(e,["parameters","includeRaiReason"],i);const a=l(n,["outputMimeType"]);e!==void 0&&a!=null&&u(e,["parameters","outputOptions","mimeType"],a);const c=l(n,["outputCompressionQuality"]);e!==void 0&&c!=null&&u(e,["parameters","outputOptions","compressionQuality"],c);const f=l(n,["enhanceInputImage"]);e!==void 0&&f!=null&&u(e,["parameters","upscaleConfig","enhanceInputImage"],f);const m=l(n,["imagePreservationFactor"]);e!==void 0&&m!=null&&u(e,["parameters","upscaleConfig","imagePreservationFactor"],m);const p=l(n,["numberOfImages"]);e!==void 0&&p!=null&&u(e,["parameters","sampleCount"],p);const y=l(n,["mode"]);return e!==void 0&&y!=null&&u(e,["parameters","mode"],y),t}function GV(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["image"]);i!=null&&u(t,["instances[0]","image"],Rr(i));const a=l(e,["upscaleFactor"]);a!=null&&u(t,["parameters","upscaleConfig","upscaleFactor"],a);const c=l(e,["config"]);return c!=null&&u(t,["config"],qV(c,t)),t}function HV(n){const e={},t=l(n,["productImage"]);return t!=null&&u(e,["image"],Rr(t)),e}function $V(n,e){const t={},r=l(n,["prompt"]);e!==void 0&&r!=null&&u(e,["instances[0]","prompt"],r);const i=l(n,["personImage"]);e!==void 0&&i!=null&&u(e,["instances[0]","personImage","image"],Rr(i));const a=l(n,["productImages"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(f=>HV(f))),u(e,["instances[0]","productImages"],c)}return t}function zV(n,e){const t={},r=l(n,["numberOfImages"]);e!==void 0&&r!=null&&u(e,["parameters","sampleCount"],r);const i=l(n,["baseSteps"]);e!==void 0&&i!=null&&u(e,["parameters","editConfig","baseSteps"],i);const a=l(n,["outputGcsUri"]);e!==void 0&&a!=null&&u(e,["parameters","storageUri"],a);const c=l(n,["seed"]);e!==void 0&&c!=null&&u(e,["parameters","seed"],c);const f=l(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&u(e,["parameters","safetySetting"],f);const m=l(n,["personGeneration"]);e!==void 0&&m!=null&&u(e,["parameters","personGeneration"],m);const p=l(n,["addWatermark"]);e!==void 0&&p!=null&&u(e,["parameters","addWatermark"],p);const y=l(n,["outputMimeType"]);e!==void 0&&y!=null&&u(e,["parameters","outputOptions","mimeType"],y);const T=l(n,["outputCompressionQuality"]);e!==void 0&&T!=null&&u(e,["parameters","outputOptions","compressionQuality"],T);const C=l(n,["enhancePrompt"]);return e!==void 0&&C!=null&&u(e,["parameters","enhancePrompt"],C),t}function WV(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["source"]);i!=null&&u(t,["config"],$V(i,t));const a=l(e,["config"]);return a!=null&&u(t,["config"],zV(a,t)),t}function JV(n){const e={},t=l(n,["image"]);return t!=null&&u(e,["image"],Rr(t)),e}function KV(n,e){const t={},r=l(n,["prompt"]);e!==void 0&&r!=null&&u(e,["instances[0]","prompt"],r);const i=l(n,["image"]);e!==void 0&&i!=null&&u(e,["instances[0]","image"],Rr(i));const a=l(n,["scribbleImage"]);return e!==void 0&&a!=null&&u(e,["instances[0]","scribble"],JV(a)),t}function YV(n,e){const t={},r=l(n,["mode"]);e!==void 0&&r!=null&&u(e,["parameters","mode"],r);const i=l(n,["maxPredictions"]);e!==void 0&&i!=null&&u(e,["parameters","maxPredictions"],i);const a=l(n,["confidenceThreshold"]);e!==void 0&&a!=null&&u(e,["parameters","confidenceThreshold"],a);const c=l(n,["maskDilation"]);e!==void 0&&c!=null&&u(e,["parameters","maskDilation"],c);const f=l(n,["binaryColorThreshold"]);return e!==void 0&&f!=null&&u(e,["parameters","binaryColorThreshold"],f),t}function QV(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["source"]);i!=null&&u(t,["config"],KV(i,t));const a=l(e,["config"]);return a!=null&&u(t,["config"],YV(a,t)),t}function XV(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","name"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function ZV(n,e,t){const r={},i=l(e,["pageSize"]);t!==void 0&&i!=null&&u(t,["_query","pageSize"],i);const a=l(e,["pageToken"]);t!==void 0&&a!=null&&u(t,["_query","pageToken"],a);const c=l(e,["filter"]);t!==void 0&&c!=null&&u(t,["_query","filter"],c);const f=l(e,["queryBase"]);return t!==void 0&&f!=null&&u(t,["_url","models_url"],uE(n,f)),r}function jV(n,e){const t={},r=l(e,["config"]);return r!=null&&u(t,["config"],ZV(n,r,t)),t}function eL(n,e){const t={},r=l(n,["displayName"]);e!==void 0&&r!=null&&u(e,["displayName"],r);const i=l(n,["description"]);e!==void 0&&i!=null&&u(e,["description"],i);const a=l(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&u(e,["defaultCheckpointId"],a),t}function tL(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],eL(i,t)),t}function nL(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","name"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],i),t}function rL(n,e){const t={},r=l(n,["systemInstruction"]);e!==void 0&&r!=null&&u(e,["systemInstruction"],ra(Zt(r)));const i=l(n,["tools"]);if(e!==void 0&&i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>IE(f))),u(e,["tools"],c)}const a=l(n,["generationConfig"]);return e!==void 0&&a!=null&&u(e,["generationConfig"],a),t}function iL(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["contents"]);if(i!=null){let c=Vn(i);Array.isArray(c)&&(c=c.map(f=>ra(f))),u(t,["contents"],c)}const a=l(e,["config"]);return a!=null&&u(t,["config"],rL(a,t)),t}function oL(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["contents"]);if(i!=null){let c=Vn(i);Array.isArray(c)&&(c=c.map(f=>ra(f))),u(t,["contents"],c)}const a=l(e,["config"]);return a!=null&&u(t,["config"],a),t}function AE(n){const e={},t=l(n,["uri"]);t!=null&&u(e,["gcsUri"],t);const r=l(n,["videoBytes"]);r!=null&&u(e,["bytesBase64Encoded"],qo(r));const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function sL(n,e){const t={},r=l(n,["prompt"]);e!==void 0&&r!=null&&u(e,["instances[0]","prompt"],r);const i=l(n,["image"]);e!==void 0&&i!=null&&u(e,["instances[0]","image"],Rr(i));const a=l(n,["video"]);return e!==void 0&&a!=null&&u(e,["instances[0]","video"],AE(a)),t}function aL(n){const e={},t=l(n,["image"]);t!=null&&u(e,["image"],Rr(t));const r=l(n,["referenceType"]);return r!=null&&u(e,["referenceType"],r),e}function lL(n,e){const t={},r=l(n,["numberOfVideos"]);e!==void 0&&r!=null&&u(e,["parameters","sampleCount"],r);const i=l(n,["outputGcsUri"]);e!==void 0&&i!=null&&u(e,["parameters","storageUri"],i);const a=l(n,["fps"]);e!==void 0&&a!=null&&u(e,["parameters","fps"],a);const c=l(n,["durationSeconds"]);e!==void 0&&c!=null&&u(e,["parameters","durationSeconds"],c);const f=l(n,["seed"]);e!==void 0&&f!=null&&u(e,["parameters","seed"],f);const m=l(n,["aspectRatio"]);e!==void 0&&m!=null&&u(e,["parameters","aspectRatio"],m);const p=l(n,["resolution"]);e!==void 0&&p!=null&&u(e,["parameters","resolution"],p);const y=l(n,["personGeneration"]);e!==void 0&&y!=null&&u(e,["parameters","personGeneration"],y);const T=l(n,["pubsubTopic"]);e!==void 0&&T!=null&&u(e,["parameters","pubsubTopic"],T);const C=l(n,["negativePrompt"]);e!==void 0&&C!=null&&u(e,["parameters","negativePrompt"],C);const A=l(n,["enhancePrompt"]);e!==void 0&&A!=null&&u(e,["parameters","enhancePrompt"],A);const L=l(n,["generateAudio"]);e!==void 0&&L!=null&&u(e,["parameters","generateAudio"],L);const U=l(n,["lastFrame"]);e!==void 0&&U!=null&&u(e,["instances[0]","lastFrame"],Rr(U));const O=l(n,["referenceImages"]);if(e!==void 0&&O!=null){let W=O;Array.isArray(W)&&(W=W.map(Y=>aL(Y))),u(e,["instances[0]","referenceImages"],W)}const K=l(n,["compressionQuality"]);return e!==void 0&&K!=null&&u(e,["parameters","compressionQuality"],K),t}function uL(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["_url","model"],Xe(n,r));const i=l(e,["prompt"]);i!=null&&u(t,["instances[0]","prompt"],i);const a=l(e,["image"]);a!=null&&u(t,["instances[0]","image"],Rr(a));const c=l(e,["video"]);c!=null&&u(t,["instances[0]","video"],AE(c));const f=l(e,["source"]);f!=null&&u(t,["config"],sL(f,t));const m=l(e,["config"]);return m!=null&&u(t,["config"],lL(m,t)),t}function cL(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function dL(n){const e={},t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function fL(n){const e={},t=l(n,["fileUri"]);t!=null&&u(e,["fileUri"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function hL(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],cL(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],dL(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],fL(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function pL(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>hL(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function mL(n){const e={},t=l(n,["citationSources"]);return t!=null&&u(e,["citations"],t),e}function gL(n){const e={},t=l(n,["retrievedUrl"]);t!=null&&u(e,["retrievedUrl"],t);const r=l(n,["urlRetrievalStatus"]);return r!=null&&u(e,["urlRetrievalStatus"],r),e}function yL(n){const e={},t=l(n,["urlMetadata"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>gL(i))),u(e,["urlMetadata"],r)}return e}function vL(n){const e={},t=l(n,["content"]);t!=null&&u(e,["content"],pL(t));const r=l(n,["citationMetadata"]);r!=null&&u(e,["citationMetadata"],mL(r));const i=l(n,["tokenCount"]);i!=null&&u(e,["tokenCount"],i);const a=l(n,["finishReason"]);a!=null&&u(e,["finishReason"],a);const c=l(n,["urlContextMetadata"]);c!=null&&u(e,["urlContextMetadata"],yL(c));const f=l(n,["avgLogprobs"]);f!=null&&u(e,["avgLogprobs"],f);const m=l(n,["groundingMetadata"]);m!=null&&u(e,["groundingMetadata"],m);const p=l(n,["index"]);p!=null&&u(e,["index"],p);const y=l(n,["logprobsResult"]);y!=null&&u(e,["logprobsResult"],y);const T=l(n,["safetyRatings"]);return T!=null&&u(e,["safetyRatings"],T),e}function v_(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["candidates"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(p=>vL(p))),u(e,["candidates"],m)}const i=l(n,["modelVersion"]);i!=null&&u(e,["modelVersion"],i);const a=l(n,["promptFeedback"]);a!=null&&u(e,["promptFeedback"],a);const c=l(n,["responseId"]);c!=null&&u(e,["responseId"],c);const f=l(n,["usageMetadata"]);return f!=null&&u(e,["usageMetadata"],f),e}function _L(n){const e={},t=l(n,["values"]);return t!=null&&u(e,["values"],t),e}function TL(){return{}}function EL(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>_L(c))),u(e,["embeddings"],a)}return l(n,["metadata"])!=null&&u(e,["metadata"],TL()),e}function CL(n){const e={},t=l(n,["bytesBase64Encoded"]);t!=null&&u(e,["imageBytes"],qo(t));const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function xE(n){const e={},t=l(n,["safetyAttributes","categories"]);t!=null&&u(e,["categories"],t);const r=l(n,["safetyAttributes","scores"]);r!=null&&u(e,["scores"],r);const i=l(n,["contentType"]);return i!=null&&u(e,["contentType"],i),e}function wL(n){const e={},t=l(n,["_self"]);t!=null&&u(e,["image"],CL(t));const r=l(n,["raiFilteredReason"]);r!=null&&u(e,["raiFilteredReason"],r);const i=l(n,["_self"]);return i!=null&&u(e,["safetyAttributes"],xE(i)),e}function SL(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>wL(c))),u(e,["generatedImages"],a)}const i=l(n,["positivePromptSafetyAttributes"]);return i!=null&&u(e,["positivePromptSafetyAttributes"],xE(i)),e}function IL(n){const e={},t=l(n,["baseModel"]);t!=null&&u(e,["baseModel"],t);const r=l(n,["createTime"]);r!=null&&u(e,["createTime"],r);const i=l(n,["updateTime"]);return i!=null&&u(e,["updateTime"],i),e}function vh(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["displayName"]);r!=null&&u(e,["displayName"],r);const i=l(n,["description"]);i!=null&&u(e,["description"],i);const a=l(n,["version"]);a!=null&&u(e,["version"],a);const c=l(n,["_self"]);c!=null&&u(e,["tunedModelInfo"],IL(c));const f=l(n,["inputTokenLimit"]);f!=null&&u(e,["inputTokenLimit"],f);const m=l(n,["outputTokenLimit"]);m!=null&&u(e,["outputTokenLimit"],m);const p=l(n,["supportedGenerationMethods"]);return p!=null&&u(e,["supportedActions"],p),e}function AL(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["_self"]);if(i!=null){let a=cE(i);Array.isArray(a)&&(a=a.map(c=>vh(c))),u(e,["models"],a)}return e}function xL(n){const e={},t=l(n,["sdkHttpResponse"]);return t!=null&&u(e,["sdkHttpResponse"],t),e}function kL(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["totalTokens"]);r!=null&&u(e,["totalTokens"],r);const i=l(n,["cachedContentTokenCount"]);return i!=null&&u(e,["cachedContentTokenCount"],i),e}function RL(n){const e={},t=l(n,["video","uri"]);t!=null&&u(e,["uri"],t);const r=l(n,["video","encodedVideo"]);r!=null&&u(e,["videoBytes"],qo(r));const i=l(n,["encoding"]);return i!=null&&u(e,["mimeType"],i),e}function PL(n){const e={},t=l(n,["_self"]);return t!=null&&u(e,["video"],RL(t)),e}function NL(n){const e={},t=l(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(c=>PL(c))),u(e,["generatedVideos"],a)}const r=l(n,["raiMediaFilteredCount"]);r!=null&&u(e,["raiMediaFilteredCount"],r);const i=l(n,["raiMediaFilteredReasons"]);return i!=null&&u(e,["raiMediaFilteredReasons"],i),e}function ML(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["metadata"]);r!=null&&u(e,["metadata"],r);const i=l(n,["done"]);i!=null&&u(e,["done"],i);const a=l(n,["error"]);a!=null&&u(e,["error"],a);const c=l(n,["response","generateVideoResponse"]);return c!=null&&u(e,["response"],NL(c)),e}function DL(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function VL(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["data"]);r!=null&&u(e,["data"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function LL(n){const e={},t=l(n,["displayName"]);t!=null&&u(e,["displayName"],t);const r=l(n,["fileUri"]);r!=null&&u(e,["fileUri"],r);const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function bL(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],DL(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],VL(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],LL(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function UL(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>bL(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function FL(n){const e={},t=l(n,["citations"]);return t!=null&&u(e,["citations"],t),e}function OL(n){const e={},t=l(n,["retrievedUrl"]);t!=null&&u(e,["retrievedUrl"],t);const r=l(n,["urlRetrievalStatus"]);return r!=null&&u(e,["urlRetrievalStatus"],r),e}function BL(n){const e={},t=l(n,["urlMetadata"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>OL(i))),u(e,["urlMetadata"],r)}return e}function qL(n){const e={},t=l(n,["content"]);t!=null&&u(e,["content"],UL(t));const r=l(n,["citationMetadata"]);r!=null&&u(e,["citationMetadata"],FL(r));const i=l(n,["finishMessage"]);i!=null&&u(e,["finishMessage"],i);const a=l(n,["finishReason"]);a!=null&&u(e,["finishReason"],a);const c=l(n,["urlContextMetadata"]);c!=null&&u(e,["urlContextMetadata"],BL(c));const f=l(n,["avgLogprobs"]);f!=null&&u(e,["avgLogprobs"],f);const m=l(n,["groundingMetadata"]);m!=null&&u(e,["groundingMetadata"],m);const p=l(n,["index"]);p!=null&&u(e,["index"],p);const y=l(n,["logprobsResult"]);y!=null&&u(e,["logprobsResult"],y);const T=l(n,["safetyRatings"]);return T!=null&&u(e,["safetyRatings"],T),e}function __(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["candidates"]);if(r!=null){let p=r;Array.isArray(p)&&(p=p.map(y=>qL(y))),u(e,["candidates"],p)}const i=l(n,["createTime"]);i!=null&&u(e,["createTime"],i);const a=l(n,["modelVersion"]);a!=null&&u(e,["modelVersion"],a);const c=l(n,["promptFeedback"]);c!=null&&u(e,["promptFeedback"],c);const f=l(n,["responseId"]);f!=null&&u(e,["responseId"],f);const m=l(n,["usageMetadata"]);return m!=null&&u(e,["usageMetadata"],m),e}function GL(n){const e={},t=l(n,["truncated"]);t!=null&&u(e,["truncated"],t);const r=l(n,["token_count"]);return r!=null&&u(e,["tokenCount"],r),e}function HL(n){const e={},t=l(n,["values"]);t!=null&&u(e,["values"],t);const r=l(n,["statistics"]);return r!=null&&u(e,["statistics"],GL(r)),e}function $L(n){const e={},t=l(n,["billableCharacterCount"]);return t!=null&&u(e,["billableCharacterCount"],t),e}function zL(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["predictions[]","embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>HL(c))),u(e,["embeddings"],a)}const i=l(n,["metadata"]);return i!=null&&u(e,["metadata"],$L(i)),e}function kE(n){const e={},t=l(n,["gcsUri"]);t!=null&&u(e,["gcsUri"],t);const r=l(n,["bytesBase64Encoded"]);r!=null&&u(e,["imageBytes"],qo(r));const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function RE(n){const e={},t=l(n,["safetyAttributes","categories"]);t!=null&&u(e,["categories"],t);const r=l(n,["safetyAttributes","scores"]);r!=null&&u(e,["scores"],r);const i=l(n,["contentType"]);return i!=null&&u(e,["contentType"],i),e}function Jc(n){const e={},t=l(n,["_self"]);t!=null&&u(e,["image"],kE(t));const r=l(n,["raiFilteredReason"]);r!=null&&u(e,["raiFilteredReason"],r);const i=l(n,["_self"]);i!=null&&u(e,["safetyAttributes"],RE(i));const a=l(n,["prompt"]);return a!=null&&u(e,["enhancedPrompt"],a),e}function WL(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Jc(c))),u(e,["generatedImages"],a)}const i=l(n,["positivePromptSafetyAttributes"]);return i!=null&&u(e,["positivePromptSafetyAttributes"],RE(i)),e}function JL(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(a=>Jc(a))),u(e,["generatedImages"],i)}return e}function KL(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(a=>Jc(a))),u(e,["generatedImages"],i)}return e}function YL(n){const e={},t=l(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>Jc(i))),u(e,["generatedImages"],r)}return e}function QL(n){const e={},t=l(n,["label"]);t!=null&&u(e,["label"],t);const r=l(n,["score"]);return r!=null&&u(e,["score"],r),e}function XL(n){const e={},t=l(n,["_self"]);t!=null&&u(e,["mask"],kE(t));const r=l(n,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(a=>QL(a))),u(e,["labels"],i)}return e}function ZL(n){const e={},t=l(n,["predictions"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>XL(i))),u(e,["generatedMasks"],r)}return e}function jL(n){const e={},t=l(n,["endpoint"]);t!=null&&u(e,["name"],t);const r=l(n,["deployedModelId"]);return r!=null&&u(e,["deployedModelId"],r),e}function eb(n){const e={},t=l(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&u(e,["baseModel"],t);const r=l(n,["createTime"]);r!=null&&u(e,["createTime"],r);const i=l(n,["updateTime"]);return i!=null&&u(e,["updateTime"],i),e}function tb(n){const e={},t=l(n,["checkpointId"]);t!=null&&u(e,["checkpointId"],t);const r=l(n,["epoch"]);r!=null&&u(e,["epoch"],r);const i=l(n,["step"]);return i!=null&&u(e,["step"],i),e}function _h(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["displayName"]);r!=null&&u(e,["displayName"],r);const i=l(n,["description"]);i!=null&&u(e,["description"],i);const a=l(n,["versionId"]);a!=null&&u(e,["version"],a);const c=l(n,["deployedModels"]);if(c!=null){let T=c;Array.isArray(T)&&(T=T.map(C=>jL(C))),u(e,["endpoints"],T)}const f=l(n,["labels"]);f!=null&&u(e,["labels"],f);const m=l(n,["_self"]);m!=null&&u(e,["tunedModelInfo"],eb(m));const p=l(n,["defaultCheckpointId"]);p!=null&&u(e,["defaultCheckpointId"],p);const y=l(n,["checkpoints"]);if(y!=null){let T=y;Array.isArray(T)&&(T=T.map(C=>tb(C))),u(e,["checkpoints"],T)}return e}function nb(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["_self"]);if(i!=null){let a=cE(i);Array.isArray(a)&&(a=a.map(c=>_h(c))),u(e,["models"],a)}return e}function rb(n){const e={},t=l(n,["sdkHttpResponse"]);return t!=null&&u(e,["sdkHttpResponse"],t),e}function ib(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["totalTokens"]);return r!=null&&u(e,["totalTokens"],r),e}function ob(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["tokensInfo"]);return r!=null&&u(e,["tokensInfo"],r),e}function sb(n){const e={},t=l(n,["gcsUri"]);t!=null&&u(e,["uri"],t);const r=l(n,["bytesBase64Encoded"]);r!=null&&u(e,["videoBytes"],qo(r));const i=l(n,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function ab(n){const e={},t=l(n,["_self"]);return t!=null&&u(e,["video"],sb(t)),e}function lb(n){const e={},t=l(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(c=>ab(c))),u(e,["generatedVideos"],a)}const r=l(n,["raiMediaFilteredCount"]);r!=null&&u(e,["raiMediaFilteredCount"],r);const i=l(n,["raiMediaFilteredReasons"]);return i!=null&&u(e,["raiMediaFilteredReasons"],i),e}function ub(n){const e={},t=l(n,["name"]);t!=null&&u(e,["name"],t);const r=l(n,["metadata"]);r!=null&&u(e,["metadata"],r);const i=l(n,["done"]);i!=null&&u(e,["done"],i);const a=l(n,["error"]);a!=null&&u(e,["error"],a);const c=l(n,["response"]);return c!=null&&u(e,["response"],lb(c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cb="Content-Type",db="X-Server-Timeout",fb="User-Agent",Th="x-goog-api-client",hb="1.16.0",pb=`google-genai-sdk/${hb}`,mb="v1beta1",gb="v1beta",T_=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class yb{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:mb,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:gb,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const i=[this.getRequestUrlInternal(t)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[c,f]of Object.entries(e.queryParams))i.searchParams.append(c,String(f));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(i,a,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[i,a]of Object.entries(t))typeof a=="object"?r[i]=Object.assign(Object.assign({},r[i]),a):a!==void 0&&(r[i]=a);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(i,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){const i=new AbortController,a=i.signal;if(t.timeout&&t?.timeout>0){const c=setTimeout(()=>i.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=a}return t&&t.extraBody!==null&&vb(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await E_(i),new hh(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await E_(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var t;return Us(this,arguments,function*(){const i=(t=e?.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let c="";for(;;){const{done:f,value:m}=yield ot(i.read());if(f){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=a.decode(m,{stream:!0});try{const T=JSON.parse(p);if("error"in T){const C=JSON.parse(JSON.stringify(T.error)),A=C.status,L=C.code,U=`got status: ${A}. ${JSON.stringify(T)}`;if(L>=400&&L<600)throw new zc({message:U,status:L})}}catch(T){if(T.name==="ApiError")throw T}c+=p;let y=c.match(T_);for(;y;){const T=y[1];try{const C=new Response(T,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield ot(new hh(C)),c=c.slice(y[0].length),y=c.match(T_)}catch(C){throw new Error(`exception parsing stream chunk ${T}. ${C}`)}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=pb+" "+this.clientOptions.userAgentExtra;return e[fb]=t,e[Th]=t,e[cb]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))t.append(r,i);e.timeout&&e.timeout>0&&t.append(db,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const a=this.clientOptions.uploader,c=await a.stat(e);i.sizeBytes=String(c.size);const f=(r=t?.mimeType)!==null&&r!==void 0?r:c.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=f;const m=await this.fetchUploadUrl(i,t);return a.upload(e,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var r;let i={};t?.httpOptions?i=t.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},c=await this.request({path:me("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:i});if(!c||!c?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(r=c?.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function E_(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let r;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await n.json():r={error:{message:await n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(r);throw t>=400&&t<600?new zc({message:i,status:t}):new Error(i)}}function vb(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(a,c){const f=Object.assign({},a);for(const m in c)if(Object.prototype.hasOwnProperty.call(c,m)){const p=c[m],y=f[m];p&&typeof p=="object"&&!Array.isArray(p)&&y&&typeof y=="object"&&!Array.isArray(y)?f[m]=r(y,p):(y&&p&&typeof y!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${m}". Original type: ${typeof y}, New type: ${typeof p}. Overwriting.`),f[m]=p)}return f}const i=r(t,e);n.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _b="mcp_used/unknown";let Tb=!1;function PE(n){for(const e of n)if(Eb(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Tb}function NE(n){var e;const t=(e=n[Th])!==null&&e!==void 0?e:"";n[Th]=(t+` ${_b}`).trimStart()}function Eb(n){return n!==null&&typeof n=="object"&&n instanceof Tp}function Cb(n,e=100){return Us(this,arguments,function*(){let r,i=0;for(;i<e;){const a=yield ot(n.listTools({cursor:r}));for(const c of a.tools)yield yield ot(c),i++;if(!a.nextCursor)break;r=a.nextCursor}})}class Tp{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Tp(e,t)}async initialize(){var e,t,r,i;if(this.mcpTools.length>0)return;const a={},c=[];for(const y of this.mcpClients)try{for(var f=!0,m=(t=void 0,tl(Cb(y))),p;p=await m.next(),e=p.done,!e;f=!0){i=p.value,f=!1;const T=i;c.push(T);const C=T.name;if(a[C])throw new Error(`Duplicate function name ${C} found in MCP tools. Please ensure function names are unique.`);a[C]=y}}catch(T){t={error:T}}finally{try{!f&&!e&&(r=m.return)&&await r.call(m)}finally{if(t)throw t.error}}this.mcpTools=c,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),jP(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const c=await i.callTool({name:r.name,arguments:r.args},void 0,a);t.push({functionResponse:{name:r.name,response:c.isError?{error:c}:c}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function wb(n,e,t){const r=new zP;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data);const a=r2(i);Object.assign(r,a),e(r)}class Sb{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),c=xb(this.apiClient.getDefaultHeaders()),f=this.apiClient.getApiKey(),m=`${i}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${f}`;let p=()=>{};const y=new Promise(Y=>{p=Y}),T=e.callbacks,C=function(){p({})},A=this.apiClient,L={onopen:C,onmessage:Y=>{wb(A,T.onmessage,Y)},onerror:(t=T?.onerror)!==null&&t!==void 0?t:function(Y){},onclose:(r=T?.onclose)!==null&&r!==void 0?r:function(Y){}},U=this.webSocketFactory.create(m,Ab(c),L);U.connect(),await y;const O=Xe(this.apiClient,e.model),K=EE({model:O}),W=yh({setup:K});return U.send(JSON.stringify(W)),new Ib(U,this.apiClient)}}class Ib{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=eD(e),r=CE(t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=tD(e),r=yh(t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const t=yh({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Ns.PLAY)}pause(){this.sendPlaybackControl(Ns.PAUSE)}stop(){this.sendPlaybackControl(Ns.STOP)}resetContext(){this.sendPlaybackControl(Ns.RESET_CONTEXT)}close(){this.conn.close()}}function Ab(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function xb(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kb="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Rb(n,e,t){const r=new $P;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const a=JSON.parse(i);if(n.isVertexAI()){const c=y2(a);Object.assign(r,c)}else{const c=KD(a);Object.assign(r,c)}e(r)}class Pb{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new Sb(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,i,a,c,f;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const m=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let y;const T=this.apiClient.getHeaders();e.config&&e.config.tools&&PE(e.config.tools)&&NE(T);const C=Vb(T);if(this.apiClient.isVertexAI())y=`${m}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(C);else{const x=this.apiClient.getApiKey();let P="BidiGenerateContent",N="key";x?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",N="access_token"),y=`${m}/ws/google.ai.generativelanguage.${p}.GenerativeService.${P}?${N}=${x}`}let A=()=>{};const L=new Promise(x=>{A=x}),U=e.callbacks,O=function(){var x;(x=U?.onopen)===null||x===void 0||x.call(U),A({})},K=this.apiClient,W={onopen:O,onmessage:x=>{Rb(K,U.onmessage,x)},onerror:(t=U?.onerror)!==null&&t!==void 0?t:function(x){},onclose:(r=U?.onclose)!==null&&r!==void 0?r:function(x){}},Y=this.webSocketFactory.create(y,Db(C),W);Y.connect(),await L;let re=Xe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&re.startsWith("publishers/")){const x=this.apiClient.getProject(),P=this.apiClient.getLocation();re=`projects/${x}/locations/${P}/`+re}let le={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Ac.AUDIO]}:e.config.responseModalities=[Ac.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const Z=(f=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&f!==void 0?f:[],D=[];for(const x of Z)if(this.isCallableTool(x)){const P=x;D.push(await P.tool())}else D.push(x);D.length>0&&(e.config.tools=D);const k={model:re,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?le=RD(this.apiClient,k):le=QM(this.apiClient,k),delete le.config,Y.send(JSON.stringify(le)),new Mb(Y,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Nb={turnComplete:!0};class Mb{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Vn(t.turns),e.isVertexAI()?r=r.map(i=>ra(i)):r=r.map(i=>Wc(i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const a of r){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(kb)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},Nb),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:MD(e)}:t={realtimeInput:jM(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Db(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function Vb(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C_=10;function w_(n){var e,t,r;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const c of(t=n?.tools)!==null&&t!==void 0?t:[])if(Fs(c)){i=!0;break}if(!i)return!0;const a=(r=n?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function Fs(n){return"callTool"in n&&typeof n.callTool=="function"}function Lb(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Fs(i)))!==null&&r!==void 0?r:!1}function bb(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>!Fs(i)))!==null&&r!==void 0?r:!1}function S_(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ub extends Bo{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,i,a,c,f;const m=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Lb(t)||w_(t.config))return await this.generateContentInternal(m);if(bb(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let p,y;const T=Vn(m.contents),C=(a=(i=(r=m.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&a!==void 0?a:C_;let A=0;for(;A<C&&(p=await this.generateContentInternal(m),!(!p.functionCalls||p.functionCalls.length===0));){const L=p.candidates[0].content,U=[];for(const O of(f=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&f!==void 0?f:[])if(Fs(O)){const W=await O.callTool(p.functionCalls);U.push(...W)}A++,y={role:"user",parts:U},m.contents=Vn(m.contents),m.contents.push(L),m.contents.push(y),S_(m.config)&&(T.push(L),T.push(y))}return S_(m.config)&&(p.automaticFunctionCallingHistory=T),p},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),w_(t.config)){const r=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var i;let a;const c=[];if(r?.generatedImages)for(const m of r.generatedImages)m&&m?.safetyAttributes&&((i=m?.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?a=m?.safetyAttributes:c.push(m);let f;return a?f={generatedImages:c,positivePromptSafetyAttributes:a,sdkHttpResponse:r.sdkHttpResponse}:f={generatedImages:c,sdkHttpResponse:r.sdkHttpResponse},f}),this.list=async t=>{var r;const c={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((r=c.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new wl(Lo.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(c),c)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,r,i;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const c=await Promise.all(a.map(async m=>Fs(m)?await m.tool():m)),f={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(f.config.tools=c,e.config&&e.config.tools&&PE(e.config.tools)){const m=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let p=Object.assign({},m);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),NE(p),f.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return f}async initAfcToolsMap(e){var t,r,i;const a=new Map;for(const c of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(Fs(c)){const f=c,m=await f.tool();for(const p of(i=m.functionDeclarations)!==null&&i!==void 0?i:[]){if(!p.name)throw new Error("Function declaration name is required.");if(a.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);a.set(p.name,f)}}return a}async processAfcStream(e){var t,r,i;const a=(i=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:C_;let c=!1,f=0;const m=await this.initAfcToolsMap(e);return(function(p,y,T){var C,A;return Us(this,arguments,function*(){for(var L,U,O,K;f<a;){c&&(f++,c=!1);const le=yield ot(p.processParamsMaybeAddMcpUsage(T)),Z=yield ot(p.generateContentStreamInternal(le)),D=[],k=[];try{for(var W=!0,Y=(U=void 0,tl(Z)),re;re=yield ot(Y.next()),L=re.done,!L;W=!0){K=re.value,W=!1;const x=K;if(yield yield ot(x),x.candidates&&(!((C=x.candidates[0])===null||C===void 0)&&C.content)){k.push(x.candidates[0].content);for(const P of(A=x.candidates[0].content.parts)!==null&&A!==void 0?A:[])if(f<a&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(y.has(P.functionCall.name)){const N=yield ot(y.get(P.functionCall.name).callTool([P.functionCall]));D.push(...N)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${y.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(x){U={error:x}}finally{try{!W&&!L&&(O=Y.return)&&(yield ot(O.call(Y)))}finally{if(U)throw U.error}}if(D.length>0){c=!0;const x=new Ha;x.candidates=[{content:{role:"user",parts:D}}],yield yield ot(x);const P=[];P.push(...k),P.push({role:"user",parts:D});const N=Vn(T.contents).concat(P);T.contents=N}else break}})})(this,m,e)}async generateContentInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=y_(this.apiClient,e);return f=me("{model}:generateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=__(y),C=new Ha;return Object.assign(C,T),C})}else{const p=g_(this.apiClient,e);return f=me("{model}:generateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=v_(y),C=new Ha;return Object.assign(C,T),C})}}async generateContentStreamInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=y_(this.apiClient,e);return f=me("{model}:streamGenerateContent?alt=sse",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.requestStream({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),c.then(function(T){return Us(this,arguments,function*(){var C,A,L,U;try{for(var O=!0,K=tl(T),W;W=yield ot(K.next()),C=W.done,!C;O=!0){U=W.value,O=!1;const Y=U,re=__(yield ot(Y.json()));re.sdkHttpResponse={headers:Y.headers};const le=new Ha;Object.assign(le,re),yield yield ot(le)}}catch(Y){A={error:Y}}finally{try{!O&&!C&&(L=K.return)&&(yield ot(L.call(K)))}finally{if(A)throw A.error}}})})}else{const p=g_(this.apiClient,e);return f=me("{model}:streamGenerateContent?alt=sse",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.requestStream({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),c.then(function(T){return Us(this,arguments,function*(){var C,A,L,U;try{for(var O=!0,K=tl(T),W;W=yield ot(K.next()),C=W.done,!C;O=!0){U=W.value,O=!1;const Y=U,re=v_(yield ot(Y.json()));re.sdkHttpResponse={headers:Y.headers};const le=new Ha;Object.assign(le,re),yield yield ot(le)}}catch(Y){A={error:Y}}finally{try{!O&&!C&&(L=K.return)&&(yield ot(L.call(K)))}finally{if(A)throw A.error}}})})}}async embedContent(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=NV(this.apiClient,e);return f=me("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=zL(y),C=new Kv;return Object.assign(C,T),C})}else{const p=H2(this.apiClient,e);return f=me("{model}:batchEmbedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=EL(y),C=new Kv;return Object.assign(C,T),C})}}async generateImagesInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=DV(this.apiClient,e);return f=me("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=WL(y),C=new Yv;return Object.assign(C,T),C})}else{const p=z2(this.apiClient,e);return f=me("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=SL(y),C=new Yv;return Object.assign(C,T),C})}}async editImageInternal(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI()){const f=BV(this.apiClient,e);return a=me("{model}:predict",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),i.then(m=>{const p=JL(m),y=new bP;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI()){const f=GV(this.apiClient,e);return a=me("{model}:predict",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),i.then(m=>{const p=KL(m),y=new UP;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI()){const f=WV(this.apiClient,e);return a=me("{model}:predict",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),i.then(m=>{const p=YL(m),y=new FP;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI()){const f=QV(this.apiClient,e);return a=me("{model}:predict",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),i.then(m=>{const p=ZL(m),y=new OP;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=XV(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c.then(y=>_h(y))}else{const p=W2(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>vh(y))}}async listInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=jV(this.apiClient,e);return f=me("{models_url}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=nb(y),C=new Qv;return Object.assign(C,T),C})}else{const p=K2(this.apiClient,e);return f=me("{models_url}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=AL(y),C=new Qv;return Object.assign(C,T),C})}}async update(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=tL(this.apiClient,e);return f=me("{model}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c.then(y=>_h(y))}else{const p=Q2(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>vh(y))}}async delete(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=nL(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=rb(y),C=new Xv;return Object.assign(C,T),C})}else{const p=X2(this.apiClient,e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=xL(y),C=new Xv;return Object.assign(C,T),C})}}async countTokens(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=iL(this.apiClient,e);return f=me("{model}:countTokens",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=ib(y),C=new Zv;return Object.assign(C,T),C})}else{const p=j2(this.apiClient,e);return f=me("{model}:countTokens",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=kL(y),C=new Zv;return Object.assign(C,T),C})}}async computeTokens(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI()){const f=oL(this.apiClient,e);return a=me("{model}:computeTokens",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),i.then(m=>{const p=ob(m),y=new BP;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=uL(this.apiClient,e);return f=me("{model}:predictLongRunning",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c.then(y=>{const T=ub(y),C=new xc;return Object.assign(C,T),C})}else{const p=nV(this.apiClient,e);return f=me("{model}:predictLongRunning",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>{const T=ML(y),C=new xc;return Object.assign(C,T),C})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fb(n){const e={},t=l(n,["operationName"]);t!=null&&u(e,["_url","operationName"],t);const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}function Ob(n){const e={},t=l(n,["operationName"]);t!=null&&u(e,["operationName"],t);const r=l(n,["resourceName"]);r!=null&&u(e,["_url","resourceName"],r);const i=l(n,["config"]);return i!=null&&u(e,["config"],i),e}function Bb(n){const e={},t=l(n,["operationName"]);t!=null&&u(e,["_url","operationName"],t);const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qb extends Bo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let a;r&&"httpOptions"in r&&(a=r.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let a;r&&"httpOptions"in r&&(a=r.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=Bb(e);return f=me("{operationName}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json()),c}else{const p=Fb(e);return f=me("{operationName}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c}}async fetchPredictVideosOperationInternal(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI()){const f=Ob(e);return a=me("{resourceName}:fetchPredictOperation",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gb(n){const e={},t=l(n,["voiceName"]);return t!=null&&u(e,["voiceName"],t),e}function ME(n){const e={},t=l(n,["prebuiltVoiceConfig"]);return t!=null&&u(e,["prebuiltVoiceConfig"],Gb(t)),e}function Hb(n){const e={},t=l(n,["speaker"]);t!=null&&u(e,["speaker"],t);const r=l(n,["voiceConfig"]);return r!=null&&u(e,["voiceConfig"],ME(r)),e}function $b(n){const e={},t=l(n,["speakerVoiceConfigs"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>Hb(i))),u(e,["speakerVoiceConfigs"],r)}return e}function zb(n){const e={},t=l(n,["voiceConfig"]);t!=null&&u(e,["voiceConfig"],ME(t));const r=l(n,["multiSpeakerVoiceConfig"]);r!=null&&u(e,["multiSpeakerVoiceConfig"],$b(r));const i=l(n,["languageCode"]);return i!=null&&u(e,["languageCode"],i),e}function Wb(n){const e={},t=l(n,["fps"]);t!=null&&u(e,["fps"],t);const r=l(n,["endOffset"]);r!=null&&u(e,["endOffset"],r);const i=l(n,["startOffset"]);return i!=null&&u(e,["startOffset"],i),e}function Jb(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["data"]);t!=null&&u(e,["data"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function Kb(n){const e={};if(l(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=l(n,["fileUri"]);t!=null&&u(e,["fileUri"],t);const r=l(n,["mimeType"]);return r!=null&&u(e,["mimeType"],r),e}function Yb(n){const e={},t=l(n,["videoMetadata"]);t!=null&&u(e,["videoMetadata"],Wb(t));const r=l(n,["thought"]);r!=null&&u(e,["thought"],r);const i=l(n,["inlineData"]);i!=null&&u(e,["inlineData"],Jb(i));const a=l(n,["fileData"]);a!=null&&u(e,["fileData"],Kb(a));const c=l(n,["thoughtSignature"]);c!=null&&u(e,["thoughtSignature"],c);const f=l(n,["codeExecutionResult"]);f!=null&&u(e,["codeExecutionResult"],f);const m=l(n,["executableCode"]);m!=null&&u(e,["executableCode"],m);const p=l(n,["functionCall"]);p!=null&&u(e,["functionCall"],p);const y=l(n,["functionResponse"]);y!=null&&u(e,["functionResponse"],y);const T=l(n,["text"]);return T!=null&&u(e,["text"],T),e}function Qb(n){const e={},t=l(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>Yb(a))),u(e,["parts"],i)}const r=l(n,["role"]);return r!=null&&u(e,["role"],r),e}function Xb(n){const e={},t=l(n,["behavior"]);t!=null&&u(e,["behavior"],t);const r=l(n,["description"]);r!=null&&u(e,["description"],r);const i=l(n,["name"]);i!=null&&u(e,["name"],i);const a=l(n,["parameters"]);a!=null&&u(e,["parameters"],a);const c=l(n,["parametersJsonSchema"]);c!=null&&u(e,["parametersJsonSchema"],c);const f=l(n,["response"]);f!=null&&u(e,["response"],f);const m=l(n,["responseJsonSchema"]);return m!=null&&u(e,["responseJsonSchema"],m),e}function Zb(n){const e={},t=l(n,["startTime"]);t!=null&&u(e,["startTime"],t);const r=l(n,["endTime"]);return r!=null&&u(e,["endTime"],r),e}function jb(n){const e={},t=l(n,["timeRangeFilter"]);if(t!=null&&u(e,["timeRangeFilter"],Zb(t)),l(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function eU(n){const e={},t=l(n,["mode"]);t!=null&&u(e,["mode"],t);const r=l(n,["dynamicThreshold"]);return r!=null&&u(e,["dynamicThreshold"],r),e}function tU(n){const e={},t=l(n,["dynamicRetrievalConfig"]);return t!=null&&u(e,["dynamicRetrievalConfig"],eU(t)),e}function nU(){return{}}function rU(n){const e={},t=l(n,["environment"]);return t!=null&&u(e,["environment"],t),e}function iU(n){const e={},t=l(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>Xb(p))),u(e,["functionDeclarations"],m)}if(l(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(n,["googleSearch"]);r!=null&&u(e,["googleSearch"],jb(r));const i=l(n,["googleSearchRetrieval"]);if(i!=null&&u(e,["googleSearchRetrieval"],tU(i)),l(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(n,["urlContext"])!=null&&u(e,["urlContext"],nU());const c=l(n,["computerUse"]);c!=null&&u(e,["computerUse"],rU(c));const f=l(n,["codeExecution"]);return f!=null&&u(e,["codeExecution"],f),e}function oU(n){const e={},t=l(n,["handle"]);if(t!=null&&u(e,["handle"],t),l(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function I_(){return{}}function sU(n){const e={},t=l(n,["disabled"]);t!=null&&u(e,["disabled"],t);const r=l(n,["startOfSpeechSensitivity"]);r!=null&&u(e,["startOfSpeechSensitivity"],r);const i=l(n,["endOfSpeechSensitivity"]);i!=null&&u(e,["endOfSpeechSensitivity"],i);const a=l(n,["prefixPaddingMs"]);a!=null&&u(e,["prefixPaddingMs"],a);const c=l(n,["silenceDurationMs"]);return c!=null&&u(e,["silenceDurationMs"],c),e}function aU(n){const e={},t=l(n,["automaticActivityDetection"]);t!=null&&u(e,["automaticActivityDetection"],sU(t));const r=l(n,["activityHandling"]);r!=null&&u(e,["activityHandling"],r);const i=l(n,["turnCoverage"]);return i!=null&&u(e,["turnCoverage"],i),e}function lU(n){const e={},t=l(n,["targetTokens"]);return t!=null&&u(e,["targetTokens"],t),e}function uU(n){const e={},t=l(n,["triggerTokens"]);t!=null&&u(e,["triggerTokens"],t);const r=l(n,["slidingWindow"]);return r!=null&&u(e,["slidingWindow"],lU(r)),e}function cU(n){const e={},t=l(n,["proactiveAudio"]);return t!=null&&u(e,["proactiveAudio"],t),e}function dU(n,e){const t={},r=l(n,["generationConfig"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig"],r);const i=l(n,["responseModalities"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig","responseModalities"],i);const a=l(n,["temperature"]);e!==void 0&&a!=null&&u(e,["setup","generationConfig","temperature"],a);const c=l(n,["topP"]);e!==void 0&&c!=null&&u(e,["setup","generationConfig","topP"],c);const f=l(n,["topK"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","topK"],f);const m=l(n,["maxOutputTokens"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","maxOutputTokens"],m);const p=l(n,["mediaResolution"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","mediaResolution"],p);const y=l(n,["seed"]);e!==void 0&&y!=null&&u(e,["setup","generationConfig","seed"],y);const T=l(n,["speechConfig"]);e!==void 0&&T!=null&&u(e,["setup","generationConfig","speechConfig"],zb(_p(T)));const C=l(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],C);const A=l(n,["systemInstruction"]);e!==void 0&&A!=null&&u(e,["setup","systemInstruction"],Qb(Zt(A)));const L=l(n,["tools"]);if(e!==void 0&&L!=null){let le=ta(L);Array.isArray(le)&&(le=le.map(Z=>iU(ea(Z)))),u(e,["setup","tools"],le)}const U=l(n,["sessionResumption"]);e!==void 0&&U!=null&&u(e,["setup","sessionResumption"],oU(U));const O=l(n,["inputAudioTranscription"]);e!==void 0&&O!=null&&u(e,["setup","inputAudioTranscription"],I_());const K=l(n,["outputAudioTranscription"]);e!==void 0&&K!=null&&u(e,["setup","outputAudioTranscription"],I_());const W=l(n,["realtimeInputConfig"]);e!==void 0&&W!=null&&u(e,["setup","realtimeInputConfig"],aU(W));const Y=l(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&u(e,["setup","contextWindowCompression"],uU(Y));const re=l(n,["proactivity"]);return e!==void 0&&re!=null&&u(e,["setup","proactivity"],cU(re)),t}function fU(n,e){const t={},r=l(e,["model"]);r!=null&&u(t,["setup","model"],Xe(n,r));const i=l(e,["config"]);return i!=null&&u(t,["config"],dU(i,t)),t}function hU(n,e,t){const r={},i=l(e,["expireTime"]);t!==void 0&&i!=null&&u(t,["expireTime"],i);const a=l(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&u(t,["newSessionExpireTime"],a);const c=l(e,["uses"]);t!==void 0&&c!=null&&u(t,["uses"],c);const f=l(e,["liveConnectConstraints"]);t!==void 0&&f!=null&&u(t,["bidiGenerateContentSetup"],fU(n,f));const m=l(e,["lockAdditionalFields"]);return t!==void 0&&m!=null&&u(t,["fieldMask"],m),r}function pU(n,e){const t={},r=l(e,["config"]);return r!=null&&u(t,["config"],hU(n,r,t)),t}function mU(n){const e={},t=l(n,["name"]);return t!=null&&u(e,["name"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gU(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=n[t];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(a=>`${t}.${a}`);e.push(...i)}else e.push(t)}return e.join(",")}function yU(n,e){let t=null;const r=n.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const a=r.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else r!==void 0&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(t){const a=gU(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)a?n.fieldMask=a:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let f=[];i.length>0&&(f=i.map(p=>c.includes(p)?`generationConfig.${p}`:p));const m=[];a&&m.push(a),f.length>0&&m.push(...f),m.length>0?n.fieldMask=m.join(","):delete n.fieldMask}else delete n.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}class vU extends Bo{constructor(e){super(),this.apiClient=e}async create(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const f=pU(this.apiClient,e);a=me("auth_tokens",f._url),c=f._query,delete f.config,delete f._url,delete f._query;const m=yU(f,e.config);return i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),i.then(p=>mU(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _U(n){const e={},t=l(n,["name"]);t!=null&&u(e,["_url","name"],t);const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}function TU(n,e){const t={},r=l(n,["pageSize"]);e!==void 0&&r!=null&&u(e,["_query","pageSize"],r);const i=l(n,["pageToken"]);e!==void 0&&i!=null&&u(e,["_query","pageToken"],i);const a=l(n,["filter"]);return e!==void 0&&a!=null&&u(e,["_query","filter"],a),t}function EU(n){const e={},t=l(n,["config"]);return t!=null&&u(e,["config"],TU(t,e)),e}function CU(n){const e={},t=l(n,["name"]);t!=null&&u(e,["_url","name"],t);const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}function wU(n){const e={},t=l(n,["textInput"]);t!=null&&u(e,["textInput"],t);const r=l(n,["output"]);return r!=null&&u(e,["output"],r),e}function SU(n){const e={};if(l(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=l(n,["examples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(i=>wU(i))),u(e,["examples","examples"],r)}return e}function IU(n,e){const t={};if(l(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=l(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&u(e,["displayName"],r),l(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=l(n,["epochCount"]);e!==void 0&&i!=null&&u(e,["tuningTask","hyperparameters","epochCount"],i);const a=l(n,["learningRateMultiplier"]);if(a!=null&&u(t,["tuningTask","hyperparameters","learningRateMultiplier"],a),l(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(l(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(l(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=l(n,["batchSize"]);e!==void 0&&c!=null&&u(e,["tuningTask","hyperparameters","batchSize"],c);const f=l(n,["learningRate"]);return e!==void 0&&f!=null&&u(e,["tuningTask","hyperparameters","learningRate"],f),t}function AU(n){const e={},t=l(n,["baseModel"]);t!=null&&u(e,["baseModel"],t);const r=l(n,["preTunedModel"]);r!=null&&u(e,["preTunedModel"],r);const i=l(n,["trainingDataset"]);i!=null&&u(e,["tuningTask","trainingData"],SU(i));const a=l(n,["config"]);return a!=null&&u(e,["config"],IU(a,e)),e}function xU(n){const e={},t=l(n,["name"]);t!=null&&u(e,["_url","name"],t);const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}function kU(n,e){const t={},r=l(n,["pageSize"]);e!==void 0&&r!=null&&u(e,["_query","pageSize"],r);const i=l(n,["pageToken"]);e!==void 0&&i!=null&&u(e,["_query","pageToken"],i);const a=l(n,["filter"]);return e!==void 0&&a!=null&&u(e,["_query","filter"],a),t}function RU(n){const e={},t=l(n,["config"]);return t!=null&&u(e,["config"],kU(t,e)),e}function PU(n){const e={},t=l(n,["name"]);t!=null&&u(e,["_url","name"],t);const r=l(n,["config"]);return r!=null&&u(e,["config"],r),e}function NU(n,e){const t={},r=l(n,["gcsUri"]);e!==void 0&&r!=null&&u(e,["supervisedTuningSpec","trainingDatasetUri"],r);const i=l(n,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&u(e,["supervisedTuningSpec","trainingDatasetUri"],i),l(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function MU(n,e){const t={},r=l(n,["gcsUri"]);r!=null&&u(t,["validationDatasetUri"],r);const i=l(n,["vertexDatasetResource"]);return e!==void 0&&i!=null&&u(e,["supervisedTuningSpec","trainingDatasetUri"],i),t}function DU(n,e){const t={},r=l(n,["validationDataset"]);e!==void 0&&r!=null&&u(e,["supervisedTuningSpec"],MU(r,t));const i=l(n,["tunedModelDisplayName"]);e!==void 0&&i!=null&&u(e,["tunedModelDisplayName"],i);const a=l(n,["description"]);e!==void 0&&a!=null&&u(e,["description"],a);const c=l(n,["epochCount"]);e!==void 0&&c!=null&&u(e,["supervisedTuningSpec","hyperParameters","epochCount"],c);const f=l(n,["learningRateMultiplier"]);e!==void 0&&f!=null&&u(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const m=l(n,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&u(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m);const p=l(n,["preTunedModelCheckpointId"]);p!=null&&u(t,["preTunedModel","checkpointId"],p);const y=l(n,["adapterSize"]);if(e!==void 0&&y!=null&&u(e,["supervisedTuningSpec","hyperParameters","adapterSize"],y),l(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(l(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return t}function VU(n){const e={},t=l(n,["baseModel"]);t!=null&&u(e,["baseModel"],t);const r=l(n,["preTunedModel"]);r!=null&&u(e,["preTunedModel"],r);const i=l(n,["trainingDataset"]);i!=null&&u(e,["supervisedTuningSpec","trainingDatasetUri"],NU(i,e));const a=l(n,["config"]);return a!=null&&u(e,["config"],DU(a,e)),e}function LU(n){const e={},t=l(n,["name"]);t!=null&&u(e,["model"],t);const r=l(n,["name"]);return r!=null&&u(e,["endpoint"],r),e}function DE(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["name"]);r!=null&&u(e,["name"],r);const i=l(n,["state"]);i!=null&&u(e,["state"],aE(i));const a=l(n,["createTime"]);a!=null&&u(e,["createTime"],a);const c=l(n,["tuningTask","startTime"]);c!=null&&u(e,["startTime"],c);const f=l(n,["tuningTask","completeTime"]);f!=null&&u(e,["endTime"],f);const m=l(n,["updateTime"]);m!=null&&u(e,["updateTime"],m);const p=l(n,["description"]);p!=null&&u(e,["description"],p);const y=l(n,["baseModel"]);y!=null&&u(e,["baseModel"],y);const T=l(n,["_self"]);T!=null&&u(e,["tunedModel"],LU(T));const C=l(n,["customBaseModel"]);C!=null&&u(e,["customBaseModel"],C);const A=l(n,["experiment"]);A!=null&&u(e,["experiment"],A);const L=l(n,["labels"]);L!=null&&u(e,["labels"],L);const U=l(n,["outputUri"]);U!=null&&u(e,["outputUri"],U);const O=l(n,["pipelineJob"]);O!=null&&u(e,["pipelineJob"],O);const K=l(n,["serviceAccount"]);K!=null&&u(e,["serviceAccount"],K);const W=l(n,["tunedModelDisplayName"]);return W!=null&&u(e,["tunedModelDisplayName"],W),e}function bU(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["tunedModels"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>DE(c))),u(e,["tuningJobs"],a)}return e}function UU(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["name"]);r!=null&&u(e,["name"],r);const i=l(n,["metadata"]);i!=null&&u(e,["metadata"],i);const a=l(n,["done"]);a!=null&&u(e,["done"],a);const c=l(n,["error"]);return c!=null&&u(e,["error"],c),e}function FU(n){const e={},t=l(n,["checkpointId"]);t!=null&&u(e,["checkpointId"],t);const r=l(n,["epoch"]);r!=null&&u(e,["epoch"],r);const i=l(n,["step"]);i!=null&&u(e,["step"],i);const a=l(n,["endpoint"]);return a!=null&&u(e,["endpoint"],a),e}function OU(n){const e={},t=l(n,["model"]);t!=null&&u(e,["model"],t);const r=l(n,["endpoint"]);r!=null&&u(e,["endpoint"],r);const i=l(n,["checkpoints"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>FU(c))),u(e,["checkpoints"],a)}return e}function Eh(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["name"]);r!=null&&u(e,["name"],r);const i=l(n,["state"]);i!=null&&u(e,["state"],aE(i));const a=l(n,["createTime"]);a!=null&&u(e,["createTime"],a);const c=l(n,["startTime"]);c!=null&&u(e,["startTime"],c);const f=l(n,["endTime"]);f!=null&&u(e,["endTime"],f);const m=l(n,["updateTime"]);m!=null&&u(e,["updateTime"],m);const p=l(n,["error"]);p!=null&&u(e,["error"],p);const y=l(n,["description"]);y!=null&&u(e,["description"],y);const T=l(n,["baseModel"]);T!=null&&u(e,["baseModel"],T);const C=l(n,["tunedModel"]);C!=null&&u(e,["tunedModel"],OU(C));const A=l(n,["preTunedModel"]);A!=null&&u(e,["preTunedModel"],A);const L=l(n,["supervisedTuningSpec"]);L!=null&&u(e,["supervisedTuningSpec"],L);const U=l(n,["tuningDataStats"]);U!=null&&u(e,["tuningDataStats"],U);const O=l(n,["encryptionSpec"]);O!=null&&u(e,["encryptionSpec"],O);const K=l(n,["partnerModelTuningSpec"]);K!=null&&u(e,["partnerModelTuningSpec"],K);const W=l(n,["customBaseModel"]);W!=null&&u(e,["customBaseModel"],W);const Y=l(n,["experiment"]);Y!=null&&u(e,["experiment"],Y);const re=l(n,["labels"]);re!=null&&u(e,["labels"],re);const le=l(n,["outputUri"]);le!=null&&u(e,["outputUri"],le);const Z=l(n,["pipelineJob"]);Z!=null&&u(e,["pipelineJob"],Z);const D=l(n,["serviceAccount"]);D!=null&&u(e,["serviceAccount"],D);const k=l(n,["tunedModelDisplayName"]);return k!=null&&u(e,["tunedModelDisplayName"],k),e}function BU(n){const e={},t=l(n,["sdkHttpResponse"]);t!=null&&u(e,["sdkHttpResponse"],t);const r=l(n,["nextPageToken"]);r!=null&&u(e,["nextPageToken"],r);const i=l(n,["tuningJobs"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>Eh(c))),u(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qU extends Bo{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new wl(Lo.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel},i=Object.assign(Object.assign({},t),{preTunedModel:r});return i.baseModel=void 0,await this.tuneInternal(i)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),i=await this.tuneMldevInternal(r);let a="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?a=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(a=i.name.split("/operations/")[0]),{name:a,state:fh.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=xU(e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>Eh(y))}else{const p=_U(e);return f=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>DE(y))}}async listInternal(e){var t,r,i,a;let c,f="",m={};if(this.apiClient.isVertexAI()){const p=RU(e);return f=me("tuningJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=BU(y),C=new e_;return Object.assign(C,T),C})}else{const p=EU(e);return f=me("tunedModels",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const C=T;return C.sdkHttpResponse={headers:y.headers},C})),c.then(y=>{const T=bU(y),C=new e_;return Object.assign(C,T),C})}}async cancel(e){var t,r,i,a;let c="",f={};if(this.apiClient.isVertexAI()){const m=PU(e);c=me("{name}:cancel",m._url),f=m._query,delete m.config,delete m._url,delete m._query,await this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const m=CU(e);c=me("{name}:cancel",m._url),f=m._query,delete m.config,delete m._url,delete m._query,await this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async tuneInternal(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI()){const f=VU(e);return a=me("tuningJobs",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),i.then(m=>Eh(m))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=AU(e);return a=me("tunedModels",f._url),c=f._query,delete f.config,delete f._url,delete f._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),i.then(m=>UU(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GU{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const HU=1024*1024*8,$U=3,zU=1e3,WU=2,Ff="x-goog-upload-status";async function JU(n,e,t){var r,i,a;let c=0,f=0,m=new hh(new Response),p="upload";for(c=n.size;f<c;){const T=Math.min(HU,c-f),C=n.slice(f,f+T);f+T>=c&&(p+=", finalize");let A=0,L=zU;for(;A<$U&&(m=await t.request({path:"",body:C,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":String(f),"Content-Length":String(T)}}}),!(!((r=m?.headers)===null||r===void 0)&&r[Ff]));)A++,await YU(L),L=L*WU;if(f+=T,((i=m?.headers)===null||i===void 0?void 0:i[Ff])!=="active")break;if(c<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const y=await m?.json();if(((a=m?.headers)===null||a===void 0?void 0:a[Ff])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return y.file}async function KU(n){return{size:n.size,type:n.type}}function YU(n){return new Promise(e=>setTimeout(e,n))}class QU{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await JU(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await KU(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XU{create(e,t,r){return new ZU(e,t,r)}}class ZU{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const A_="x-goog-api-key";class jU{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(A_)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(A_,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eF="gl-node/";class tF{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=LP(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new jU(this.apiKey);this.apiClient=new yb({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:eF+"web",uploader:new QU,downloader:new GU}),this.models=new Ub(this.apiClient),this.live=new Pb(this.apiClient,i,new XU),this.batches=new sN(this.apiClient),this.chats=new fM(this.models,this.apiClient),this.caches=new uM(this.apiClient),this.files=new IM(this.apiClient),this.operations=new qb(this.apiClient),this.authTokens=new vU(this.apiClient),this.tunings=new qU(this.apiClient)}}const nF=async(n,e,t,r)=>{const i=t||"PLACEHOLDER_API_KEY";if(!n)throw new Error("エラー: 分析対象の時間割データがありません。");const a=new tF({apiKey:i}),c=["月","火","水","木","金","土","日"],f=[];n.grid.forEach((y,T)=>{if(T<c.length){const C=c[T];y.forEach((A,L)=>{A&&A.length>0&&A.forEach(U=>{f.push({day:C,period:L+1,name:U.name,room:U.room,credits:U.credits,memo:U.memo,tasks:U.tasks.filter(O=>!O.completed).map(O=>({content:O.content,dueDate:O.dueDate,details:O.details}))})})})}});const m={name:n.name,schedule:f},p=`
あなたは優秀な大学生活アシスタントです。ユーザーの時間割情報と現在の質問を分析し、親身なアドバイスを提供してください。

# あなたの役割
- ユーザーの時間割、授業、課題に関するあらゆる質問に答える。
- 課題の優先順位付け、学習計画の提案、スケジュールの確認などを行う。
- 回答はMarkdown形式を積極的に利用し、見やすく、分かりやすく構成すること。
- ポジティブで、ユーザーのやる気を引き出すような言葉遣いを心がけること。

# ユーザーの時間割情報 (JSON形式)
# 各授業は 'schedule' 配列に曜日(day)と時限(period)と共に記録されています。
${JSON.stringify(m,null,2)}

# ユーザーからの質問
"${r}"

上記の情報に基づいて、質問に答えてください。
`;try{return await a.models.generateContentStream({model:e,contents:[{role:"user",parts:[{text:p}]}]})}catch(y){throw console.error("Error analyzing with Gemini API:",y),y instanceof Error&&y.message.includes("API key not valid")?new Error("エラー: 提供されたAPIキーが無効です。入力内容が正しいか確認してください。"):new Error("AIによる分析中にエラーが発生しました。しばらくしてからもう一度お試しください。")}},rF=({isOpen:n,onClose:e,onSave:t,currentModel:r,currentApiKey:i})=>{const[a,c]=ae.useState(r),[f,m]=ae.useState(i);if(ae.useEffect(()=>{n&&(c(r),m(i))},[n,r,i]),!n)return null;const p=()=>{t(a,f),e()};return S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-md shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:"AI設定"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsxs("div",{className:"p-6 space-y-6",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"text-lg font-semibold mb-2",children:"APIキー (Gemini)"}),S.jsx("input",{type:"password",value:f,onChange:y=>m(y.target.value),placeholder:"Gemini APIキーを入力",className:"w-full bg-gray-200/50 dark:bg-gray-700/50 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500","aria-label":"Gemini API Key"}),S.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["APIキーはお使いのブラウザに保存されます。",S.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sky-600 dark:text-sky-400 hover:underline ml-1",children:"キーの取得はこちら"})]})]}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-lg font-semibold mb-2",children:"モデル"}),S.jsx("select",{value:a,onChange:y=>c(y.target.value),className:"w-full bg-gray-200/50 dark:bg-gray-700/50 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500","aria-label":"AI Model",children:KC.map(y=>S.jsx("option",{value:y,className:"bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-white",children:y},y))})]})]}),S.jsx("div",{className:"p-4 flex justify-end items-center border-t border-black/10 dark:border-white/10",children:S.jsx("button",{onClick:p,className:"bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"保存"})})]})})},iF=({isOpen:n,onClose:e,timetable:t,model:r,apiKey:i,onSaveSettings:a,user:c})=>{const[f,m]=ae.useState([]),[p,y]=ae.useState(!1),[T,C]=ae.useState(""),[A,L]=ae.useState(!1),U=ae.useRef(null),O=()=>{U.current?.scrollIntoView({behavior:"smooth"})};ae.useEffect(()=>{O()},[f]),ae.useEffect(()=>{n&&f.length===0&&m([{role:"model",text:`こんにちは！私はあなたの学習アシスタントです。
時間割や課題について、何でも聞いてください。`}])},[n,f.length]);const K=async W=>{if(W.preventDefault(),!T.trim()||p)return;const Y=T;m(re=>[...re,{role:"user",text:Y},{role:"model",text:""}]),C(""),y(!0);try{const re=await nF(t,r,i,Y);for await(const le of re){const Z=le.text;m(D=>{const k=D.length-1,x=[...D];return x[k]={...x[k],text:x[k].text+Z},x})}}catch(re){const le=re instanceof Error?re.message:"予期せぬエラーが発生しました。";m(Z=>{const D=Z.length-1,k=[...Z];return k[D]={...k[D],text:le},k})}finally{y(!1)}};return S.jsxs(S.Fragment,{children:[S.jsx("div",{className:`fixed inset-0 bg-black/30 flex justify-end z-40 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`w-full max-w-md h-full bg-gray-100/90 dark:bg-gray-900/90 backdrop-blur-xl border-l border-black/10 dark:border-white/10 shadow-2xl flex flex-col transition-transform duration-300 ${n?"translate-x-0":"translate-x-full"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:"AIアシスタント"}),S.jsxs("div",{children:[S.jsx("button",{onClick:()=>L(!0),className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",title:"AI設定",children:S.jsx(eE,{className:"w-6 h-6"})}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10 ml-2",title:"閉じる",children:S.jsx(kr,{className:"w-6 h-6"})})]})]}),S.jsxs("div",{className:"flex-grow p-4 overflow-y-auto space-y-4",children:[f.map((W,Y)=>S.jsx("div",{className:`flex ${W.role==="user"?"justify-end":"justify-start"}`,children:S.jsx("div",{className:`max-w-xs md:max-w-sm lg:max-w-md p-3 rounded-2xl ${W.role==="user"?"bg-sky-600 text-white":"bg-gray-200 dark:bg-gray-700"}`,children:W.role==="model"?S.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:window.marked?window.marked.parse(W.text):W.text.replace(/</g,"&lt;").replace(/>/g,"&gt;")}}):S.jsx("p",{className:"whitespace-pre-wrap",children:W.text})})},Y)),p&&f[f.length-1]?.text===""&&S.jsx("div",{className:"flex justify-start",children:S.jsx("div",{className:"p-3 rounded-2xl bg-gray-200 dark:bg-gray-700",children:S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse"}),S.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse [animation-delay:0.2s]"}),S.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse [animation-delay:0.4s]"})]})})}),S.jsx("div",{ref:U})]}),S.jsx("div",{className:"p-4 border-t border-black/10 dark:border-white/10 mt-auto",children:S.jsxs("form",{onSubmit:K,className:"flex items-center gap-2",children:[S.jsx("input",{type:"text",value:T,onChange:W=>C(W.target.value),placeholder:p?"AIが応答中...":"メッセージを入力...",className:"w-full bg-gray-200/50 dark:bg-gray-800/50 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 transition-colors placeholder:text-gray-500",disabled:p,"aria-label":"チャットメッセージ入力"}),S.jsx("button",{type:"submit",disabled:p||!T.trim(),className:"bg-sky-600 hover:bg-sky-700 text-white p-3 rounded-lg transition-colors disabled:bg-sky-400 disabled:cursor-not-allowed flex-shrink-0","aria-label":"送信",children:S.jsx(TP,{className:"w-5 h-5"})})]})})]})}),S.jsx(rF,{isOpen:A,onClose:()=>L(!1),onSave:a,currentModel:r,currentApiKey:i})]})},oF=({isOpen:n,onClose:e,tasks:t,onToggleTask:r,onEditTask:i,onDeleteTask:a})=>{const[c,f]=ae.useState(null);if(!n)return null;const m=[...t].sort((A,L)=>{if(A.completed!==L.completed)return A.completed?1:-1;const U=A.dueDate?new Date(A.dueDate).getTime():1/0,O=L.dueDate?new Date(L.dueDate).getTime():1/0;return U!==O?U-O:A.content.localeCompare(L.content)}),p=m.filter(A=>!A.completed),y=m.filter(A=>A.completed),T=new Date;T.setHours(0,0,0,0);const C=({task:A})=>{const L=A.dueDate&&!A.completed&&new Date(A.dueDate)<T,U=ae.useRef(null),[O,K]=ae.useState(!1),W=c===A.id;return ae.useLayoutEffect(()=>{const Y=U.current;Y&&(W||K(Y.scrollHeight>Y.clientHeight))},[A.details,W]),S.jsxs("div",{className:"bg-black/5 dark:bg-white/5 p-3 rounded-lg",children:[S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx("input",{type:"checkbox",checked:A.completed,onChange:()=>r(A.id,A.subjectId,A.timetableId),className:"form-checkbox h-5 w-5 rounded bg-gray-300 dark:bg-gray-600 border-gray-400 dark:border-gray-500 text-sky-600 focus:ring-sky-500 flex-shrink-0 mt-1"}),S.jsxs("div",{className:"flex-grow",children:[S.jsx("p",{className:`font-semibold ${A.completed?"line-through text-gray-500 dark:text-gray-400":""}`,children:A.content}),S.jsxs("div",{className:"flex items-center flex-wrap gap-x-2 gap-y-1 text-xs text-gray-500 dark:text-gray-400 mt-1",children:[S.jsx("span",{className:`w-2 h-2 rounded-full ${A.subjectColor} flex-shrink-0`}),S.jsx("span",{children:A.subjectName}),S.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"/"}),S.jsx("span",{children:A.timetableName})]})]}),S.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1",children:[A.dueDate&&S.jsx("p",{className:`text-sm font-medium ${L?"text-red-500 font-bold":"text-gray-600 dark:text-gray-300"}`,children:A.dueDate}),A.url&&S.jsx("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",title:"課題ページを開く",className:"p-1 rounded-full text-gray-500 hover:bg-sky-500/20 hover:text-sky-500",children:S.jsx(gp,{className:"w-4 h-4"})}),S.jsx("button",{onClick:()=>i(A,A.subjectId,A.timetableId),className:"p-1 rounded-full text-gray-500 hover:bg-sky-500/20 hover:text-sky-500",children:S.jsx(j0,{className:"w-4 h-4"})}),S.jsx("button",{onClick:()=>a(A.id,A.subjectId,A.timetableId),className:"p-1 rounded-full text-gray-500 hover:bg-red-500/20 hover:text-red-500",children:S.jsx(mp,{className:"w-4 h-4"})})]})]}),A.details&&S.jsxs("div",{className:"mt-2 pl-8",children:[S.jsx("div",{ref:U,className:`text-sm text-gray-600 dark:text-gray-300 whitespace-pre-wrap bg-black/5 dark:bg-white/5 p-2 rounded-md ${W?"":"line-clamp-2"}`,children:A.details}),(O||W)&&S.jsx("button",{onClick:()=>f(W?null:A.id),className:"text-xs text-sky-600 dark:text-sky-400 hover:underline mt-1",children:W?"閉じる":"もっと見る"})]})]})};return S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-3xl max-h-[90vh] flex flex-col shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:"課題一覧"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsx("div",{className:"p-6 overflow-y-auto space-y-6",children:t.length===0?S.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"登録されている課題はありません。"}):S.jsxs(S.Fragment,{children:[S.jsxs("div",{children:[S.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["未完了の課題 (",p.length,")"]}),S.jsx("div",{className:"space-y-2",children:p.length>0?p.map(A=>S.jsx(C,{task:A},A.id)):S.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"素晴らしい！未完了の課題はありません。"})})]}),y.length>0&&S.jsxs("div",{children:[S.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["完了済みの課題 (",y.length,")"]}),S.jsx("div",{className:"space-y-2",children:y.map(A=>S.jsx(C,{task:A},A.id))})]})]})})]})})},sF=({isOpen:n,onClose:e,onSave:t,editingTaskData:r})=>{const[i,a]=ae.useState(""),[c,f]=ae.useState(""),[m,p]=ae.useState(""),[y,T]=ae.useState("");ae.useEffect(()=>{n&&(r&&r.task?(a(r.task.content||""),f(r.task.dueDate||""),p(r.task.details||""),T(r.task.url||"")):(a(""),f(""),p(""),T("")))},[n,r]);const C=()=>{if(!i.trim()){alert("課題名は必須です。");return}t({content:i,dueDate:c,details:m,url:y},r?.task?.id||null)};return S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-lg max-h-[90vh] flex flex-col shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:r?.task?"課題の編集":"新しい課題を追加"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsxs("div",{className:"p-6 overflow-y-auto space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium mb-1",children:"課題名"}),S.jsx("input",{value:i,onChange:A=>a(A.target.value),placeholder:"例: レポート第1回",className:"w-full bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500"})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium mb-1",children:"提出期限"}),S.jsx("input",{type:"date",value:c,onChange:A=>f(A.target.value),className:"w-full bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500"})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium mb-1",children:"課題の詳細"}),S.jsx("textarea",{value:m,onChange:A=>p(A.target.value),placeholder:"課題の詳細や要件などを記入",className:"w-full h-24 resize-none bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500"})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium mb-1",children:"課題のページURL"}),S.jsx("input",{type:"url",value:y,onChange:A=>T(A.target.value),placeholder:"https://example.com/task-info",className:"w-full bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500 placeholder:text-gray-500"})]})]}),S.jsx("div",{className:"p-4 flex justify-end items-center border-t border-black/10 dark:border-white/10 mt-auto",children:S.jsx("button",{onClick:C,className:"bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"保存"})})]})})},aF=({isOpen:n,onClose:e})=>n?S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-md shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:"アプリ情報"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsxs("div",{className:"p-6 space-y-4 text-gray-700 dark:text-gray-300",children:[S.jsxs("div",{className:"text-center",children:[S.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Tablit"}),S.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"自己満の時間割アプリ"})]}),S.jsx("div",{className:"bg-black/5 dark:bg-white/5 p-3 rounded-lg text-sm",children:S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{children:"バージョン"}),S.jsx("span",{className:"font-mono",children:"1.1.0"})]})}),S.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 pt-2",children:"nest 2025"})]})]})}):null,lF=({status:n})=>{const[e,t]=ae.useState(!1),[r,i]=ae.useState(n);if(ae.useEffect(()=>{let f;return n!=="idle"?(i(n),t(!0)):(t(!1),f=setTimeout(()=>{i("idle")},300)),()=>{f&&clearTimeout(f)}},[n]),r==="idle")return null;const c={saving:{icon:S.jsx(_P,{className:"w-5 h-5 animate-spin"}),text:"保存中...",color:"text-gray-800 dark:text-gray-200"},saved:{icon:S.jsx(vP,{className:"w-5 h-5"}),text:"保存済み",color:"text-emerald-600 dark:text-emerald-400"},idle:{icon:null,text:"",color:""}}[r];return S.jsxs("div",{className:`fixed bottom-4 left-4 z-50 flex items-center gap-2 px-4 py-2 rounded-full shadow-lg bg-gray-100/80 dark:bg-gray-900/80 backdrop-blur-md border border-black/10 dark:border-white/10 transition-all duration-300 ${e?"opacity-100 translate-y-0":"opacity-0 translate-y-2 pointer-events-none"} ${c.color}`,children:[c.icon,S.jsx("span",{className:"font-medium text-sm",children:c.text})]})},uF=({isOpen:n,onClose:e,onConfirm:t,title:r,message:i})=>{if(!n)return null;const a=()=>{t(),e()};return S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-md shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:r}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsx("div",{className:"p-6",children:S.jsx("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:i})}),S.jsxs("div",{className:"p-4 flex justify-end items-center gap-3 border-t border-black/10 dark:border-white/10",children:[S.jsx("button",{onClick:e,className:"bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"キャンセル"}),S.jsx("button",{onClick:a,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"削除"})]})]})})},cF=({isOpen:n,onClose:e,onConfirm:t,title:r,message:i,defaultValue:a=""})=>{const[c,f]=ae.useState(a);if(ae.useEffect(()=>{n&&f(a)},[n,a]),!n)return null;const m=()=>{t(c),e()},p=y=>{y.key==="Enter"&&m()};return S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-md shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:r}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsxs("div",{className:"p-6 space-y-3",children:[S.jsx("label",{htmlFor:"prompt-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i}),S.jsx("input",{id:"prompt-input",type:"text",value:c,onChange:y=>f(y.target.value),onKeyDown:p,className:"w-full bg-black/5 dark:bg-white/5 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 border border-transparent focus:border-sky-500",autoFocus:!0})]}),S.jsxs("div",{className:"p-4 flex justify-end items-center gap-3 border-t border-black/10 dark:border-white/10",children:[S.jsx("button",{onClick:e,className:"bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"キャンセル"}),S.jsx("button",{onClick:m,className:"bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"OK"})]})]})})},dF=({isOpen:n,onClose:e,deferredPrompt:t})=>{const[r,i]=ae.useState("android");if(!n)return null;const a=()=>{t&&(t.prompt(),t.userChoice.then(f=>{f.outcome==="accepted"?console.log("User accepted the A2HS prompt"):console.log("User dismissed the A2HS prompt"),e()}))},c=()=>{switch(r){case"android":return S.jsxs("div",{className:"space-y-4",children:[S.jsx("p",{children:"Androidデバイスでは、Chromeブラウザから簡単にアプリをインストールできます。"}),S.jsxs("ol",{className:"list-decimal list-inside space-y-2 bg-black/5 dark:bg-white/5 p-4 rounded-lg",children:[S.jsx("li",{children:"ChromeブラウザでTablitを開きます。"}),S.jsx("li",{children:"画面右上のメニューボタン（︙）をタップします。"}),S.jsxs("li",{children:["メニューから「",S.jsx("strong",{children:"アプリをインストール"}),"」または「",S.jsx("strong",{children:"ホーム画面に追加"}),"」を選択します。"]}),S.jsx("li",{children:"確認画面が表示されたら、「インストール」または「追加」をタップします。"})]}),S.jsx("p",{children:"これでホーム画面にTablitのアイコンが追加され、他のアプリと同様に起動できます。"})]});case"ios":return S.jsxs("div",{className:"space-y-4",children:[S.jsx("p",{children:"iPhoneやiPadでは、Safariブラウザの機能を使ってホーム画面にアプリを追加します。"}),S.jsxs("ol",{className:"list-decimal list-inside space-y-2 bg-black/5 dark:bg-white/5 p-4 rounded-lg",children:[S.jsx("li",{children:"SafariブラウザでTablitを開きます。"}),S.jsx("li",{children:"画面下部（または上部）の共有アイコン（四角から矢印が上に出ているアイコン）をタップします。"}),S.jsxs("li",{children:["メニューをスクロールし、「",S.jsx("strong",{children:"ホーム画面に追加"}),"」を選択します。"]}),S.jsx("li",{children:"名前を確認し、画面右上の「追加」をタップします。"})]}),S.jsx("p",{children:"これでホーム画面にTablitのアイコンが追加され、フルスクリーンで快適に利用できます。"})]});case"desktop":return S.jsxs("div",{className:"space-y-4",children:[S.jsx("p",{children:"パソコン（Windows, Mac, Linux）では、ChromeまたはEdgeブラウザからインストールできます。"}),S.jsxs("ol",{className:"list-decimal list-inside space-y-2 bg-black/5 dark:bg-white/5 p-4 rounded-lg",children:[S.jsx("li",{children:"ChromeまたはEdgeブラウザでTablitを開きます。"}),S.jsxs("li",{children:["アドレスバーの右端に表示される",S.jsx("strong",{children:"インストールアイコン"}),"（PCに下向き矢印のアイコン）をクリックします。"]}),S.jsx("li",{children:"確認画面が表示されたら、「インストール」をクリックします。"})]}),S.jsx("p",{children:"アプリが独立したウィンドウとして開き、タスクバーやDockにピン留めして素早くアクセスできます。"})]})}};return S.jsx("div",{className:`fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:S.jsxs("div",{className:`bg-gray-100/95 dark:bg-gray-900/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl w-full max-w-2xl max-h-[90vh] flex flex-col shadow-2xl transition-transform duration-300 ${n?"scale-100":"scale-95"}`,children:[S.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-black/10 dark:border-white/10",children:[S.jsx("h2",{className:"text-xl font-bold",children:"アプリをインストール"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:S.jsx(kr,{className:"w-6 h-6"})})]}),S.jsxs("div",{className:"p-6 overflow-y-auto",children:[S.jsx("div",{className:"mb-4",children:S.jsxs("div",{className:"flex border-b border-black/10 dark:border-white/10",children:[S.jsx("button",{onClick:()=>i("android"),className:`px-4 py-2 font-semibold ${r==="android"?"border-b-2 border-sky-500 text-sky-600 dark:text-sky-400":"text-gray-500 hover:bg-black/5 dark:hover:bg-white/5"}`,children:"Android"}),S.jsx("button",{onClick:()=>i("ios"),className:`px-4 py-2 font-semibold ${r==="ios"?"border-b-2 border-sky-500 text-sky-600 dark:text-sky-400":"text-gray-500 hover:bg-black/5 dark:hover:bg-white/5"}`,children:"iOS"}),S.jsx("button",{onClick:()=>i("desktop"),className:`px-4 py-2 font-semibold ${r==="desktop"?"border-b-2 border-sky-500 text-sky-600 dark:text-sky-400":"text-gray-500 hover:bg-black/5 dark:hover:bg-white/5"}`,children:"Desktop"})]})}),S.jsx("div",{className:"text-gray-700 dark:text-gray-300",children:c()})]}),S.jsx("div",{className:"p-4 flex justify-end items-center border-t border-black/10 dark:border-white/10 mt-auto",children:t&&(r==="android"||r==="desktop")&&S.jsxs("button",{onClick:a,className:"bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded-lg transition-colors flex items-center gap-2",children:[S.jsx(ch,{className:"w-5 h-5"}),S.jsx("span",{children:"インストール"})]})})]})})};function fF(){const[n,e]=ae.useState(null),[t,r]=ae.useState(!0),{timetables:i,activeTimetable:a,activeTimetableId:c,setActiveTimetableId:f,addTimetable:m,importTimetable:p,deleteTimetable:y,updateTimetableSettings:T,saveSubject:C,deleteSubject:A,moveSubject:L,toggleTaskCompletion:U,addTask:O,updateTask:K,deleteTask:W,totalCredits:Y,saveStatus:re,isLoading:le}=dP(n),[Z,D]=ae.useState(YC),[k,x]=ae.useState(""),[P,N]=ae.useState(()=>{if(typeof window<"u"&&window.localStorage){const he=window.localStorage.getItem("theme");if(he==="light"||he==="dark")return he;if(window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}return"light"});ae.useEffect(()=>{const he=aP(Ke=>{e(Ke),r(!1)}),Ve=localStorage.getItem("geminiModel");Ve&&D(Ve);const Qe=localStorage.getItem("geminiApiKey");return Qe&&x(Qe),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(Ke=>{console.log("ServiceWorker registration successful with scope: ",Ke.scope)},Ke=>{console.log("ServiceWorker registration failed: ",Ke)})}),()=>he()},[]),ae.useEffect(()=>{const he=window.document.documentElement;he.classList.remove(P==="dark"?"light":"dark"),he.classList.add(P),localStorage.setItem("theme",P),document.body.classList.remove("glassmorphism-bg","dark"),P==="dark"?document.body.classList.add("dark","glassmorphism-bg"):document.body.classList.add("glassmorphism-bg")},[P]);const b=()=>{N(he=>he==="light"?"dark":"light")},M=async()=>{try{await oP()}catch(he){console.error("Login failed",he)}},Pe=async()=>{try{await sP()}catch(he){console.error("Logout failed",he)}},[De,Ne]=ae.useState(!1),[Le,oe]=ae.useState(!1),[ye,ue]=ae.useState(!1),[q,Q]=ae.useState(!1),[_e,ke]=ae.useState(!1),[Me,Ue]=ae.useState(!1),[ze,Ge]=ae.useState(!1),[Je,at]=ae.useState(null),[$t,or]=ae.useState(null),[Tt,sr]=ae.useState({subject:null,dayIndex:0,periodIndex:0}),[ar,ti]=ae.useState(null),[Pr,Go]=ae.useState(null),ni=(he,Ve)=>{sr({subject:null,dayIndex:he,periodIndex:Ve}),Ne(!0)},bn=(he,Ve,Qe)=>{sr({subject:he,dayIndex:Ve,periodIndex:Qe}),Ne(!0)},Cn=()=>{or({isOpen:!0,title:"新しい時間割の作成",message:"時間割の名前を入力してください。",defaultValue:`時間割 ${i.length+1}`,onConfirm:he=>{he&&m(he),or(null)}})},Wi=()=>{a&&at({isOpen:!0,title:"時間割の削除",message:`「${a.name}」を本当に削除しますか？この操作は元に戻せません。`,onConfirm:()=>{y(a.id),at(null)}})},ri=()=>{if(!a)return;const he=JSON.stringify(a,null,2),Ve=new Blob([he],{type:"application/json"}),Qe=URL.createObjectURL(Ve),Ke=document.createElement("a");Ke.href=Qe,Ke.download=`${a.name}.tmx`,document.body.appendChild(Ke),Ke.click(),document.body.removeChild(Ke),URL.revokeObjectURL(Qe)},ii=he=>{const Ve=he.target.files?.[0];if(!Ve)return;const Qe=new FileReader;Qe.onload=Ke=>{const Pt=Ke.target?.result;typeof Pt=="string"&&(p(Pt)||alert("時間割ファイルの読み込みに失敗しました。ファイル形式が正しいか確認してください。"))},Qe.readAsText(Ve),he.target.value=""},Ji=he=>{T(he)},mt=(he,Ve)=>{D(he),x(Ve),localStorage.setItem("geminiModel",he),localStorage.setItem("geminiApiKey",Ve)},gt=he=>{const{id:Ve,...Qe}=he;Go(Qe)},Un=(he,Ve)=>{if(Pr){const Qe={...Pr,id:`subject-${Date.now()}`,tasks:[]};C(Qe,he,Ve)}},Ki=()=>{!Tt.subject||!c||(ti({task:null,subjectId:Tt.subject.id,timetableId:c}),ke(!0))},Fn=(he,Ve,Qe)=>{ti({task:he,subjectId:Ve,timetableId:Qe}),ke(!0)},Nr=(he,Ve)=>{if(!ar)return;const{subjectId:Qe,timetableId:Ke}=ar;if(Ve){const Pt=i.find(pn=>pn.id===Ke)?.grid.flat(2).find(pn=>pn.id===Qe)?.tasks.find(pn=>pn.id===Ve);Pt&&K({...Pt,...he},Qe,Ke)}else{const Pt={...he,id:`task-${Date.now()}`,completed:!1};O(Pt,Qe,Ke)}ke(!1)},lr=(he,Ve,Qe)=>{at({isOpen:!0,title:"課題の削除",message:"この課題を本当に削除しますか？",onConfirm:()=>{W(he,Ve,Qe),at(null)}})},Yi=a?.grid.flat(2).find(he=>he.id===Tt.subject?.id),Qi={onToggleTask:he=>{Tt.subject&&c&&U(he,Tt.subject.id,c)},onOpenAddTaskModal:Ki,onOpenEditTaskModal:he=>{Tt.subject&&c&&Fn(he,Tt.subject.id,c)},onDeleteTask:he=>{Tt.subject&&c&&lr(he,Tt.subject.id,c)}},Xi=i.flatMap(he=>he.grid.flat(2).flatMap(Ve=>Ve.tasks.map(Qe=>({...Qe,subjectName:Ve.name,subjectColor:Vi.find(Ke=>Ke.name===Ve.color)?.bg||Vi[0].bg,subjectId:Ve.id,timetableId:he.id,timetableName:he.name})))),[Zi,ji]=ae.useState(null);return ae.useEffect(()=>{const he=Ve=>{Ve.preventDefault(),ji(Ve)};return window.addEventListener("beforeinstallprompt",he),()=>{window.removeEventListener("beforeinstallprompt",he)}},[]),t||le?S.jsx("div",{className:"min-h-screen flex justify-center items-center",children:S.jsx("div",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300",children:"読み込み中..."})}):S.jsxs("div",{className:"min-h-screen text-gray-800 dark:text-white font-sans transition-colors duration-300",children:[S.jsx(IP,{timetables:i,activeTimetableId:c,setActiveTimetableId:f,onAddTimetable:Cn,onDeleteTimetable:Wi,onOpenSettings:()=>oe(!0),onOpenTaskList:()=>Q(!0),totalCredits:Y,theme:P,toggleTheme:b,onExport:ri,onImport:ii,onOpenAppInfo:()=>Ue(!0),onOpenInstallPwa:()=>Ge(!0),user:n,onLogin:M,onLogout:Pe}),S.jsx("main",{children:a?S.jsx(kP,{timetable:a,onAddSubject:ni,onEditSubject:bn,onMoveSubject:L,onDeleteSubject:A,onCopySubject:gt,onPasteSubject:Un,copiedSubject:Pr}):S.jsxs("div",{className:"flex flex-col justify-center items-center h-[calc(100vh-120px)]",children:[S.jsx("p",{className:"text-2xl text-gray-500 dark:text-gray-400 mb-6",children:"時間割がありません"}),S.jsx("button",{onClick:Cn,className:"bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-colors shadow-lg hover:shadow-xl",children:"最初の時間割を作成する"})]})}),S.jsx(lF,{status:re}),i.length>0&&S.jsx("button",{onClick:()=>ue(!0),className:"fixed bottom-6 right-6 bg-sky-600 hover:bg-sky-700 text-white p-4 rounded-full shadow-lg z-30 transition-transform hover:scale-110",title:"AIアシスタント","aria-label":"AIアシスタントを開く",children:S.jsx(fP,{className:"w-8 h-8"})}),S.jsx(PP,{isOpen:De,onClose:()=>Ne(!1),onSave:C,onDelete:A,subjectData:{...Tt,subject:Yi||Tt.subject},taskHandlers:Qi}),a&&S.jsx(NP,{isOpen:Le,onClose:()=>oe(!1),onSave:Ji,currentSettings:a.settings}),S.jsx(iF,{isOpen:ye,onClose:()=>ue(!1),timetable:a,model:Z,apiKey:k,onSaveSettings:mt,user:n}),S.jsx(oF,{isOpen:q,onClose:()=>Q(!1),tasks:Xi,onToggleTask:U,onEditTask:Fn,onDeleteTask:lr}),S.jsx(sF,{isOpen:_e,onClose:()=>ke(!1),onSave:Nr,editingTaskData:ar}),S.jsx(aF,{isOpen:Me,onClose:()=>Ue(!1)}),S.jsx(dF,{isOpen:ze,onClose:()=>Ge(!1),deferredPrompt:Zi}),Je&&S.jsx(uF,{isOpen:Je.isOpen,onClose:()=>at(null),onConfirm:Je.onConfirm,title:Je.title,message:Je.message}),$t&&S.jsx(cF,{isOpen:$t.isOpen,onClose:()=>or(null),onConfirm:$t.onConfirm,title:$t.title,message:$t.message,defaultValue:$t.defaultValue})]})}const hF="modulepreload",pF=function(n,e){return new URL(n,e).href},x_={},mF=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let p=function(y){return Promise.all(y.map(T=>Promise.resolve(T).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};const c=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),m=f?.nonce||f?.getAttribute("nonce");i=p(t.map(y=>{if(y=pF(y,r),y in x_)return;x_[y]=!0;const T=y.endsWith(".css"),C=T?'[rel="stylesheet"]':"";if(!!r)for(let U=c.length-1;U>=0;U--){const O=c[U];if(O.href===y&&(!T||O.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${C}`))return;const L=document.createElement("link");if(L.rel=T?"stylesheet":hF,T||(L.as="script"),L.crossOrigin="",L.href=y,m&&L.setAttribute("nonce",m),document.head.appendChild(L),T)return new Promise((U,O)=>{L.addEventListener("load",U),L.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${y}`)))})}))}function a(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return i.then(c=>{for(const f of c||[])f.status==="rejected"&&a(f.reason);return e().catch(a)})};function gF(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:c}=n;let f,m;const p=async(T=!0)=>{await m};async function y(){if("serviceWorker"in navigator){if(f=await mF(async()=>{const{Workbox:T}=await import("./workbox-window.prod.es5-CwtvwXb3.js");return{Workbox:T}},[],import.meta.url).then(({Workbox:T})=>new T("./sw.js",{scope:"./",type:"classic"})).catch(T=>{c?.(T)}),!f)return;f.addEventListener("activated",T=>{(T.isUpdate||T.isExternal)&&window.location.reload()}),f.addEventListener("installed",T=>{T.isUpdate||r?.()}),f.register({immediate:e}).then(T=>{a?a("./sw.js",T):i?.(T)}).catch(T=>{c?.(T)})}}return m=y(),p}gF({onNeedRefresh(){},onOfflineReady(){}});const VE=document.getElementById("root");if(!VE)throw new Error("Could not find root element to mount to");const yF=JC.createRoot(VE);yF.render(S.jsx(R_.StrictMode,{children:S.jsx(fF,{})}));
